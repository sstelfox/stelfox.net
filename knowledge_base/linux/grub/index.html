<!DOCTYPE html>
<html lang='en_US'>
  <head>
    <title>Grub - Stelfox Athen&#xe6;um</title>

    <meta http-equiv='content-type' content='text/html; charset=utf-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1' />
    
    

    <link rel="alternate" type="application/atom+xml" title="Stelfox Athen&#xe6;um Feed" href="/atom.xml" />
    <link rel="canonical" href="https://stelfox.net" />
    <link rel="author" href="https://plus.google.com/+SamStelfox31337/"/>

    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Grub" />
    <meta property="og:url" content="https://stelfox.net/knowledge_base/linux/grub/" />
    <meta property="og:site_name" content="Stelfox Athen&#xe6;um" />
    <meta property="article:publisher" content="https://www.facebook.com/sstelfox" />
    <meta property="og:image" content="https://stelfox.net/static/avatar-01.jpg" />

    <link rel='stylesheet' href="//fonts.googleapis.com/css?family=Open+Sans:300,400italic,400,600,700|Alegreya+SC:700" />
    <link rel="stylesheet" href="https://stelfox.net/css/3HrCRVwL3Gos2V4HzXAw/Om/nxs=.css" />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-32188490-1', 'stelfox.net');
      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <header class='masthead'>
      <div class='masthead-inner'>
        <h1><a href='/' title='Home'>Sam Stelfox</a></h1>
        <p class='lead'>Thoughts from a systems hacker and developer.</p>
        <nav>
          <ul>
            <li><a href="/about/" title="About">About</a></li>
            <li><a href="/blog/" title="Blog">Blog</a></li>
            <li><a href="/knowledge_base/" title="Knowledge Base">Knowledge Base</a></li>
            <li><form action="/search/" method="get"><input type="search" name="q" placeholder="Search" /></form></li>
          </ul>
        </nav>
        <footer class='colophon'>
          <p>&copy; 2014, All rights reserved.</p>
        </footer>
      </div>
    </header>
    <div class='content container'>
      <h1>Grub</h1>

<h2>Security</h2>

<h3>Password Protection</h3>

<p>If left unchecked a malicious user with console access can add or remove kernel
parameters or chain-boot onto another device when booting using grub. You can
prevent this by requiring the user to enter a password to modify the run-time
configuration of grub on boot.</p>

<p>You can use the &#39;Bootloader Password&#39; option during a CentOS or Fedora install
however it&#39;s uses md5 to hash the password which is a known broken scheme.
<code>grub-crypt</code> which comes installed by default on Fedora allows you to use
sha512 to hash the password like so:</p>
<div class="CodeRay">
  <div class="code"><pre>[root@localhost ~]# grub-crypt --sha-512
Password: 
Retype password: 
$6$Um4l/Bido.ySrD.H$uuQjipx3uCu/XwGAfqOQsdIw1m1dphRbUbKOsoT5EpCt4LGi0kGdckDE3SPj2eS3pJ9DCJy3V/TqlqJOjjMvJ1
</pre></div>
</div>

<p>Note: Do not use the hash displayed it above, it is not secure (I used
&quot;password&quot;)</p>

<p>You would then add the following line (or replace an existing one) to
<code>/etc/grub.conf</code></p>
<div class="CodeRay">
  <div class="code"><pre>password --sha-512 $6$Um4l/Bido.ySrD.H$uuQjipx3uCu/XwGAfqOQsdIw1m1dphRbUbKOsoT5EpCt4LGi0kGdckDE3SPj2eS3pJ9DCJy3V/TqlqJOjjMvJ1
</pre></div>
</div>

<h3>Protect the Configuration</h3>

<p>Since the grub configuration file has a password hash in it (regardless of the
current state of security of that hash type), as additional information about
the server it should be restricted to only be readable and writeable by root
like so:</p>
<div class="CodeRay">
  <div class="code"><pre>[root@localhost ~]# chmod 600 /etc/grub.conf
</pre></div>
</div>

    </div>
  </body>
</html>
