<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="sam@stelfox.net Sam Stelfox ">
<meta name="description" content="I&amp;rsquo;ve been playing around with my Nexus 5 lately. It was quickly rooted and I began playing with various ROMs that had been pre-built for the Nexus 5. My first stop was the CyanogenMod. Since I&amp;rsquo;d last used CyanogenMod they added a built-in framework that provides transparent text message encryption called WhisperPush.
WhisperPush is an implementation of Moxie Marlinspike&amp;rsquo;s highly respected TextSecure and I was very excited at the possibility of using it." />
<meta name="keywords" content="blog, programming, linux, systems, personal, android, security" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://stelfox.net/blog/2014/07/unregistering-from-whisperpush-after-flashing-a-new-rom/" />


    <title>
        
            Unregistering From WhisperPush After Flashing a New ROM :: Sam Stelfox 
        
    </title>




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" integrity="sha512-Cv93isQdFwaKBV+Z4X8kaVBYWHST58Xb/jVOcV9aRsGSArZsgAnFIhMpDoMDcFNoUtday1hdjn0nGp3+KZyyFw==" crossorigin="anonymous" referrerpolicy="no-referrer" />



<link rel="stylesheet" href="/main.2a064c455b0ecbd6b1481b3bf9df2441e95838691022f40a5338c2cb1244f075.css" integrity="sha256-KgZMRVsOy9axSBs7&#43;d8kQelYOGkQIvQKUzjCyxJE8HU=">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Unregistering From WhisperPush After Flashing a New ROM">
<meta itemprop="description" content="I&rsquo;ve been playing around with my Nexus 5 lately. It was quickly rooted and I began playing with various ROMs that had been pre-built for the Nexus 5. My first stop was the CyanogenMod. Since I&rsquo;d last used CyanogenMod they added a built-in framework that provides transparent text message encryption called WhisperPush.
WhisperPush is an implementation of Moxie Marlinspike&rsquo;s highly respected TextSecure and I was very excited at the possibility of using it."><meta itemprop="datePublished" content="2014-07-22T21:54:59-04:00" />
<meta itemprop="dateModified" content="2014-07-22T21:54:59-04:00" />
<meta itemprop="wordCount" content="636">
<meta itemprop="keywords" content="android,security," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Unregistering From WhisperPush After Flashing a New ROM"/>
<meta name="twitter:description" content="I&rsquo;ve been playing around with my Nexus 5 lately. It was quickly rooted and I began playing with various ROMs that had been pre-built for the Nexus 5. My first stop was the CyanogenMod. Since I&rsquo;d last used CyanogenMod they added a built-in framework that provides transparent text message encryption called WhisperPush.
WhisperPush is an implementation of Moxie Marlinspike&rsquo;s highly respected TextSecure and I was very excited at the possibility of using it."/>



    <meta property="og:title" content="Unregistering From WhisperPush After Flashing a New ROM" />
<meta property="og:description" content="I&rsquo;ve been playing around with my Nexus 5 lately. It was quickly rooted and I began playing with various ROMs that had been pre-built for the Nexus 5. My first stop was the CyanogenMod. Since I&rsquo;d last used CyanogenMod they added a built-in framework that provides transparent text message encryption called WhisperPush.
WhisperPush is an implementation of Moxie Marlinspike&rsquo;s highly respected TextSecure and I was very excited at the possibility of using it." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://stelfox.net/blog/2014/07/unregistering-from-whisperpush-after-flashing-a-new-rom/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2014-07-22T21:54:59-04:00" />
<meta property="article:modified_time" content="2014-07-22T21:54:59-04:00" />






    <meta property="article:published_time" content="2014-07-22 21:54:59 -0400 EDT" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                ./Sam_Stelfox.sh</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/">Home</a></li><li><a href="/about/">About</a></li><li><a href="/blog/">Blog Posts</a></li><li><a href="/notes/">Various Notes</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://stelfox.net/blog/2014/07/unregistering-from-whisperpush-after-flashing-a-new-rom/">Unregistering From WhisperPush After Flashing a New ROM</a></h2>

            
            
            

            <div class="post-content">
                <p>I&rsquo;ve been playing around with my Nexus 5 lately. It was quickly rooted and I
began playing with various ROMs that had been pre-built for the Nexus 5. My
first stop was the CyanogenMod. Since I&rsquo;d last used CyanogenMod they added a
built-in framework that provides <a href="https://whispersystems.org/blog/cyanogen-integration/">transparent text</a> message encryption
called WhisperPush.</p>
<p>WhisperPush is an implementation of <a href="http://thoughtcrime.org/">Moxie Marlinspike&rsquo;s</a> highly respected
TextSecure and I was very excited at the possibility of using it. I immediately
signed up for the service.</p>
<p>After a day of use I found CyanogenMod far too unstable too use on my primary
device. It locked up multiple times the first day and mobile data simply
wouldn&rsquo;t work all day. I promptly formatted and flashed my phone, I haven&rsquo;t
settled on a new ROM but that&rsquo;s not what this post is about.</p>
<p>It occurred to me after flashing the phone I was still subscribed to
WhisperPush. If anyone that texts me was signed up as well. I&rsquo;d never receive
even an encrypted blob, it would just silently fail.</p>
<p>Searching around I found there is very little information on it, and no
official way to unregister, especially after you&rsquo;ve wiped your device and no
longer have your credentials. Ultimately I found a fairly easy solution, just
re-register and perform the backdoor steps too de-register.</p>
<p>I wiped my phone again and installed a new copy of the CyanogenMod nightly.
Booted it up and re-enabled WhisperPush. It didn&rsquo;t even note that my number was
registered in the past.</p>
<p>I found the solution somewhere in the CyanogenMod forums (though I lost the
link, and I&rsquo;m now too lazy to go find it again). You can unregister by
performing the following steps:</p>
<ol>
<li>
<p>Connect your computer with ADB too the phone and pair the computer with the
phone.</p>
</li>
<li>
<p>Enable developer options by opening the system settings, choosing &lsquo;About
phone&rsquo; and clicking on the &lsquo;Build number&rsquo; about 7 times (it will start
counting down).</p>
</li>
<li>
<p>Open up the developer options found in the root of the system settings menu
and enable root access for &lsquo;Apps and ADB&rsquo;.</p>
</li>
<li>
<p>On the computer use <code>adb shell</code> to get a shell on the device.</p>
</li>
<li>
<p>Switch to root using the <code>su</code> command.</p>
</li>
<li>
<p>Run the following command too view the WhisperPush internal settings:</p>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>cat /data/user/0/org.whispersystems.whisperpush/shared_prefs/org.whispersystems.whisperpush_preferences.xml`
</span></span></code></pre></div></li>
<li>
<p>Note down the value for <code>pref_registered_number</code> (this should be your phone
number with a preceding &lsquo;+&rsquo;) and <code>pre_push_password</code>.</p>
</li>
<li>
<p>Exit the shell.</p>
</li>
</ol>
<p>Finally too unregister we need too make a DELETE request against the
WhisperPush API. The classic HTTP swiss army knife <code>curl</code> is going to help us
on this front. Run the following command on any linux computer with curl
installed, replacing the registered number and registered password with the
value you recorded earlier.</p>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -v -k -X DELETE --basic --user <span style="color:#a5d6ff">${</span><span style="color:#79c0ff">pref_registered_number</span><span style="color:#a5d6ff">}</span>:<span style="color:#a5d6ff">${</span><span style="color:#79c0ff">pre_push_password</span><span style="color:#a5d6ff">}</span> https://whisperpush.cyanogenmod.org/v1/accounts/gcm
</span></span></code></pre></div><p>Be sure too include the &lsquo;+&rsquo; in your pref_registered_number. You should end up
with a status code of 204. The output will look something like the following
(credentials removed).</p>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>* About to connect() to whisperpush.cyanogenmod.org port 443 (#0)
</span></span><span style="display:flex;"><span>*   Trying 54.201.5.27...
</span></span><span style="display:flex;"><span>* Connected to whisperpush.cyanogenmod.org (54.201.5.27) port 443 (#0)
</span></span><span style="display:flex;"><span>* Initializing NSS with certpath: sql:/etc/pki/nssdb
</span></span><span style="display:flex;"><span>* skipping SSL peer certificate verification
</span></span><span style="display:flex;"><span>* SSL connection using TLS_DHE_RSA_WITH_AES_128_CBC_SHA
</span></span><span style="display:flex;"><span>* Server certificate:
</span></span><span style="display:flex;"><span>*   subject: OU=Operations,O=&#34;Cyanogen, Inc.&#34;,E=ops@cyngn.com,C=US,ST=Washington,L=Seattle,CN=whisperpush.cyanogenmod.org
</span></span><span style="display:flex;"><span>*   start date: Nov 26 05:39:18 2013 GMT
</span></span><span style="display:flex;"><span>*   expire date: Nov 24 05:39:18 2023 GMT
</span></span><span style="display:flex;"><span>*   common name: whisperpush.cyanogenmod.org
</span></span><span style="display:flex;"><span>*   issuer: E=ops@cyngn.com,CN=Authority,OU=Operations,O=&#34;Cyanogen, Inc.&#34;,L=Seattle,ST=Washington,C=US
</span></span><span style="display:flex;"><span>* Server auth using Basic with user &#39;${pref_registered_number}&#39;
</span></span><span style="display:flex;"><span>&gt; DELETE /v1/accounts/gcm HTTP/1.1
</span></span><span style="display:flex;"><span>&gt; Authorization: Basic ${encoded credentials}
</span></span><span style="display:flex;"><span>&gt; User-Agent: curl/7.29.0
</span></span><span style="display:flex;"><span>&gt; Host: whisperpush.cyanogenmod.org
</span></span><span style="display:flex;"><span>&gt; Accept: */*
</span></span><span style="display:flex;"><span>&gt; 
</span></span><span style="display:flex;"><span>&lt; HTTP/1.1 204 No Content
</span></span><span style="display:flex;"><span>&lt; Server: nginx/1.1.19
</span></span><span style="display:flex;"><span>&lt; Date: Wed, 23 Jul 2014 01:45:25 GMT
</span></span><span style="display:flex;"><span>&lt; Connection: keep-alive
</span></span><span style="display:flex;"><span>&lt; 
</span></span><span style="display:flex;"><span>* Connection #0 to host whisperpush.cyanogenmod.org left intact
</span></span></code></pre></div><p>I don&rsquo;t have any way too check that I&rsquo;m unregistered but it seems too have
worked. Here is hoping this helps some else out in the future.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://stelfox.net/tags/android/">android</a></span>
        <span class="tag"><a href="https://stelfox.net/tags/security/">security</a></span>
        
    </p>

            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.c90b8161416b87c69a8e02683b54ddd6edb90aea699648bf655e6cbc45b419b8e465d196e715772463dba35a6faf5decb2eb247480d38680484d54645b434570.js" integrity="sha512-yQuBYUFrh8aajgJoO1Td1u25Cupplki/ZV5svEW0GbjkZdGW5xV3JGPbo1pvr13ssuskdIDThoBITVRkW0NFcA=="></script>



    </body>
</html>
