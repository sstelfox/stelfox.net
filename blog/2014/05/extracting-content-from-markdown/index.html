<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="Recently I&amp;rsquo;ve been playing around with building a pure javascript full text search engine for static content sites like this one. One of the challenges with doing this has been working around the Markdown markup embedded in the written content.
Most of the markdown syntax can be stripped out simply by removing all non-alphanumeric characters from the document and move on. This doesn&amp;rsquo;t solve one of the bigger challenges I&amp;rsquo;ve experienced&amp;hellip; Code blocks."><meta name=keywords content="blog,programming,linux,systems,personal,rust,philosophy,development,tips"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://stelfox.net/blog/2014/05/extracting-content-from-markdown/><title>Extracting Content From Markdown :: Sam Stelfox — A simple place for my collected thoughts and notes.
</title><link rel=stylesheet href=/main.c8c76086c15b9d686ec1778dcf935d2ad37f3bb9c23165d2bd157ba7b18e5aec.css integrity="sha256-yMdghsFbnWhuwXeNz5NdKtN/O7nCMWXSvRV7p7GOWuw="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Extracting Content From Markdown"><meta itemprop=description content="Recently I’ve been playing around with building a pure javascript full text search engine for static content sites like this one. One of the challenges with doing this has been working around the Markdown markup embedded in the written content.
Most of the markdown syntax can be stripped out simply by removing all non-alphanumeric characters from the document and move on. This doesn’t solve one of the bigger challenges I’ve experienced… Code blocks."><meta itemprop=datePublished content="2014-05-30T18:34:29-04:00"><meta itemprop=dateModified content="2014-05-30T18:34:29-04:00"><meta itemprop=wordCount content="275"><meta itemprop=keywords content="Development,Tips"><meta name=twitter:card content="summary"><meta name=twitter:title content="Extracting Content From Markdown"><meta name=twitter:description content="Recently I’ve been playing around with building a pure javascript full text search engine for static content sites like this one. One of the challenges with doing this has been working around the Markdown markup embedded in the written content.
Most of the markdown syntax can be stripped out simply by removing all non-alphanumeric characters from the document and move on. This doesn’t solve one of the bigger challenges I’ve experienced… Code blocks."><meta property="article:published_time" content="2014-05-30 18:34:29 -0400 EDT"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>./Sam_Stelfox.sh</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/blog/>Posts</a></li><li><a href=/notes/>Notes</a></li><li><a href=/about/>About Me</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://stelfox.net/blog/2014/05/extracting-content-from-markdown/>Extracting Content From Markdown</a></h2><div class=post-content><p>Recently I&rsquo;ve been playing around with building a pure javascript full text
search engine for static content sites like this one. One of the challenges
with doing this has been working around the Markdown markup embedded in the
written content.</p><p>Most of the markdown syntax can be stripped out simply by removing all
non-alphanumeric characters from the document and move on. This doesn&rsquo;t solve
one of the bigger challenges I&rsquo;ve experienced&mldr; Code blocks. Code blocks have
plenty of regular English-ish words and can easily skew keyword detection
within it.</p><p>I didn&rsquo;t want to write my own Markdown parser, so I started with the one
already in use by this site&rsquo;s renderer (<a href=https://github.com/vmg/redcarpet>redcarpet</a>). Another GitHub user,
<a href=https://github.com/toupeira>Markus Koller or toupeira on GitHub</a> provided <a href=https://github.com/vmg/redcarpet/issues/79>the basis</a> for the code
that became the redcarpet &ldquo;StripDown&rdquo; formatter, which was designed to
essentially render a Markdown document without the markup.</p><p>It does almost exactly what I want, except it still outputs raw code inside the
content. The following code sample includes a modified version that excludes
any code blocks. My content is also formatted inside the markdown documents to
never be longer than 80 lines, this also turns individual paragraphs and list
items into individual lines for paragraph detection.</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-1><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-2><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-3><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-4><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-5><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-6><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-7><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-8><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-9><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-10><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-11><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-12><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-13><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-14><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-15><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-16><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-17><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-18><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-f033e31-19><a style=outline:none;text-decoration:none;color:inherit href=#code-f033e31-19>19</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>require <span style=color:#a5d6ff>&#39;redcarpet&#39;</span>
</span></span><span style=display:flex><span>require <span style=color:#a5d6ff>&#39;redcarpet/render_strip&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>ContentRenderer</span> <span style=color:#ff7b72;font-weight:700>&lt;</span> <span style=color:#79c0ff;font-weight:700>Redcarpet</span><span style=color:#ff7b72;font-weight:700>::</span><span style=color:#79c0ff;font-weight:700>Render</span><span style=color:#ff7b72;font-weight:700>::</span><span style=color:#79c0ff;font-weight:700>StripDown</span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>block_code</span>(<span style=color:#ff7b72;font-weight:700>*</span>args)
</span></span><span style=display:flex><span>    <span style=color:#79c0ff>nil</span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>list_item</span>(content, list_type)
</span></span><span style=display:flex><span>    content<span style=color:#ff7b72;font-weight:700>.</span>gsub(<span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>\n</span><span style=color:#a5d6ff>&#34;</span>, <span style=color:#a5d6ff>&#34; &#34;</span>) <span style=color:#ff7b72;font-weight:700>+</span> <span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>\n\n</span><span style=color:#a5d6ff>&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>paragraph</span>(text)
</span></span><span style=display:flex><span>    text<span style=color:#ff7b72;font-weight:700>.</span>gsub(<span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>\n</span><span style=color:#a5d6ff>&#34;</span>, <span style=color:#a5d6ff>&#34; &#34;</span>) <span style=color:#ff7b72;font-weight:700>+</span> <span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>\n\n</span><span style=color:#a5d6ff>&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>end</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>markdown <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff;font-weight:700>Redcarpet</span><span style=color:#ff7b72;font-weight:700>::</span><span style=color:#79c0ff;font-weight:700>Markdown</span><span style=color:#ff7b72;font-weight:700>.</span>new(<span style=color:#79c0ff;font-weight:700>ContentRenderer</span>, <span style=color:#a5d6ff>fenced_code_blocks</span>: <span style=color:#79c0ff>true</span>)
</span></span><span style=display:flex><span>puts markdown<span style=color:#ff7b72;font-weight:700>.</span>render(<span style=color:#79c0ff;font-weight:700>File</span><span style=color:#ff7b72;font-weight:700>.</span>read(<span style=color:#a5d6ff>&#39;sample_markdown_article.md&#39;</span>))</span></span></code></pre></td></tr></table></div></div><p>The above code will print out just the content of the markdown formatted file
&lsquo;sample_markdown_article.md&rsquo;.</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://stelfox.net/tags/development/>development</a></span>
<span class=tag><a href=https://stelfox.net/tags/tips/>tips</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"/><line x1="1.05" y1="12" x2="7" y2="12"/><line x1="17.01" y1="12" x2="22.96" y2="12"/></svg><a href=bd9e1ab3269fdee0856f80854c902432ef10f201 target=_blank rel=noopener>bd9e1ab3</a> @ 2024-07-14</p></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.85fad2de4f13fec3bcb3b3cb10430cdb44a7b4a9749b32938241a5c6e77718df7624f1002b880521fdc26e24ec1077fda214bf1cb36ee3045510760d09638cae.js integrity="sha512-hfrS3k8T/sO8s7PLEEMM20SntKl0mzKTgkGlxud3GN92JPEAK4gFIf3CbiTsEHf9ohS/HLNu4wRVEHYNCWOMrg=="></script></body></html>