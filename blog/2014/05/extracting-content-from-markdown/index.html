<!DOCTYPE html>
<html lang='en'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='Recently I&rsquo;ve been playing around with building a pure javascript full text search engine for static content sites like this one. One of the challenges with doing this has been working around the Markdown markup embedded in the written content.
Most of the markdown syntax can be stripped out simply by removing all non-alphanumeric characters from the document and move on. This doesn&rsquo;t solve one of the bigger challenges I&rsquo;ve experienced&hellip; Code blocks.'>
<meta name='theme-color' content='#ffcd00'>

<meta property='og:title' content='Extracting Content From Markdown • Sam Stelfox&#39;s Thoughts &amp; Notes'>
<meta property='og:description' content='Recently I&rsquo;ve been playing around with building a pure javascript full text search engine for static content sites like this one. One of the challenges with doing this has been working around the Markdown markup embedded in the written content.
Most of the markdown syntax can be stripped out simply by removing all non-alphanumeric characters from the document and move on. This doesn&rsquo;t solve one of the bigger challenges I&rsquo;ve experienced&hellip; Code blocks.'>
<meta property='og:url' content='https://stelfox.net/blog/2014/05/extracting-content-from-markdown/'>
<meta property='og:site_name' content='Sam Stelfox&#39;s Thoughts &amp; Notes'>
<meta property='og:type' content='article'><meta property='article:section' content='blog'><meta property='article:tag' content='development'><meta property='article:tag' content='tips'><meta property='article:published_time' content='2014-05-30T18:34:29-04:00'/><meta property='article:modified_time' content='2014-05-30T18:34:29-04:00'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.56.0-DEV" />

  <title>Extracting Content From Markdown • Sam Stelfox&#39;s Thoughts &amp; Notes</title>
  <link rel='canonical' href='https://stelfox.net/blog/2014/05/extracting-content-from-markdown/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.6a060eb7.css'><style>
:root{--color-accent:#ffcd00;}
</style>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-32188490-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  

</head>
<body class='page type-blog'>

  <div class='site'><a class='screen-reader-text' href='#content'>Skip to Content</a><div class='main'><nav id='main-menu' class='menu main-menu' aria-label='Main Menu'>
  <div class='container'>
    
    <ul><li class='item'>
        <a href='/'>Home</a>
      </li><li class='item'>
        <a href='/about/'>About</a>
      </li><li class='item'>
        <a href='/blog/'>Blog Posts</a>
      </li><li class='item'>
        <a href='/notes/'>Various Notes</a>
      </li></ul>
  </div>
</nav><div class='header-widgets'>
        <div class='container'></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>Sam Stelfox&#39;s Thoughts &amp; Notes</p><p class='desc site-desc'>Thoughts from a software engineer, systems architect and Linux gubernāre.</p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Extracting Content From Markdown</h1>
      

    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2014-05-30T18:34:29-04:00'>2014, May 30</time>
</span>

  
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
2 mins read
</span>


</div>


  </div>
</header>

  
  

  <div class='container entry-content'>
  <p>Recently I&rsquo;ve been playing around with building a pure javascript full text
search engine for static content sites like this one. One of the challenges
with doing this has been working around the Markdown markup embedded in the
written content.</p>

<p>Most of the markdown syntax can be stripped out simply by removing all
non-alphanumeric characters from the document and move on. This doesn&rsquo;t solve
one of the bigger challenges I&rsquo;ve experienced&hellip; Code blocks. Code blocks have
plenty of regular English-ish words and can easily skew keyword detection
within it.</p>

<p>I didn&rsquo;t want to write my own Markdown parser, so I started with the one
already in use by this site&rsquo;s renderer (<a href="https://github.com/vmg/redcarpet">redcarpet</a>). Another GitHub user,
<a href="https://github.com/toupeira">Markus Koller or toupeira on GitHub</a> provided <a href="https://github.com/vmg/redcarpet/issues/79">the basis</a> for the code
that became the redcarpet &ldquo;StripDown&rdquo; formatter, which was designed to
essentially render a Markdown document without the markup.</p>

<p>It does almost exactly what I want, except it still outputs raw code inside the
content. The following code sample includes a modified version that excludes
any code blocks. My content is also formatted inside the markdown documents to
never be longer than 80 lines, this also turns individual paragraphs and list
items into individual lines for paragraph detection.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">require <span style="color:#e6db74">&#39;redcarpet&#39;</span>
require <span style="color:#e6db74">&#39;redcarpet/render_strip&#39;</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ContentRenderer</span> <span style="color:#f92672">&lt;</span> <span style="color:#66d9ef">Redcarpet</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Render</span><span style="color:#f92672">::</span><span style="color:#66d9ef">StripDown</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">block_code</span>(<span style="color:#f92672">*</span>args)
    <span style="color:#66d9ef">nil</span>
  <span style="color:#66d9ef">end</span>

  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">list_item</span>(content, list_type)
    content<span style="color:#f92672">.</span>gsub(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34; &#34;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">end</span>

  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">paragraph</span>(text)
    text<span style="color:#f92672">.</span>gsub(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34; &#34;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

markdown <span style="color:#f92672">=</span> <span style="color:#66d9ef">Redcarpet</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Markdown</span><span style="color:#f92672">.</span>new(<span style="color:#66d9ef">ContentRenderer</span>, <span style="color:#e6db74">fenced_code_blocks</span>: <span style="color:#66d9ef">true</span>)
puts markdown<span style="color:#f92672">.</span>render(<span style="color:#66d9ef">File</span><span style="color:#f92672">.</span>read(<span style="color:#e6db74">&#39;sample_markdown_article.md&#39;</span>))</code></pre></div>
<p>The above code will print out just the content of the markdown formatted file
&lsquo;sample_markdown_article.md&rsquo;.</p>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='tags'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
<span class='screen-reader-text'>Tags: </span><a class='tag' href='/tags/development/'>development</a>, <a class='tag' href='/tags/tips/'>tips</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/blog/2014/05/pg-error-error-type-hstore-does-not-exist/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>PG::Error: ERROR: Type &#39;Hstore&#39; Does Not Exist</a>
    </div><div class='next-entry sep-before'>
      <a href='/blog/2014/06/modifying-the-hosts-file-in-a-docker-container/'>
        <span class='screen-reader-text'>Next post: </span>Modifying the Hosts File in a Docker Container<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>




      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><div class='copyright'>
  <p> &copy; 2011-2019 Sam Stelfox | <a rel='license' href='/licenses/'>Licensing</a></p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__assets_js_src="/assets/js/"</script>

<script src='/assets/js/main.67d669ac.js'></script>

</body>

</html>

