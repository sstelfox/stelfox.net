<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="While running an aide check on one of my servers after updating it, I started seeing a large number of very concerning warning messages:
/usr/sbin/prelink: /bin/mailx: at least one of file&amp;#39;s dependencies has changed since prelinking Error on exit of prelink child process /usr/sbin/prelink: /bin/rpm: at least one of file&amp;#39;s dependencies has changed since prelinking Error on exit of prelink child process /usr/sbin/prelink: /sbin/readahead: at least one of file&amp;#39;s dependencies has changed since prelinking Error on exit of prelink child process /usr/sbin/prelink: /lib64/libkrb5."><meta name=keywords content="blog,programming,linux,systems,personal,rust,philosophy,linux"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://stelfox.net/blog/2014/08/dependency-prelink-issues/><title>Dependency Prelink Issues :: ./Sam_Stelfox.sh â€” A simple place for my collected thoughts and notes.
</title><link rel=stylesheet href=/main.949191c1dcc9c4a887997048b240354e47152016d821198f89448496ba42e491.css integrity="sha256-lJGRwdzJxKiHmXBIskA1TkcVIBbYIRmPiUSElrpC5JE="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel="shortcut icon" href=/favicon.ico><meta itemprop=name content="Dependency Prelink Issues"><meta itemprop=description content="While running an aide check on one of my servers after updating it, I started seeing a large number of very concerning warning messages:
/usr/sbin/prelink: /bin/mailx: at least one of file's dependencies has changed since prelinking Error on exit of prelink child process /usr/sbin/prelink: /bin/rpm: at least one of file's dependencies has changed since prelinking Error on exit of prelink child process /usr/sbin/prelink: /sbin/readahead: at least one of file's dependencies has changed since prelinking Error on exit of prelink child process /usr/sbin/prelink: /lib64/libkrb5."><meta itemprop=datePublished content="2014-08-12T16:16:14-04:00"><meta itemprop=dateModified content="2014-08-12T16:16:14-04:00"><meta itemprop=wordCount content="334"><meta itemprop=keywords content="Linux"><meta name=twitter:card content="summary"><meta name=twitter:title content="Dependency Prelink Issues"><meta name=twitter:description content="While running an aide check on one of my servers after updating it, I started seeing a large number of very concerning warning messages:
/usr/sbin/prelink: /bin/mailx: at least one of file's dependencies has changed since prelinking Error on exit of prelink child process /usr/sbin/prelink: /bin/rpm: at least one of file's dependencies has changed since prelinking Error on exit of prelink child process /usr/sbin/prelink: /sbin/readahead: at least one of file's dependencies has changed since prelinking Error on exit of prelink child process /usr/sbin/prelink: /lib64/libkrb5."><meta property="article:published_time" content="2014-08-12 16:16:14 -0400 EDT"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>./Sam_Stelfox.sh</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about/>About</a></li><li><a href=/notes/>Notes</a></li><li><a href=/blog/>Posts</a></li></ul></nav><span class=menu-trigger><svg viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://stelfox.net/blog/2014/08/dependency-prelink-issues/>Dependency Prelink Issues</a></h2><div class=post-content><p>While running an aide check on one of my servers after updating it, I started
seeing a large number of very concerning warning messages:</p><pre tabindex=0><code>/usr/sbin/prelink: /bin/mailx: at least one of file&#39;s dependencies has changed since prelinking
Error on exit of prelink child process
/usr/sbin/prelink: /bin/rpm: at least one of file&#39;s dependencies has changed since prelinking
Error on exit of prelink child process
/usr/sbin/prelink: /sbin/readahead: at least one of file&#39;s dependencies has changed since prelinking
Error on exit of prelink child process
/usr/sbin/prelink: /lib64/libkrb5.so.3.3: at least one of file&#39;s dependencies has changed since prelinking
Error on exit of prelink child process
/usr/sbin/prelink: /lib64/libgssapi_krb5.so.2.2: at least one of file&#39;s dependencies has changed since prelinking
</code></pre><p>The list went on with maybe a total of forty packages and libraries. My initial
reaction was 'Did I get hacked?'. Before running the updates I ran an aide
verification check which returned no issues and the files that were now
displaying the issue were in the packages that got updated.</p><p>What was the next worse scenario? The packages had been tampered with and I
just installed malicious files. This didn't seem likely as the packages are all
signed with GPG and an aide check would have caught tampering with my trust
database, the <code>gpg</code> binary, or the aide binary. Still a key could have been
compromised.</p><p>After some Googling I came across people with similar issues, (including one
annoyingly paywalled Red Hat article on the issue). Several people simply ended
the conversation on the assumption the user with the issue had been hacked.
Finally I <a href=http://lists.centos.org/pipermail/centos/2007-December/049222.html>came across one helpful individual</a> with the fix. The binaries
just need to have their prelink cache updated again. This can be accomplished
with the following command on CentOS 6.5 (probably the same on others).</p><pre tabindex=0><code>/usr/sbin/prelink -av -mR
</code></pre><p><em>Update:</em> Ultimately I decided to follow <a href=https://stelfox.net/notes/linux-hardening/>my own advice</a> (search for
prelink) and just simply disabled prelinking too prevent it from interferring
with aide checks and causing other weird issues. The memory trade-off isn't
valuable enough for me.</p></div></article><hr><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://stelfox.net/tags/linux/>linux</a></span></p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"/><line x1="1.05" y1="12" x2="7" y2="12"/><line x1="17.01" y1="12" x2="22.96" y2="12"/></svg><a href=bd9e1ab3269fdee0856f80854c902432ef10f201 target=_blank rel=noopener>bd9e1ab3</a> @ 2024-07-14</p></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc+cxaJzDdCYbAW0X1G+DgZYvtKFXe6MBex8jUJ2JT25mQx+YjACIng=="></script></body></html>