<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="I setup IPv6 on my home network with an OpenWRT router and Hurricane Electric and now I suddenly have an opinion on the state of IPv6 security. This is something that I&amp;rsquo;ve been meaning to do for some time and have been mulling over in the back of my mind. I&amp;rsquo;ll go over the details from start to finish of setting up hurricane electric on the router in another post as the information to do so is very scattered and disjointed."><meta name=keywords content="blog,programming,linux,systems,personal,rust,philosophy,ipv6,networking,security"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://stelfox.net/blog/2012/07/thoughts-on-ipv6-security-and-mitigation/><title>Thoughts on IPv6 Security and Mitigation :: Sam Stelfox — A simple place for my collected thoughts and notes.
</title><link rel=stylesheet href=/main.c8c76086c15b9d686ec1778dcf935d2ad37f3bb9c23165d2bd157ba7b18e5aec.css integrity="sha256-yMdghsFbnWhuwXeNz5NdKtN/O7nCMWXSvRV7p7GOWuw="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Thoughts on IPv6 Security and Mitigation"><meta itemprop=description content="I setup IPv6 on my home network with an OpenWRT router and Hurricane Electric and now I suddenly have an opinion on the state of IPv6 security. This is something that I’ve been meaning to do for some time and have been mulling over in the back of my mind. I’ll go over the details from start to finish of setting up hurricane electric on the router in another post as the information to do so is very scattered and disjointed."><meta itemprop=datePublished content="2012-07-22T03:07:42+00:00"><meta itemprop=dateModified content="2012-07-22T03:07:42+00:00"><meta itemprop=wordCount content="889"><meta itemprop=keywords content="Ipv6,Networking,Security"><meta name=twitter:card content="summary"><meta name=twitter:title content="Thoughts on IPv6 Security and Mitigation"><meta name=twitter:description content="I setup IPv6 on my home network with an OpenWRT router and Hurricane Electric and now I suddenly have an opinion on the state of IPv6 security. This is something that I’ve been meaning to do for some time and have been mulling over in the back of my mind. I’ll go over the details from start to finish of setting up hurricane electric on the router in another post as the information to do so is very scattered and disjointed."><meta property="article:published_time" content="2012-07-22 03:07:42 +0000 UTC"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>./Sam_Stelfox.sh</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/blog/>Posts</a></li><li><a href=/notes/>Notes</a></li><li><a href=/about/>About Me</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://stelfox.net/blog/2012/07/thoughts-on-ipv6-security-and-mitigation/>Thoughts on IPv6 Security and Mitigation</a></h2><div class=post-content><p>I setup IPv6 on my home network with an OpenWRT router and Hurricane Electric
and now I suddenly have an opinion on the state of IPv6 security. This is
something that I&rsquo;ve been meaning to do for some time and have been mulling over
in the back of my mind. I&rsquo;ll go over the details from start to finish of
setting up hurricane electric on the router in another post as the information
to do so is very scattered and disjointed. It does appear to be very well
documented on the OpenWRT wiki but I found that they leave out some very
important steps, so stay tuned for that.</p><p>Lets start with the loss of NAT. NAT was never intended to be a security
measure and lots of people will argue with me for saying that it was. However,
the truth of the matter is that any machine that is behind a NAT is not
directly addressable from the internet without someone on the inside
intentionally poking holes (even if that someone is a bad-guy).</p><p>Anyone technically knowledgeable enough can usually use fingerprints of how a
machine responds to different types of traffic both normal and unusual to
identify what operating system, version, and specific details about the
services and potential vulnerabilities of that machine. This information is
invaluable to attackers.</p><p>One of IPv6&rsquo;s biggest selling points (and one that I quite enjoy, don&rsquo;t
misunderstand this post) is that every device is addressable. This can
potentially allow attackers to learn more about what they&rsquo;re attacking.</p><p>So how do you counter this? Well firewalls can help quite a bit in thwarting OS
fingerprinting, but even the strongest firewall won&rsquo;t completely prevent this.
Another, more protective layer that IPv6 gives you for free is it&rsquo;s sheer size.</p><p>Doing a pure enumeration of a single home subnet remotely (that is you are not
on the link IPv6 local link) would take millennia by some estimations, as
opposed the IPv4 address space which could be done at home in a matter of
weeks. One house vs the world. That is the scale we are now working at in IPv6.</p><p>The vast scale, however, while enough to defend against random scans, will not
prevent your address showing up in server logs that you connect to. A single
IPv6 address can be scanned just as easily as an IPv4 address.</p><p>What&rsquo;s more is that once an attacker has a presence on a subnet they can
enumerate every single machine on that network in a matter of seconds to
minutes. Since most home users are infected through drive by trojans, found in
emails, and websites that the user chooses to go to, and attackers are already
used to not having direct access to a machine from the internet, means the
slowness and difficulty of the raw scans just simply won&rsquo;t be an issue.</p><p>Due too the ease of enumerating local networks and that they probably contain
more vulnerable machines&mldr;. I&rsquo;ll leave that extrapolation as an exercise to my
readers. I do predict that infrastructure will become a larger target due to
this, just to collect their logs to attack home users.</p><p>The next thing that I want to bring up is IPv6, by default, uses the
interface&rsquo;s MAC address to generate the last 12 characters / 48 bits of the
IPv6 address. The rest of the local address consists of an identifier
indicating that the address was generated using a MAC address and was not
randomly generated.</p><p>So what does this actually tell us? Well if the OS and OS version can help up
specify attacks, why not the brand and possibly the model of the MAC address?
What attack vectors are waiting in the firmware of our ethernet and wireless
cards? Firmware that almost never gets updated, and is known to have bugs and
quirks?</p><p>That one is actually an easy one, RFC 3041 defines &ldquo;Privacy Addresses&rdquo;. These
are completely random local addresses that get generated once a day. Logs
become increasingly useless on the server end, there is a lot of decoys on
networks, and we&rsquo;re no longer exposing as much information to potential
hostiles.</p><p>I use Fedora 17 and it took me a while to figure out how to enable privacy
addresses the &ldquo;Red Hat&rdquo; way. You can easily do it generally on any Linux system
with sysctl. Just add the following to your <code>/etc/sysctl.conf</code> and reload
sysctl:</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-3ae9024-1><a style=outline:none;text-decoration:none;color:inherit href=#code-3ae9024-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-3ae9024-2><a style=outline:none;text-decoration:none;color:inherit href=#code-3ae9024-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span>net.ipv6.conf.all.use_tempaddr <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>2</span>
</span></span><span style=display:flex><span>net.ipv6.conf.default.use_tempaddr <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>2</span></span></span></code></pre></td></tr></table></div></div><p>But that isn&rsquo;t the &ldquo;Red Hat&rdquo; way. Red Hat manages it&rsquo;s interfaces and network
configuration through various interface configuration files living in
<code>/etc/sysconfig/network-scripts</code>. For any IPv6 enabled interface you can turn
on privacy addresses with the following line for example in
<code>/etc/sysconfig/network-scripts/ifcfg-eth0</code>:</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-6cd6713-1><a style=outline:none;text-decoration:none;color:inherit href=#code-6cd6713-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#79c0ff>IPV6_PRIVACY</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;rfc3041&#34;</span></span></span></code></pre></td></tr></table></div></div><p>After restarting your network interfaces they will additionally have privacy
addresses that will be change automatically. The interfaces still have the MAC
based addresses as well but they will not longer be the default and thus will
not show up in remote server logs.</p><p>Now, what would be a solid and strong step forward was a way to have a local
machine register it&rsquo;s privacy address with a local IDS/IPS with an expiration,
and to automatically trigger the IDS/IPS whenever a new connection is made to
an expired privacy address. It would almost be like a free honey pot on your
own network.</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://stelfox.net/tags/ipv6/>ipv6</a></span>
<span class=tag><a href=https://stelfox.net/tags/networking/>networking</a></span>
<span class=tag><a href=https://stelfox.net/tags/security/>security</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"/><line x1="1.05" y1="12" x2="7" y2="12"/><line x1="17.01" y1="12" x2="22.96" y2="12"/></svg><a href=bd9e1ab3269fdee0856f80854c902432ef10f201 target=_blank rel=noopener>bd9e1ab3</a> @ 2024-07-14</p></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.85fad2de4f13fec3bcb3b3cb10430cdb44a7b4a9749b32938241a5c6e77718df7624f1002b880521fdc26e24ec1077fda214bf1cb36ee3045510760d09638cae.js integrity="sha512-hfrS3k8T/sO8s7PLEEMM20SntKl0mzKTgkGlxud3GN92JPEAK4gFIf3CbiTsEHf9ohS/HLNu4wRVEHYNCWOMrg=="></script></body></html>