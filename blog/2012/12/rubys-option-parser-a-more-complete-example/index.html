<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="found top level header in &amp;#34;/blog/2012/12/rubys-option-parser-a-more-complete-example/&amp;#34; that didn&amp;#39;t match meta title (&amp;#34;Ruby&amp;#39;s Option Parser - A More Complete Example&amp;#34; != &amp;#34;Ruby&amp;#39;s Option Parser - a More Complete Example&amp;#34;)Recently while writing a Ruby program I needed to parse some command line options. Helpfully Ruby provides a module named OptionParser to make this easy. I found a few parts of the documentation ambiguous and a few others down right confusing.
The catch I hit was the required field."><meta name=keywords content="blog,programming,linux,systems,personal,rust,philosophy,development,ruby"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://stelfox.net/blog/2012/12/rubys-option-parser-a-more-complete-example/><title>Ruby's Option Parser - a More Complete Example :: ./Sam_Stelfox.sh â€” A simple place for my collected thoughts and notes.
</title><link rel=stylesheet href=/main.949191c1dcc9c4a887997048b240354e47152016d821198f89448496ba42e491.css integrity="sha256-lJGRwdzJxKiHmXBIskA1TkcVIBbYIRmPiUSElrpC5JE="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel="shortcut icon" href=/favicon.ico><meta itemprop=name content="Ruby's Option Parser - a More Complete Example"><meta itemprop=description content='found top level header in "/blog/2012/12/rubys-option-parser-a-more-complete-example/" that didn&#39;t match meta title ("Ruby&#39;s Option Parser - A More Complete Example" != "Ruby&#39;s Option Parser - a More Complete Example")Recently while writing a Ruby program I needed to parse some command line options. Helpfully Ruby provides a module named OptionParser to make this easy. I found a few parts of the documentation ambiguous and a few others down right confusing.
The catch I hit was the required field.'><meta itemprop=datePublished content="2012-12-02T22:59:00-05:00"><meta itemprop=dateModified content="2012-12-02T22:59:00-05:00"><meta itemprop=wordCount content="824"><meta itemprop=keywords content="Development,Ruby"><meta name=twitter:card content="summary"><meta name=twitter:title content="Ruby's Option Parser - a More Complete Example"><meta name=twitter:description content='found top level header in "/blog/2012/12/rubys-option-parser-a-more-complete-example/" that didn&#39;t match meta title ("Ruby&#39;s Option Parser - A More Complete Example" != "Ruby&#39;s Option Parser - a More Complete Example")Recently while writing a Ruby program I needed to parse some command line options. Helpfully Ruby provides a module named OptionParser to make this easy. I found a few parts of the documentation ambiguous and a few others down right confusing.
The catch I hit was the required field.'><meta property="article:published_time" content="2012-12-02 22:59:00 -0500 EST"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>./Sam_Stelfox.sh</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about/>About</a></li><li><a href=/notes/>Notes</a></li><li><a href=/blog/>Posts</a></li></ul></nav><span class=menu-trigger><svg viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://stelfox.net/blog/2012/12/rubys-option-parser-a-more-complete-example/>Ruby's Option Parser - a More Complete Example</a></h2><div class=post-content>found top level header in "/blog/2012/12/rubys-option-parser-a-more-complete-example/" that didn't match meta title ("Ruby's Option Parser - A More Complete Example" != "Ruby's Option Parser - a More Complete Example")<p>Recently while writing a Ruby program I needed to parse some command line options. Helpfully Ruby provides a module named <code>OptionParser</code> to make this easy. I found a few parts of the documentation ambiguous and a few others down right confusing.</p><p>The catch I hit was the required field. In my mind the definition of a required argument is something that needs to be passed on the command line to continue. What<code>OptionParser</code> actually means is that a value isn't required when the argument is passed.<code>OptionParser</code> already provides boolean switches, so when someone would use an optional switch is beyond me.</p><p>To make it a little more clear and to have something to work from in the future I created the following chunk of code that includes a Configuration singleton that can be used anywhere within your codebase to access the run-time configuration, a sample parser with a wide range of different types of options, and it will load configuration from a file named "config.yml" in the same directory.</p><p>I feel like the following is a much more complete explanation of how <code>OptionParser</code> is supposed to be used with supporting code.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>  1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2>  2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3>  3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4>  4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5>  5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6>  6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7>  7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8>  8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9>  9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10> 10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11> 11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12> 12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13> 13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14> 14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15> 15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16> 16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17> 17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18> 18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19> 19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20> 20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21> 21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22> 22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23> 23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24> 24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25> 25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26> 26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27> 27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28> 28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29> 29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30> 30</a>
</span><span class=lnt id=hl-0-31><a class=lnlinks href=#hl-0-31> 31</a>
</span><span class=lnt id=hl-0-32><a class=lnlinks href=#hl-0-32> 32</a>
</span><span class=lnt id=hl-0-33><a class=lnlinks href=#hl-0-33> 33</a>
</span><span class=lnt id=hl-0-34><a class=lnlinks href=#hl-0-34> 34</a>
</span><span class=lnt id=hl-0-35><a class=lnlinks href=#hl-0-35> 35</a>
</span><span class=lnt id=hl-0-36><a class=lnlinks href=#hl-0-36> 36</a>
</span><span class=lnt id=hl-0-37><a class=lnlinks href=#hl-0-37> 37</a>
</span><span class=lnt id=hl-0-38><a class=lnlinks href=#hl-0-38> 38</a>
</span><span class=lnt id=hl-0-39><a class=lnlinks href=#hl-0-39> 39</a>
</span><span class=lnt id=hl-0-40><a class=lnlinks href=#hl-0-40> 40</a>
</span><span class=lnt id=hl-0-41><a class=lnlinks href=#hl-0-41> 41</a>
</span><span class=lnt id=hl-0-42><a class=lnlinks href=#hl-0-42> 42</a>
</span><span class=lnt id=hl-0-43><a class=lnlinks href=#hl-0-43> 43</a>
</span><span class=lnt id=hl-0-44><a class=lnlinks href=#hl-0-44> 44</a>
</span><span class=lnt id=hl-0-45><a class=lnlinks href=#hl-0-45> 45</a>
</span><span class=lnt id=hl-0-46><a class=lnlinks href=#hl-0-46> 46</a>
</span><span class=lnt id=hl-0-47><a class=lnlinks href=#hl-0-47> 47</a>
</span><span class=lnt id=hl-0-48><a class=lnlinks href=#hl-0-48> 48</a>
</span><span class=lnt id=hl-0-49><a class=lnlinks href=#hl-0-49> 49</a>
</span><span class=lnt id=hl-0-50><a class=lnlinks href=#hl-0-50> 50</a>
</span><span class=lnt id=hl-0-51><a class=lnlinks href=#hl-0-51> 51</a>
</span><span class=lnt id=hl-0-52><a class=lnlinks href=#hl-0-52> 52</a>
</span><span class=lnt id=hl-0-53><a class=lnlinks href=#hl-0-53> 53</a>
</span><span class=lnt id=hl-0-54><a class=lnlinks href=#hl-0-54> 54</a>
</span><span class=lnt id=hl-0-55><a class=lnlinks href=#hl-0-55> 55</a>
</span><span class=lnt id=hl-0-56><a class=lnlinks href=#hl-0-56> 56</a>
</span><span class=lnt id=hl-0-57><a class=lnlinks href=#hl-0-57> 57</a>
</span><span class=lnt id=hl-0-58><a class=lnlinks href=#hl-0-58> 58</a>
</span><span class=lnt id=hl-0-59><a class=lnlinks href=#hl-0-59> 59</a>
</span><span class=lnt id=hl-0-60><a class=lnlinks href=#hl-0-60> 60</a>
</span><span class=lnt id=hl-0-61><a class=lnlinks href=#hl-0-61> 61</a>
</span><span class=lnt id=hl-0-62><a class=lnlinks href=#hl-0-62> 62</a>
</span><span class=lnt id=hl-0-63><a class=lnlinks href=#hl-0-63> 63</a>
</span><span class=lnt id=hl-0-64><a class=lnlinks href=#hl-0-64> 64</a>
</span><span class=lnt id=hl-0-65><a class=lnlinks href=#hl-0-65> 65</a>
</span><span class=lnt id=hl-0-66><a class=lnlinks href=#hl-0-66> 66</a>
</span><span class=lnt id=hl-0-67><a class=lnlinks href=#hl-0-67> 67</a>
</span><span class=lnt id=hl-0-68><a class=lnlinks href=#hl-0-68> 68</a>
</span><span class=lnt id=hl-0-69><a class=lnlinks href=#hl-0-69> 69</a>
</span><span class=lnt id=hl-0-70><a class=lnlinks href=#hl-0-70> 70</a>
</span><span class=lnt id=hl-0-71><a class=lnlinks href=#hl-0-71> 71</a>
</span><span class=lnt id=hl-0-72><a class=lnlinks href=#hl-0-72> 72</a>
</span><span class=lnt id=hl-0-73><a class=lnlinks href=#hl-0-73> 73</a>
</span><span class=lnt id=hl-0-74><a class=lnlinks href=#hl-0-74> 74</a>
</span><span class=lnt id=hl-0-75><a class=lnlinks href=#hl-0-75> 75</a>
</span><span class=lnt id=hl-0-76><a class=lnlinks href=#hl-0-76> 76</a>
</span><span class=lnt id=hl-0-77><a class=lnlinks href=#hl-0-77> 77</a>
</span><span class=lnt id=hl-0-78><a class=lnlinks href=#hl-0-78> 78</a>
</span><span class=lnt id=hl-0-79><a class=lnlinks href=#hl-0-79> 79</a>
</span><span class=lnt id=hl-0-80><a class=lnlinks href=#hl-0-80> 80</a>
</span><span class=lnt id=hl-0-81><a class=lnlinks href=#hl-0-81> 81</a>
</span><span class=lnt id=hl-0-82><a class=lnlinks href=#hl-0-82> 82</a>
</span><span class=lnt id=hl-0-83><a class=lnlinks href=#hl-0-83> 83</a>
</span><span class=lnt id=hl-0-84><a class=lnlinks href=#hl-0-84> 84</a>
</span><span class=lnt id=hl-0-85><a class=lnlinks href=#hl-0-85> 85</a>
</span><span class=lnt id=hl-0-86><a class=lnlinks href=#hl-0-86> 86</a>
</span><span class=lnt id=hl-0-87><a class=lnlinks href=#hl-0-87> 87</a>
</span><span class=lnt id=hl-0-88><a class=lnlinks href=#hl-0-88> 88</a>
</span><span class=lnt id=hl-0-89><a class=lnlinks href=#hl-0-89> 89</a>
</span><span class=lnt id=hl-0-90><a class=lnlinks href=#hl-0-90> 90</a>
</span><span class=lnt id=hl-0-91><a class=lnlinks href=#hl-0-91> 91</a>
</span><span class=lnt id=hl-0-92><a class=lnlinks href=#hl-0-92> 92</a>
</span><span class=lnt id=hl-0-93><a class=lnlinks href=#hl-0-93> 93</a>
</span><span class=lnt id=hl-0-94><a class=lnlinks href=#hl-0-94> 94</a>
</span><span class=lnt id=hl-0-95><a class=lnlinks href=#hl-0-95> 95</a>
</span><span class=lnt id=hl-0-96><a class=lnlinks href=#hl-0-96> 96</a>
</span><span class=lnt id=hl-0-97><a class=lnlinks href=#hl-0-97> 97</a>
</span><span class=lnt id=hl-0-98><a class=lnlinks href=#hl-0-98> 98</a>
</span><span class=lnt id=hl-0-99><a class=lnlinks href=#hl-0-99> 99</a>
</span><span class=lnt id=hl-0-100><a class=lnlinks href=#hl-0-100>100</a>
</span><span class=lnt id=hl-0-101><a class=lnlinks href=#hl-0-101>101</a>
</span><span class=lnt id=hl-0-102><a class=lnlinks href=#hl-0-102>102</a>
</span><span class=lnt id=hl-0-103><a class=lnlinks href=#hl-0-103>103</a>
</span><span class=lnt id=hl-0-104><a class=lnlinks href=#hl-0-104>104</a>
</span><span class=lnt id=hl-0-105><a class=lnlinks href=#hl-0-105>105</a>
</span><span class=lnt id=hl-0-106><a class=lnlinks href=#hl-0-106>106</a>
</span><span class=lnt id=hl-0-107><a class=lnlinks href=#hl-0-107>107</a>
</span><span class=lnt id=hl-0-108><a class=lnlinks href=#hl-0-108>108</a>
</span><span class=lnt id=hl-0-109><a class=lnlinks href=#hl-0-109>109</a>
</span><span class=lnt id=hl-0-110><a class=lnlinks href=#hl-0-110>110</a>
</span><span class=lnt id=hl-0-111><a class=lnlinks href=#hl-0-111>111</a>
</span><span class=lnt id=hl-0-112><a class=lnlinks href=#hl-0-112>112</a>
</span><span class=lnt id=hl-0-113><a class=lnlinks href=#hl-0-113>113</a>
</span><span class=lnt id=hl-0-114><a class=lnlinks href=#hl-0-114>114</a>
</span><span class=lnt id=hl-0-115><a class=lnlinks href=#hl-0-115>115</a>
</span><span class=lnt id=hl-0-116><a class=lnlinks href=#hl-0-116>116</a>
</span><span class=lnt id=hl-0-117><a class=lnlinks href=#hl-0-117>117</a>
</span><span class=lnt id=hl-0-118><a class=lnlinks href=#hl-0-118>118</a>
</span><span class=lnt id=hl-0-119><a class=lnlinks href=#hl-0-119>119</a>
</span><span class=lnt id=hl-0-120><a class=lnlinks href=#hl-0-120>120</a>
</span><span class=lnt id=hl-0-121><a class=lnlinks href=#hl-0-121>121</a>
</span><span class=lnt id=hl-0-122><a class=lnlinks href=#hl-0-122>122</a>
</span><span class=lnt id=hl-0-123><a class=lnlinks href=#hl-0-123>123</a>
</span><span class=lnt id=hl-0-124><a class=lnlinks href=#hl-0-124>124</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=ch>#!/usr/bin/env ruby</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># This file provides an example of creating a command line application with a</span>
</span></span><span class=line><span class=cl><span class=c1># wide variety of command line options, parsing and the like as well as global</span>
</span></span><span class=line><span class=cl><span class=c1># configuration singleton that can be relied on throughout a program.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># This entire setup lives within the &#34;Example&#34; module. These are really common</span>
</span></span><span class=line><span class=cl><span class=c1># names and it would be a shame to override required functionality in other code</span>
</span></span><span class=line><span class=cl><span class=c1># that wasn&#39;t properly namespaced.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>require</span> <span class=s1>&#39;optparse&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>require</span> <span class=s1>&#39;singleton&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>require</span> <span class=s1>&#39;yaml&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>module</span> <span class=nn>Example</span>
</span></span><span class=line><span class=cl>  <span class=c1># Defines the available configuration options for the configuration</span>
</span></span><span class=line><span class=cl>  <span class=no>ConfigurationStruct</span> <span class=o>=</span> <span class=no>Struct</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=ss>:enum</span><span class=p>,</span> <span class=ss>:list</span><span class=p>,</span> <span class=ss>:required</span><span class=p>,</span> <span class=ss>:optional</span><span class=p>,</span> <span class=ss>:verbose</span><span class=p>,</span> <span class=ss>:float</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>class</span> <span class=nc>Configuration</span>
</span></span><span class=line><span class=cl>    <span class=kp>include</span> <span class=no>Singleton</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Initialize the configuration and set defaults:</span>
</span></span><span class=line><span class=cl>    <span class=vc>@@config</span> <span class=o>=</span> <span class=no>ConfigurationStruct</span><span class=o>.</span><span class=n>new</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># This is where the defaults are being set</span>
</span></span><span class=line><span class=cl>    <span class=vc>@@config</span><span class=o>.</span><span class=n>enum</span> <span class=o>=</span> <span class=ss>:one</span>
</span></span><span class=line><span class=cl>    <span class=vc>@@config</span><span class=o>.</span><span class=n>list</span> <span class=o>=</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl>    <span class=vc>@@config</span><span class=o>.</span><span class=n>optional</span> <span class=o>=</span> <span class=kp>nil</span>
</span></span><span class=line><span class=cl>    <span class=vc>@@config</span><span class=o>.</span><span class=n>verbose</span> <span class=o>=</span> <span class=kp>false</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>config</span>
</span></span><span class=line><span class=cl>      <span class=k>yield</span><span class=p>(</span><span class=vc>@@config</span><span class=p>)</span> <span class=k>if</span> <span class=nb>block_given?</span>
</span></span><span class=line><span class=cl>      <span class=vc>@@config</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Loads a YAML configuration file and sets each of the configuration values to</span>
</span></span><span class=line><span class=cl>    <span class=c1># whats in the file.</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>load</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=no>YAML</span><span class=o>::</span><span class=n>load_file</span><span class=p>(</span><span class=n>file</span><span class=p>)</span><span class=o>.</span><span class=n>each</span> <span class=k>do</span> <span class=o>|</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=o>|</span>
</span></span><span class=line><span class=cl>        <span class=nb>self</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>#{</span><span class=n>key</span><span class=si>}</span><span class=s2>=&#34;</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># This provides an easy way to dump the configuration as a hash</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>to_hash</span>
</span></span><span class=line><span class=cl>      <span class=no>Hash</span><span class=o>[</span><span class=vc>@@config</span><span class=o>.</span><span class=n>each_pair</span><span class=o>.</span><span class=n>to_a</span><span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Pass any other calls (most likely attribute setters/getters on to the</span>
</span></span><span class=line><span class=cl>    <span class=c1># configuration as a way to easily set/get attribute values </span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>method_missing</span><span class=p>(</span><span class=nb>method</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>block</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=vc>@@config</span><span class=o>.</span><span class=n>respond_to?</span><span class=p>(</span><span class=nb>method</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=vc>@@config</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=nb>method</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>block</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=no>NoMethodError</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Handles validating the configuration that has been loaded/configured</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>validate!</span>
</span></span><span class=line><span class=cl>      <span class=n>valid</span> <span class=o>=</span> <span class=kp>true</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>valid</span> <span class=o>=</span> <span class=kp>false</span> <span class=k>if</span> <span class=no>Configuration</span><span class=o>.</span><span class=n>required</span><span class=o>.</span><span class=n>nil?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>raise</span> <span class=no>ArgumentError</span> <span class=k>unless</span> <span class=n>valid</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>class</span> <span class=nc>ConfigurationParser</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>parse</span><span class=p>(</span><span class=n>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>opts</span> <span class=o>=</span> <span class=no>OptionParser</span><span class=o>.</span><span class=n>new</span> <span class=k>do</span> <span class=o>|</span><span class=n>parser</span><span class=o>|</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>parser</span><span class=o>.</span><span class=n>separator</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>parser</span><span class=o>.</span><span class=n>separator</span> <span class=s2>&#34;Specific options:&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>parser</span><span class=o>.</span><span class=n>on</span><span class=p>(</span><span class=s2>&#34;--enum ENUM&#34;</span><span class=p>,</span> <span class=o>[</span><span class=ss>:one</span><span class=p>,</span> <span class=ss>:two</span><span class=p>,</span> <span class=ss>:three</span><span class=o>]</span><span class=p>,</span> <span class=s2>&#34;This field requires one of a set of predefined values be&#34;</span><span class=p>,</span> <span class=s2>&#34;set. If wrapped in brackets this option can be set to nil.&#34;</span><span class=p>)</span> <span class=k>do</span> <span class=o>|</span><span class=n>setting</span><span class=o>|</span>
</span></span><span class=line><span class=cl>          <span class=no>Configuration</span><span class=o>.</span><span class=n>enum</span> <span class=o>=</span> <span class=n>setting</span>
</span></span><span class=line><span class=cl>        <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>parser</span><span class=o>.</span><span class=n>on</span><span class=p>(</span><span class=s2>&#34;-l&#34;</span><span class=p>,</span> <span class=s2>&#34;--list x,y&#34;</span><span class=p>,</span> <span class=nb>Array</span><span class=p>,</span> <span class=s2>&#34;This command flag takes a comma separated list (without&#34;</span><span class=p>,</span> <span class=s2>&#34;spaces) of values and turns it into an array. This requires&#34;</span><span class=p>,</span> <span class=s2>&#34;at least one argument.&#34;</span><span class=p>)</span> <span class=k>do</span> <span class=o>|</span><span class=n>setting</span><span class=o>|</span>
</span></span><span class=line><span class=cl>          <span class=no>Configuration</span><span class=o>.</span><span class=n>list</span> <span class=o>=</span> <span class=n>setting</span>
</span></span><span class=line><span class=cl>        <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>parser</span><span class=o>.</span><span class=n>on</span><span class=p>(</span><span class=s2>&#34;--[no-]verbose&#34;</span><span class=p>,</span> <span class=s2>&#34;This is a common boolean flag, setting verbosity to either&#34;</span><span class=p>,</span> <span class=s2>&#34;true or false.&#34;</span><span class=p>)</span> <span class=k>do</span> <span class=o>|</span><span class=n>setting</span><span class=o>|</span>
</span></span><span class=line><span class=cl>          <span class=no>Configuration</span><span class=o>.</span><span class=n>verbose</span> <span class=o>=</span> <span class=n>setting</span>
</span></span><span class=line><span class=cl>        <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>parser</span><span class=o>.</span><span class=n>on</span><span class=p>(</span><span class=s2>&#34;--optional [STR]&#34;</span><span class=p>,</span> <span class=s2>&#34;This command doesn&#39;t require a string to be passed to it, if&#34;</span><span class=p>,</span> <span class=s2>&#34;nothing is passed it will be nil. No error will be raised if&#34;</span><span class=p>,</span> <span class=s2>&#34;nothing is passed to it that logic needs to be handled&#34;</span><span class=p>,</span> <span class=s2>&#34;yourself.&#34;</span><span class=p>)</span> <span class=k>do</span> <span class=o>|</span><span class=n>setting</span><span class=o>|</span>
</span></span><span class=line><span class=cl>          <span class=no>Configuration</span><span class=o>.</span><span class=n>optional</span> <span class=o>=</span> <span class=n>setting</span>
</span></span><span class=line><span class=cl>        <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>parser</span><span class=o>.</span><span class=n>on</span><span class=p>(</span><span class=s2>&#34;-r&#34;</span><span class=p>,</span> <span class=s2>&#34;--required STR&#34;</span><span class=p>,</span> <span class=s2>&#34;This command requires a string to be passed to it.&#34;</span><span class=p>)</span> <span class=k>do</span> <span class=o>|</span><span class=n>setting</span><span class=o>|</span>
</span></span><span class=line><span class=cl>          <span class=no>Configuration</span><span class=o>.</span><span class=n>required</span> <span class=o>=</span> <span class=n>setting</span>
</span></span><span class=line><span class=cl>        <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>parser</span><span class=o>.</span><span class=n>on</span><span class=p>(</span><span class=s2>&#34;--float NUM&#34;</span><span class=p>,</span> <span class=nb>Float</span><span class=p>,</span> <span class=s2>&#34;This command will only accept an integer or a float.&#34;</span><span class=p>)</span> <span class=k>do</span> <span class=o>|</span><span class=n>setting</span><span class=o>|</span>
</span></span><span class=line><span class=cl>          <span class=no>Configuration</span><span class=o>.</span><span class=n>float</span> <span class=o>=</span> <span class=n>setting</span>
</span></span><span class=line><span class=cl>        <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>parser</span><span class=o>.</span><span class=n>on_tail</span><span class=p>(</span><span class=s2>&#34;-h&#34;</span><span class=p>,</span> <span class=s2>&#34;--help&#34;</span><span class=p>,</span> <span class=s2>&#34;--usage&#34;</span><span class=p>,</span> <span class=s2>&#34;Show this usage message and quit.&#34;</span><span class=p>)</span> <span class=k>do</span> <span class=o>|</span><span class=n>setting</span><span class=o>|</span>
</span></span><span class=line><span class=cl>          <span class=nb>puts</span> <span class=n>parser</span><span class=o>.</span><span class=n>help</span>
</span></span><span class=line><span class=cl>          <span class=nb>exit</span>
</span></span><span class=line><span class=cl>        <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>parser</span><span class=o>.</span><span class=n>on_tail</span><span class=p>(</span><span class=s2>&#34;-v&#34;</span><span class=p>,</span> <span class=s2>&#34;--version&#34;</span><span class=p>,</span> <span class=s2>&#34;Show version information about this program and quit.&#34;</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>          <span class=nb>puts</span> <span class=s2>&#34;Option Parser Example v1.0.0&#34;</span>
</span></span><span class=line><span class=cl>          <span class=nb>exit</span>
</span></span><span class=line><span class=cl>        <span class=k>end</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>opts</span><span class=o>.</span><span class=n>parse!</span><span class=p>(</span><span class=n>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=no>File</span><span class=o>.</span><span class=n>exists?</span><span class=p>(</span><span class=s2>&#34;config.yml&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=no>Example</span><span class=o>::</span><span class=no>Configuration</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&#34;config.yml&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=no>Example</span><span class=o>::</span><span class=no>ConfigurationParser</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=no>ARGV</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=no>Example</span><span class=o>::</span><span class=no>Configuration</span><span class=o>.</span><span class=n>validate!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>require</span> <span class=s2>&#34;json&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>puts</span> <span class=no>JSON</span><span class=o>.</span><span class=n>pretty_generate</span><span class=p>(</span><span class=no>Example</span><span class=o>::</span><span class=no>Configuration</span><span class=o>.</span><span class=n>to_hash</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></div></article><hr><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://stelfox.net/tags/development/>development</a></span>
<span class=tag><a href=https://stelfox.net/tags/ruby/>ruby</a></span></p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"/><line x1="1.05" y1="12" x2="7" y2="12"/><line x1="17.01" y1="12" x2="22.96" y2="12"/></svg><a href=5cc61bddb3608f4b520ea01481747b9e2f886434 target=_blank rel=noopener>5cc61bdd</a> @ 2024-07-15</p></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc+cxaJzDdCYbAW0X1G+DgZYvtKFXe6MBex8jUJ2JT25mQx+YjACIng=="></script></body></html>