<!DOCTYPE html>
<html lang='en'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='In addition to the WiFi vulnerability a much more limited vulnerability was announced around private GPG keys that were generated using Infineon&rsquo;s RSA Library version v1.02.013.
The vulnerability lies in shortcuts taken to speed up the key generation using the library. The performance increase makes the private key vulnerable to factorization attacks using an extension to Coppersmith&rsquo;s attack.
It has been confirmed that YubiKey 4s are effected as are many nations national ID cards.'>
<meta name='theme-color' content='#ffcd00'>

<meta property='og:title' content='Vulnerable Smart Cards • Sam Stelfox&#39;s Thoughts &amp; Notes'>
<meta property='og:description' content='In addition to the WiFi vulnerability a much more limited vulnerability was announced around private GPG keys that were generated using Infineon&rsquo;s RSA Library version v1.02.013.
The vulnerability lies in shortcuts taken to speed up the key generation using the library. The performance increase makes the private key vulnerable to factorization attacks using an extension to Coppersmith&rsquo;s attack.
It has been confirmed that YubiKey 4s are effected as are many nations national ID cards.'>
<meta property='og:url' content='https://stelfox.net/blog/2017/10/vulnerable-smart-cards/'>
<meta property='og:site_name' content='Sam Stelfox&#39;s Thoughts &amp; Notes'>
<meta property='og:type' content='article'><meta property='article:section' content='blog'><meta property='article:tag' content='security'><meta property='article:published_time' content='2017-10-16T12:25:58-04:00'/><meta property='article:modified_time' content='2017-10-16T12:25:58-04:00'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.51-DEV" />

  <title>Vulnerable Smart Cards • Sam Stelfox&#39;s Thoughts &amp; Notes</title>
  <link rel='canonical' href='https://stelfox.net/blog/2017/10/vulnerable-smart-cards/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.4a10984a.css'><style>
:root{--color-accent:#ffcd00;}
</style>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-32188490-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  

</head>
<body class='page type-blog'>

  <div class='site'><a class='screen-reader-text' href='#content'>Skip to Content</a><div class='main'><nav id='main-menu' class='menu main-menu' aria-label='Main Menu'>
  <div class='container'>
    
    <ul><li class='item'>
        <a href='/'>Home</a>
      </li><li class='item'>
        <a href='/about/'>About</a>
      </li><li class='item'>
        <a href='/blog/'>Blog Posts</a>
      </li><li class='item'>
        <a href='/notes/'>Various Notes</a>
      </li></ul>
  </div>
</nav><div class='header-widgets'>
        <div class='container'></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>Sam Stelfox&#39;s Thoughts &amp; Notes</p><p class='desc site-desc'>Thoughts from a software engineer, systems architect and Linux gubernāre.</p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Vulnerable Smart Cards</h1>
      

    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2017-10-16T12:25:58-04:00'>2017, Oct 16</time>
</span>

  
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
3 mins read
</span>


</div>


  </div>
</header>

  
  

  <div class='container entry-content'>
  <p>In addition to the <a href="https://stelfox.net/blog/2017/10/a-krack-in-the-defenses/">WiFi vulnerability</a> a much more limited vulnerability
was <a href="https://crocs.fi.muni.cz/public/papers/rsa_ccs17">announced</a> around private GPG keys that were generated using <a href="https://www.commoncriteriaportal.org/files/epfiles/0782V2a_pdf.pdf">Infineon&rsquo;s
RSA Library version v1.02.013</a>.</p>

<p>The vulnerability lies in shortcuts taken to speed up the key generation using
the library. The performance increase makes the private key vulnerable to
factorization attacks using an extension to <a href="https://en.wikipedia.org/wiki/Coppersmith%27s_attack">Coppersmith&rsquo;s attack</a>.</p>

<p>It has been <a href="https://www.yubico.com/2017/10/infineon-rsa-key-generation-issue/">confirmed that YubiKey 4s</a> are effected as are many nations
national ID cards. Earlier versions of YubiKey were not affected (including my
preference the Neo). This brings up a controversial decision <a href="https://www.yubico.com/2016/05/secure-hardware-vs-open-source/">made by
Yubico</a> a little over a year ago to switch from tested open source and
widely inspected libraries, to closed source versions.</p>

<p>This led some very <a href="https://plus.google.com/+KonstantinRyabitsev/posts/fjgYKfPMF13">respected individuals</a> to accuse Yubico that they were
relying on <a href="https://en.wikipedia.org/wiki/Security_through_obscurity">security through obscurity</a> as core to their security and I have
to agree. Would a FOSS implementation guaranteed this would have been spotted
sooner? No, absolutely not.</p>

<p>If this implementation was open source the fix could be assessed to ensure it
was complete. This very public vulnerability would have also driven passionate
security researchers to look and test other parts of the code, after all
exposing one bug statistically indicates the presence of many more.</p>

<p>One amusing anecdote from the Yubico blog post I&rsquo;ve already linked to is this
snippet:</p>

<blockquote>
<p>Yubico has developed the firmware from the ground up. These devices are
loaded by Yubico and cannot be updated.</p>
</blockquote>

<p>It seems they didn&rsquo;t roll their own crypto library, which is good but also
belies the first part of this sentence. The latter part is concerning. If they
can&rsquo;t be updated all YubiKey 4s out there can not and should never ever be used
for key generation and there is nothing consumers that have already purchased
the devices can do about their existing faulty devices without purchasing a
new one or with any luck have Yubico replace them with a non-vulnerable
version as they did with <a href="https://developers.yubico.com/ykneo-openpgp/SecurityAdvisory%202015-04-14.html">CVE-2015-3298</a>.</p>

<p>While this doesn&rsquo;t directly effect me, I did distinctly notice a mention that
this effects TPM chips used in many laptops, and the keys used by Windows
BitLocker. If your laptop uses an affected chip, your full disk encryption
could be broken by a determined individual over the course of a year or a well
financed attacker in under a month.</p>

<p>If you have a GPG key, or the public portion of any RSA key that may be
affected you can test it using a <a href="https://keychest.net/roca">convenient online analyzer</a>.</p>

<p><strong><em>Update:</em></strong> Yubico is providing mitigation recommendations and optional
<a href="https://www.yubico.com/keycheck">YubiKey replacements</a>. There are also reports rolling in that GitHub is
taking the proactive step of disabling all keys that have been found to be weak
according to the ROCA tests (Well done GitHub!).</p>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='tags'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
<span class='screen-reader-text'>Tags: </span><a class='tag' href='/tags/security/'>security</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/blog/2017/10/a-krack-in-the-defenses/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>A KRACK In the Defenses</a>
    </div><div class='next-entry sep-before'>
      <a href='/blog/2017/10/linux-audit-rule-paths/'>
        <span class='screen-reader-text'>Next post: </span>Linux Audit Rule Paths<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>




      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><div class='copyright'>
  <p> &copy; 2011-2019 Sam Stelfox | <a rel='license' href='/licenses/'>Licensing</a></p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__public_path__='\/assets\/js\/'</script>

<script src='/assets/js/main.fae8ed32.js'></script>

</body>

</html>

