<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="I have the privilege of working full remote. To stay connected with our other remote workers and the main office we keep a live video conference going all the time. It&amp;rsquo;s pretty convenient and definitely allows me to continue to feel connected with the company.
During one of our stand ups, a coworker mentioned that they&amp;rsquo;d like to see how things looked over time. I have three 1440p monitors and largely leave the video conference on my right most window, which makes recording (an audio free) timelapse pretty easy with FFmpeg."><meta name=keywords content="blog,programming,linux,systems,personal,rust,philosophy,linux,tips"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://stelfox.net/blog/2018/06/time-lapse-of-a-linux-desktop/><title>Timelapse of a Linux Desktop :: Sam Stelfox — A simple place for my collected thoughts and notes.
</title><link rel=stylesheet href=/main.c8c76086c15b9d686ec1778dcf935d2ad37f3bb9c23165d2bd157ba7b18e5aec.css integrity="sha256-yMdghsFbnWhuwXeNz5NdKtN/O7nCMWXSvRV7p7GOWuw="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Timelapse of a Linux Desktop"><meta itemprop=description content="I have the privilege of working full remote. To stay connected with our other remote workers and the main office we keep a live video conference going all the time. It’s pretty convenient and definitely allows me to continue to feel connected with the company.
During one of our stand ups, a coworker mentioned that they’d like to see how things looked over time. I have three 1440p monitors and largely leave the video conference on my right most window, which makes recording (an audio free) timelapse pretty easy with FFmpeg."><meta itemprop=datePublished content="2018-06-08T16:37:39-06:00"><meta itemprop=dateModified content="2018-06-08T16:37:39-06:00"><meta itemprop=wordCount content="481"><meta itemprop=keywords content="Linux,Tips"><meta name=twitter:card content="summary"><meta name=twitter:title content="Timelapse of a Linux Desktop"><meta name=twitter:description content="I have the privilege of working full remote. To stay connected with our other remote workers and the main office we keep a live video conference going all the time. It’s pretty convenient and definitely allows me to continue to feel connected with the company.
During one of our stand ups, a coworker mentioned that they’d like to see how things looked over time. I have three 1440p monitors and largely leave the video conference on my right most window, which makes recording (an audio free) timelapse pretty easy with FFmpeg."><meta property="article:published_time" content="2018-06-08 16:37:39 -0600 -0600"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>./Sam_Stelfox.sh</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/blog/>Posts</a></li><li><a href=/notes/>Notes</a></li><li><a href=/about/>About Me</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://stelfox.net/blog/2018/06/time-lapse-of-a-linux-desktop/>Timelapse of a Linux Desktop</a></h2><div class=post-content><p>I have the privilege of working full remote. To stay connected with our other remote workers and the main office we keep a live video conference going all the time. It&rsquo;s pretty convenient and definitely allows me to continue to feel connected with the company.</p><p>During one of our stand ups, a coworker mentioned that they&rsquo;d like to see how things looked over time. I have three 1440p monitors and largely leave the video conference on my right most window, which makes recording (an audio free) timelapse pretty easy with FFmpeg.</p><p>There are a couple of stack overflow posts about this but I wanted to use VP9 (really I wanted to use AV1, but it isn&rsquo;t well supported yet). This adds a bit of a trick as VP9 wants to analyze a bit of the video and will break if there aren&rsquo;t enough frames so some additional options are needed to get it to work.</p><p>These are the settings that worked well for me:</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-ae2c9dd-1><a style=outline:none;text-decoration:none;color:inherit href=#code-ae2c9dd-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-ae2c9dd-2><a style=outline:none;text-decoration:none;color:inherit href=#code-ae2c9dd-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-ae2c9dd-3><a style=outline:none;text-decoration:none;color:inherit href=#code-ae2c9dd-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-ae2c9dd-4><a style=outline:none;text-decoration:none;color:inherit href=#code-ae2c9dd-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679" id=code-ae2c9dd-5><a style=outline:none;text-decoration:none;color:inherit href=#code-ae2c9dd-5>5</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8b949e>$</span> ffmpeg -f x11grab -framerate <span style=color:#a5d6ff>1</span> <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span><span style=color:#8b949e>  -thread_queue_size 2048 -probesize 10M -analyzeduration 10M \
</span></span></span><span style=display:flex><span><span style=color:#8b949e>  -s 2560,1440 -i :1.0+5120,0 \
</span></span></span><span style=display:flex><span><span style=color:#8b949e>  -vf settb=\(1/30\),setpts=N/TB/30 -r 30 \
</span></span></span><span style=display:flex><span><span style=color:#8b949e>  -s 1280,720 -vcodec vp9 -crf 24 video_conference_$(date +%Y-%m-%d).mkv
</span></span></span></code></pre></td></tr></table></div></div><p>I organized the parameters so they could easily be explained on a line by line basis. The first line captures the X11 render output (sorry wayland users, you&rsquo;ll have to look elsewhere) with a framerate of 1/second.</p><p>The second line holds the parameters that tune the analyze phase for the low bandwidth and low framerate, these values are byte size not duration (10M is 10Mb not 10 minutes).</p><p>That third line will likely need to be customized to your display setup. I wanted to capture the size of one of my monitors (-s 2560x1440) which is pretty straight forward. Unusually, my X display is &lsquo;:1&rsquo; (visible by printing the $DISPLAY environment variable) instead of the normal &lsquo;:0&rsquo;. Finally, x11grab treats multi-monitor displays as one buffer, so to get my right most monitor I have to add an X offset of the combined widths of my other two monitors (that&rsquo;s the 5120,0).</p><p>This fourth line is kind of black magic, but ultimately it&rsquo;s adding some metadata to the stream saying that the output will be 30fps, and don&rsquo;t complain that the original framerate was 1fps.</p><p>The last line controls the output, I wanted to resize the video down to 720p with a reasonable encode quality, using the VP9 codec I mentioned before, and storing it with a date stamped file name.</p><p>When your done recording just Ctrl-C out of it (and give it a few seconds, it may seem like it hung while writing out the data).</p><p>If I was going to make a recommendation, you may want to speed this up to 60fps instead of 30 as a full workday will be a tediously long 8 minute video to watch.</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://stelfox.net/tags/linux/>linux</a></span>
<span class=tag><a href=https://stelfox.net/tags/tips/>tips</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"/><line x1="1.05" y1="12" x2="7" y2="12"/><line x1="17.01" y1="12" x2="22.96" y2="12"/></svg><a href=711e08f5c5f992fdbfe31175065122093c0ad81b target=_blank rel=noopener>711e08f5</a> @ 2024-07-14</p></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.85fad2de4f13fec3bcb3b3cb10430cdb44a7b4a9749b32938241a5c6e77718df7624f1002b880521fdc26e24ec1077fda214bf1cb36ee3045510760d09638cae.js integrity="sha512-hfrS3k8T/sO8s7PLEEMM20SntKl0mzKTgkGlxud3GN92JPEAK4gFIf3CbiTsEHf9ohS/HLNu4wRVEHYNCWOMrg=="></script></body></html>