<!DOCTYPE html>
<html lang='en'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='I have the privilege of working full remote. To stay connected with our other remote workers and the main office we keep a live video conference going all the time. It&#39;s pretty convenient and definitely allows me to continue to feel connected with the company.
During one of our stand ups, a coworker mentioned that they&#39;d like to see how things looked over time. I have three 1440p monitors and largely leave the video conference on my right most window, which makes recording (an audio free) timelapse pretty easy with FFmpeg.'>
<meta name='theme-color' content='#ffcd00'>

<meta property='og:title' content='Timelapse of a Linux Desktop • Sam Stelfox&#39;s Thoughts &amp; Notes'>
<meta property='og:description' content='I have the privilege of working full remote. To stay connected with our other remote workers and the main office we keep a live video conference going all the time. It&#39;s pretty convenient and definitely allows me to continue to feel connected with the company.
During one of our stand ups, a coworker mentioned that they&#39;d like to see how things looked over time. I have three 1440p monitors and largely leave the video conference on my right most window, which makes recording (an audio free) timelapse pretty easy with FFmpeg.'>
<meta property='og:url' content='https://stelfox.net/blog/2018/06/timelapse-of-a-linux-desktop/'>
<meta property='og:site_name' content='Sam Stelfox&#39;s Thoughts &amp; Notes'>
<meta property='og:type' content='article'><meta property='article:section' content='blog'><meta property='article:tag' content='linux'><meta property='article:tag' content='tips'><meta property='article:published_time' content='2018-06-08T16:37:39-06:00'/><meta property='article:modified_time' content='2018-06-08T16:37:39-06:00'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.61.0-DEV" />

  <title>Timelapse of a Linux Desktop • Sam Stelfox&#39;s Thoughts &amp; Notes</title>
  <link rel='canonical' href='https://stelfox.net/blog/2018/06/timelapse-of-a-linux-desktop/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.6a060eb7.css'><style>
:root{--color-accent:#ffcd00;}
</style>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-32188490-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  

</head>
<body class='page type-blog'>

  <div class='site'><a class='screen-reader-text' href='#content'>Skip to Content</a><div class='main'><nav id='main-menu' class='menu main-menu' aria-label='Main Menu'>
  <div class='container'>
    
    <ul><li class='item'>
        <a href='/'>Home</a>
      </li><li class='item'>
        <a href='/about/'>About</a>
      </li><li class='item'>
        <a href='/blog/'>Blog Posts</a>
      </li><li class='item'>
        <a href='/notes/'>Various Notes</a>
      </li></ul>
  </div>
</nav><div class='header-widgets'>
        <div class='container'></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>Sam Stelfox&#39;s Thoughts &amp; Notes</p><p class='desc site-desc'>Thoughts from a software engineer, systems architect and Linux gubernāre.</p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Timelapse of a Linux Desktop</h1>
      

    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2018-06-08T16:37:39-06:00'>2018, Jun 08</time>
</span>

  
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
3 mins read
</span>


</div>


  </div>
</header>

  
  

  <div class='container entry-content'>
  <p>I have the privilege of working full remote. To stay connected with our other
remote workers and the main office we keep a live video conference going all
the time. It's pretty convenient and definitely allows me to continue to feel
connected with the company.</p>
<p>During one of our stand ups, a coworker mentioned that they'd like to see how
things looked over time. I have three 1440p monitors and largely leave the
video conference on my right most window, which makes recording (an audio free)
timelapse pretty easy with FFmpeg.</p>
<p>There are a couple of stack overflow posts about this but I wanted to use VP9
(really I wanted to use AV1, but it isn't well supported yet). This adds a bit
of a trick as VP9 wants to analyze a bit of the video and will break if there
aren't enough frames so some additional options are needed to get it to work.</p>
<p>These are the settings that worked well for me:</p>
<pre><code>ffmpeg -f x11grab -framerate 1 \
  -thread_queue_size 2048 -probesize 10M -analyzeduration 10M \
  -s 2560,1440 -i :1.0+5120,0 \
  -vf settb=\(1/30\),setpts=N/TB/30 -r 30 \
  -s 1280,720 -vcodec vp9 -crf 24 video_conference_$(date +%Y-%m-%d).mkv
</code></pre><p>I organized the parameters so they could easily be explained on a line by line
basis. The first line captures the X11 render output (sorry wayland users,
you'll have to look elsewhere) with a framerate of 1/second.</p>
<p>The second line holds the parameters that tune the analyze phase for the low
bandwidth and low framerate, these values are byte size not duration (10M is
10Mb not 10 minutes).</p>
<p>That third line will likely need to be customized to your display setup. I
wanted to capture the size of one of my monitors (-s 2560x1440) which is pretty
straight forward. Unusually, my X display is &lsquo;:1&rsquo; (visible by printing the
$DISPLAY environment variable) instead of the normal &lsquo;:0&rsquo;. Finally, x11grab
treats multi-monitor displays as one buffer, so to get my right most monitor I
have to add an X offset of the combined widths of my other two monitors (that's
the 5120,0).</p>
<p>This fourth line is kind of black magic, but ultimately it's adding some
metadata to the stream saying that the output will be 30fps, and don't complain
that the original framerate was 1fps.</p>
<p>The last line controls the output, I wanted to resize the video down to 720p
with a reasonable encode quality, using the VP9 codec I mentioned before, and
storing it with a date stamped file name.</p>
<p>When your done recording just Ctrl-C out of it (and give it a few seconds, it
may seem like it hung while writing out the data).</p>
<p>If I was going to make a recommendation, you may want to speed this up to 60fps
instead of 30 as a full workday will be a tediously long 8 minute video to
watch.</p>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='tags'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
<span class='screen-reader-text'>Tags: </span><a class='tag' href='/tags/linux/'>linux</a>, <a class='tag' href='/tags/tips/'>tips</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/blog/2018/05/parsing-http-responses-in-ruby/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>Parsing HTTP Responses in Ruby</a>
    </div><div class='next-entry sep-before'>
      <a href='/blog/2018/06/spf-and-google-site-verification-in-route-53/'>
        <span class='screen-reader-text'>Next post: </span>SPF and Google Site Verification in Route 53<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>




      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><div class='copyright'>
  <p> &copy; 2011-2019 Sam Stelfox </p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__assets_js_src="/assets/js/"</script>

<script src='/assets/js/main.67d669ac.js'></script>

</body>

</html>

