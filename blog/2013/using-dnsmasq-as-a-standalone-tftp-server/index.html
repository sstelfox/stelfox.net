<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, viewport-fit=cover">

    <title>Sam Stelfox&#x27;s Thoughts &amp; Notes</title>
    <link rel="stylesheet" href="https://stelfox.net/colors-dark.css">

    

    
    
  </head>
  <body>
    <header id="header">
      <h1><a href="https:&#x2F;&#x2F;stelfox.net">Sam Stelfox&#x27;s Thoughts &amp; Notes</a></h1>
      <p>Thought&#x27;s from a software engineer, systems architect, and Linux gubernƒÅre.</p>
    </header>
    <div id="page">
      <div id="sidebar">
        
          
          <nav>
            <ul class="nav">
              
                
                  <li>
                    <a href="&#x2F;"><span>Home</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;about&#x2F;"><span>About</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;blog&#x2F;"><span>Blog</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;projects&#x2F;"><span>Projects</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;notes&#x2F;"><span>Various Notes</span></a>
                  </li>
                
              
            </ul>
          </nav>
          
        
      </div>
      <div id="content">
        
<article class="post">
  <h1><a href="https:&#x2F;&#x2F;stelfox.net&#x2F;blog&#x2F;2013&#x2F;using-dnsmasq-as-a-standalone-tftp-server&#x2F;">Using Dnsmasq as a Standalone TFTP Server</a></h1>

  <div class="post-content"><p><em>If you've come across this blog post with the intention of setting up TFTP on
an modern version of OpenWRT I have a <a href="https://stelfox.net/blog/2014/using-openwrts-dnsmasq-as-a-tftp-server/">more recent blog post</a> detailing how
too configure your system.</em></p>
<p>I found myself in need of a TFTP server but wanted to avoid having all of the
xinet.d packages and services on my system (even if they were disabled). While
looking for alternatives I found out that <code>dnsmasq</code> has a built-in read-only
TFTP server.</p>
<span id="continue-reading"></span>
<p>I already have a DNS and DHCP server on my network and didn't want dnsmasq to
take on either of those roles so my first challenge was finding a way to
prevent dnsmasq from running those bits of it's code, or failing that I would
just firewall off the service. Luckily it's quite easy to disable both bits of
functionality.</p>
<p>For DHCP you simply have to leave out any of the dhcp option in the
configuration file, DNS you just tell it to operate on port 0 and it will be
disabled.</p>
<p>So my whole configuration starting out looks like this:</p>
<pre><code># Disable DNS
port=0
</code></pre>
<p>Now I need to configure the TFTP bits of dnsmasq. This too was rather simple
only requiring me to add the following to my already terse configuration file:</p>
<pre><code># Enable the TFTP server
enable-tftp
tftp-root=/var/lib/tftp
</code></pre>
<p>I created the root directory for my TFTP server and started it up with the
following commands:</p>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">mkdir /var/lib/tftp
systemctl enable dnsmasq.service
systemctl start dnsmasq.service
</code></pre>
<p>Voila, TFTP running and happy. If you have a firewall running you'll also want
to open ports <code>69/tcp</code> and <code>69/udp</code> (though I suspect only the UDP one is
needed).</p>
</div><p class="meta">Posted on <span class="postdate">2013-12-12</span></p></article>

      </div>
      <footer id="footer">
        <p class="copyright">
          
          &copy; 2011 &ndash; 2021 Sam Stelfox | <a href="https://stelfox.net/licenses/">Site Content Licenses</a>
          
        </p>
      </footer>
    </div>
  </body>
</html>
