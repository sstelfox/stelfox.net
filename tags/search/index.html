<!DOCTYPE html>
<html lang='en_US'>
  <head>
    <title>Search - Stelfox Athen&#xe6;um</title>

    <meta http-equiv='content-type' content='text/html; charset=utf-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1' />
    
    

    <link rel="alternate" type="application/atom+xml" title="Stelfox Athen&#xe6;um Feed" href="/atom.xml" />
    <link rel="canonical" href="https://stelfox.net" />
    <link rel="author" href="https://plus.google.com/+SamStelfox31337/"/>

    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Search" />
    <meta property="og:url" content="https://stelfox.net/tags/search/" />
    <meta property="og:site_name" content="Stelfox Athen&#xe6;um" />
    <meta property="article:publisher" content="https://www.facebook.com/sstelfox" />
    <meta property="og:image" content="https://stelfox.net/static/avatar-01.jpg" />

    <link rel='stylesheet' href="//fonts.googleapis.com/css?family=Open+Sans:300,400italic,400,600,700|Alegreya+SC:700" />
    <link rel="stylesheet" href="https://stelfox.net/css/3HrCRVwL3Gos2V4HzXAw/Om/nxs=.css" />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-32188490-1', 'stelfox.net');
      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <header class='masthead'>
      <div class='masthead-inner'>
        <h1><a href='/' title='Home'>Sam Stelfox</a></h1>
        <p class='lead'>Thoughts from a systems hacker and developer.</p>
        <nav>
          <ul>
            <li><a href="/about/" title="About">About</a></li>
            <li><a href="/blog/" title="Blog">Blog</a></li>
            <li><a href="/knowledge_base/" title="Knowledge Base">Knowledge Base</a></li>
            <li><form action="/search/" method="get"><input type="search" name="q" placeholder="Search" /></form></li>
          </ul>
        </nav>
        <footer class='colophon'>
          <p>&copy; 2014, All rights reserved.</p>
        </footer>
      </div>
    </header>
    <div class='content container'>
      <div class="post">
  <h1>Search</h1>
  
    <div class='post'>
      <h2><a href="/blog/2014/05/extracting-content-from-markdown/">Extracting Content From Markdown</a></h1>
      <aside>Posted at: 2014-05-30 18:34:29 -0400</aside>
      <article>
        <p>Recently I&#39;ve been playing around with building a pure javascript full text
search engine for static content sites like this one. One of the challenges
with doing this has been working around the Markdown markup embedded in the
written content.</p>

<p>Most of the markdown syntax can be stripped out simply by removing all
non-alphanumeric characters from the document and move on. This doesn&#39;t solve
one of the bigger challenges I&#39;ve experienced... code blocks. Code blocks have
plenty of regular english-ish words and can easily skew keyword detection
within it.</p>

<p>I didn&#39;t want to write my own Markdown parser, so I started with the one
already in use by this site&#39;s renderer (<a href="https://github.com/vmg/redcarpet">redcarpet</a>). Another Github user,
<a href="https://github.com/toupeira">Markus Koller or toupeira on Github</a> provided <a href="https://github.com/vmg/redcarpet/issues/79">the basis</a> for the code
that became the redcarpet &quot;StripDown&quot; formatter, which was designed to
essentially render a Markdown document without the markup.</p>

<p>It does almost exactly what I want, except it still outputs raw code inside the
content. The following code sample includes a modified version that excludes
any code blocks. My content is also formatted inside the markdown documents to
never be longer than 80 lines, this also turns individual paragraphs and list
items into individual lines for paragraph detection.</p>
<div class="CodeRay">
  <div class="code"><pre>require <span class="string"><span class="delimiter">'</span><span class="content">redcarpet</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">redcarpet/render_strip</span><span class="delimiter">'</span></span>

<span class="keyword">class</span> <span class="class">ContentRenderer</span> &lt; <span class="constant">Redcarpet</span>::<span class="constant">Render</span>::<span class="constant">StripDown</span>
  <span class="keyword">def</span> <span class="function">block_code</span>(*args)
    <span class="predefined-constant">nil</span>
  <span class="keyword">end</span>

  <span class="keyword">def</span> <span class="function">list_item</span>(content, list_type)
    content.gsub(<span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>) + <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>
  <span class="keyword">end</span>

  <span class="keyword">def</span> <span class="function">paragraph</span>(text)
    text.gsub(<span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>) + <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

markdown = <span class="constant">Redcarpet</span>::<span class="constant">Markdown</span>.new(<span class="constant">ContentRenderer</span>, <span class="key">fenced_code_blocks</span>: <span class="predefined-constant">true</span>)
puts markdown.render(<span class="constant">File</span>.read(<span class="string"><span class="delimiter">'</span><span class="content">sample_markdown_article.md</span><span class="delimiter">'</span></span>))
</pre></div>
</div>

<p>The above code will print out just the content of the markdown formatted file
&#39;sample_markdown_article.md&#39;.</p>

      </article>
    </div>
  
</div>

    </div>
  </body>
</html>
