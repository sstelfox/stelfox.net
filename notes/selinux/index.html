<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, viewport-fit=cover">

    <title>Sam Stelfox&#x27;s Thoughts &amp; Notes</title>
    <link rel="stylesheet" href="https://stelfox.net/colors-dark.css">

    

    
    
  </head>
  <body>
    <header id="header">
      <h1><a href="https:&#x2F;&#x2F;stelfox.net">Sam Stelfox&#x27;s Thoughts &amp; Notes</a></h1>
      <p>Thought&#x27;s from a software engineer, systems architect, and Linux gubernƒÅre.</p>
    </header>
    <div id="page">
      <div id="sidebar">
        
          
          <nav>
            <ul class="nav">
              
                
                  <li>
                    <a href="&#x2F;"><span>Home</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;about&#x2F;"><span>About</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;blog&#x2F;"><span>Blog</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;projects&#x2F;"><span>Projects</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;notes&#x2F;"><span>Various Notes</span></a>
                  </li>
                
              
            </ul>
          </nav>
          
        
      </div>
      <div id="content">
        
<article class="post">
  <h1>SELinux</h1><p class="meta">Posted on <span class="postdate">2016-09-13</span></p><div class="post-content"><h2 id="current-status">Current Status</h2>
<p>Very useful information:</p>
<pre><code># sestatus
SELinux status:                 enabled
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             strict
Current mode:                   enforcing
Mode from config file:          enforcing
Policy MLS status:              disabled
Policy deny_unknown status:     denied
Memory protection checking:     actual (secure)
Max kernel policy version:      30
</code></pre>
<h2 id="toggling-enforcement">Toggling Enforcement</h2>
<pre><code># getenforce
Enforcing
# setenforce 0
# getenforce
Permissive
# setenforce 1
# getenforce
Enforcing
</code></pre>
<p>I believe the ability to disable SELinux at runtime can be completedly
disabled. The relevant options are <code>CONFIG_SECURITY_SELINUX_DISABLE</code>,
<code>CONFIG_SECURITY_SELINUX_DEVELOP</code>, and <code>CONFIG_SECURITY_SELINUX_BOOTPARAM</code>. I
need to research this more to figure out the extent of restrictions that can be
applied (as well as through the SELinux policy itself).</p>
<h2 id="users-and-logins">Users and Logins</h2>
<p>Viewing your current assigned context:</p>
<pre><code>id -Z
</code></pre>
<p>Users to role mapping in the strict gentoo selinux policy:</p>
<ul>
<li><code>unconfined_u</code> -&gt; <code>unconfined_r</code></li>
<li><code>user_u</code> -&gt; <code>user_r</code></li>
<li><code>staff_u</code> -&gt; <code>staff_r,sysadm_r -&gt; newrole_t,semanage_t</code></li>
<li><code>sysadm_u</code> -&gt; <code>sysadm_r -&gt; newrole_t,semanage_t</code></li>
<li><code>system_u</code> -&gt; <code>system_r</code></li>
</ul>
<h2 id="quick-command-reference">Quick Command Reference</h2>
<ul>
<li>View selinux login mappings: <code>semanage login -l</code></li>
<li>Create a new mapping: <code>semanage login -a -s staff_u sstelfox</code></li>
<li>Modify existing mapping: <code>semanage login -m -s user_r sstelfox</code></li>
<li>When mappings have changed be sure to update that user's home directory: <code>restorecon -RF /home/sstelfox</code></li>
<li>Deleting a mapping: <code>semanage login -d sstelfox</code></li>
<li>View selinux users: <code>semanage user -l</code></li>
<li>Add a new user: <code>semanage user -a -R &quot;staff_r dbadm_r&quot; dbadm_u</code></li>
<li>Modifying: <code>semanage user -m -R &quot;dbadm_r&quot; dbadm_u</code></li>
<li>Removing: <code>semanage user -d dbadm_u</code></li>
</ul>
</div>
</article>

      </div>
      <footer id="footer">
        <p class="copyright">
          
          &copy; 2011 &ndash; 2021 Sam Stelfox | <a href="https://stelfox.net/licenses/">Site Content Licenses</a>
          
        </p>
      </footer>
    </div>
  </body>
</html>
