<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, viewport-fit=cover">

    <title>Sam Stelfox&#x27;s Thoughts &amp; Notes</title>
    <link rel="stylesheet" href="https://stelfox.net/colors-dark.css">

    

    
    
  </head>
  <body>
    <header id="header">
      <h1><a href="https:&#x2F;&#x2F;stelfox.net">Sam Stelfox&#x27;s Thoughts &amp; Notes</a></h1>
      <p>Thought&#x27;s from a software engineer, systems architect, and Linux gubernƒÅre.</p>
    </header>
    <div id="page">
      <div id="sidebar">
        
          
          <nav>
            <ul class="nav">
              
                
                  <li>
                    <a href="&#x2F;"><span>Home</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;about&#x2F;"><span>About</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;blog&#x2F;"><span>Blog</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;projects&#x2F;"><span>Projects</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;notes&#x2F;"><span>Various Notes</span></a>
                  </li>
                
              
            </ul>
          </nav>
          
        
      </div>
      <div id="content">
        
<article class="post">
  <h1>Ruby</h1><div class="post-content"><h2 id="rvm">RVM</h2>
<p>If using Gnome terminal, you have to set the 'Run command as login shell' check
box on the Title and Command tab inside of gnome-terminal's Settings page to
run the bashrc file upon opening the terminal. If you don't do this you'll
receive &quot;RVM is not a function&quot; error message.</p>
<p>Install all the packages needed to compile ruby...</p>
<pre><code>yum install gcc-c++ patch readline readline-devel zlib zlib-devel \
  libyaml-devel libffi-devel openssl-devel make bzip2 autoconf automake \
  libtool bison libxml2 libxml2-devel sqlite sqlite-devel libxslt \
  libxslt-devel -y
</code></pre>
<p>Install RVM...</p>
<pre><code>curl https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer | bash -s stable
</code></pre>
<pre><code>rvm install ruby-1.9.3
rvm use 1.9.3 --default
</code></pre>
<p>Create a global gemset:</p>
<pre><code>rvm gemset create global
rvm gemset use global
</code></pre>
<p>And install a few gems useful globally:</p>
<pre><code>gem install bundler pry
</code></pre>
<p>To make sure these get installed automatically for any other ruby versions that
get installed you can use some nifty information pulled from <a href="https://rvm.io/gemsets/initial/">RVM's
Documentation</a>.</p>
<pre><code>echo -e "bundler\npry" > ~/.rvm/gemsets/global.gems
</code></pre>
<h3 id="ruby-optimization">Ruby Optimization</h3>
<p>By default RVM compiles ruby with no optimization flags. The flags will
increase the time it takes to compile a specific instance of Ruby, however, it
will also save running time with every execution of the code. For me this is a
very useful trade off as I run various Ruby commands hundreds of times a day
when I'm working on various programs. You can add the compilization flags by
creating an &quot;.rvmrc&quot; file in the root of your home directory and include the
following:</p>
<pre><code>rvm_configure_env=(CFLAGS="-march=native -O2 -pipe")
</code></pre>
<p>These are &quot;safe&quot; optimization flags and will make optimizations automatically
based on the processor of the system that compiled it. This has the downside of
making the binaries non-portable (as in you can only move the compiled binaries
to systems with the same or newer processors).</p>
<p>As an additional level of optimizations rather than using the stock Ruby binary
you can use the &quot;turbo&quot; branch with the falcon patch which has decreased rails
load time by half or more. You install this version like so:</p>
<pre><code>rvm install 1.9.3-turbo --patch falcon
</code></pre>
<p>If you encounter any errors about CFlags or compilation errors your RVM is
probably out of date and needs to be updated. On one machine I received the
following error:</p>
<pre><code>Error running 'CFLAGS=-march=native -O2 ./configure
--prefix=/home/user/.rvm/rubies/ruby-1.9.3-p194-turbo --enable-shared
--disable-install-doc --with-libyaml --with-opt-dir=/home/user/.rvm/usr ',
please read /home/user/.rvm/log/ruby-1.9.3-p194-turbo/configure.logThere has
been an error while running configure. Halting the installation.
</code></pre>
<p>Which was quickly solved by running the following command and trying again:</p>
<pre><code>rvm get stable
</code></pre>
<p>I did also encounter an error when that ran for me, but it fixed the issue and
I suspect the error was unrelated.</p>
<h2 id="rbenv">RBEnv</h2>
<ul>
<li><a href="https://hmarr.com/2012/nov/08/rubies-and-bundles/">Rubies and Bundles</a></li>
</ul>
</div>
</article>

      </div>
      <footer id="footer">
        <p class="copyright">
          
          &copy; 2011 &ndash; 2021 Sam Stelfox | <a href="https://stelfox.net/licenses/">Site Content Licenses</a>
          
        </p>
      </footer>
    </div>
  </body>
</html>
