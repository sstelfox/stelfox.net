<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="Note: This page is quite old and is likely out of date. My opinions may have also changed dramatically since this was written. It is here as a reference until I get around to updating it.
This is a mostly (95%) script-less installation and setup of OpenStack from scratch on a single host, though done in a way that the services could each be very easily broken out on to their own machines or multiple machines."><meta name=keywords content><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://stelfox.net/notes/openstack/><title>Openstack :: Sam Stelfox
</title><link rel=stylesheet href=/main.949191c1dcc9c4a887997048b240354e47152016d821198f89448496ba42e491.css integrity="sha256-lJGRwdzJxKiHmXBIskA1TkcVIBbYIRmPiUSElrpC5JE="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Openstack"><meta itemprop=description content="Note: This page is quite old and is likely out of date. My opinions may have also changed dramatically since this was written. It is here as a reference until I get around to updating it.
This is a mostly (95%) script-less installation and setup of OpenStack from scratch on a single host, though done in a way that the services could each be very easily broken out on to their own machines or multiple machines."><meta itemprop=wordCount content="487"><meta name=twitter:card content="summary"><meta name=twitter:title content="Openstack"><meta name=twitter:description content="Note: This page is quite old and is likely out of date. My opinions may have also changed dramatically since this was written. It is here as a reference until I get around to updating it.
This is a mostly (95%) script-less installation and setup of OpenStack from scratch on a single host, though done in a way that the services could each be very easily broken out on to their own machines or multiple machines."></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>./Sam_Stelfox.sh</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about/>About</a></li><li><a href=/blog/>Blog Posts</a></li><li><a href=/notes/>Various Notes</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://stelfox.net/notes/openstack/>Openstack</a></h2><div class=post-content><p><em><strong>Note: This page is quite old and is likely out of date. My opinions may have
also changed dramatically since this was written. It is here as a reference
until I get around to updating it.</strong></em></p><p>This is a mostly (95%) script-less installation and setup of OpenStack from
scratch on a single host, though done in a way that the services could each be
very easily broken out on to their own machines or multiple machines.</p><p>A few references that I&rsquo;ve used generally for assistance figuring out what I
need:</p><ul><li><a href=http://fedoraproject.org/wiki/Getting_started_with_OpenStack_on_Fedora_17>http://fedoraproject.org/wiki/Getting_started_with_OpenStack_on_Fedora_17</a></li><li><a href=http://wiki.openstack.org/QpidSupport>http://wiki.openstack.org/QpidSupport</a></li><li><a href=https://github.com/mseknibilel/OpenStack-Folsom-Install-guide/blob/master/OpenStack_Folsom_Install_Guide_WebVersion.rst>https://github.com/mseknibilel/OpenStack-Folsom-Install-guide/blob/master/OpenStack_Folsom_Install_Guide_WebVersion.rst</a></li><li><a href=https://github.com/openstack/keystone/blob/master/etc/keystone.conf.sample>https://github.com/openstack/keystone/blob/master/etc/keystone.conf.sample</a></li><li><a href=http://docs.openstack.org/developer/keystone/configuration.html>http://docs.openstack.org/developer/keystone/configuration.html</a></li></ul><h2 id=installation>Installation</h2><p>This guide and all the other OpenStack sections on this wiki were written using
the pre-packaged version of OpenStack that comes with Fedora (version 2012.1.3
Essex) any other version may have different configuration options, and
different command line flags.</p><p>The various services should be configured in the order of the sections listed
here.</p><h3 id=network-setup>Network Setup</h3><p>For the sake of knowing exactly what is going, what connections are being made
and between what services I&rsquo;ve elected to put every individual service on it&rsquo;s
own IP address. This separation also makes it easy to break individual services
off on to other machines if they become a bottleneck and need a more
distributed setup.</p><p>Since this was initially done on a development machine I also created a bridge
to act as a virtual ethernet adapter that was only available locally named
<code>br-mgmt</code> which also hosts all of the service&rsquo;s. The address range chosen for
this development test was <code>10.100.0.0/24</code> as it generally doesn&rsquo;t interfere
with any networks I normally encounter.</p><p>The main bridge was setup using the following configuration file which was
written to <code>/etc/sysconfig/network-scripts/ifcfg-br-mgmt</code>.</p><pre tabindex=0><code>NM_CONTROLLED=no
ONBOOT=yes
TYPE=Bridge
BOOTPROTO=static

IPADDR=10.100.0.10
NETMASK=255.255.255.0
NETWORK=10.100.0.0
BROADCAST=10.100.0.255

IPV6INIT=yes
IPV6_PRIVACY=rfc3041

NAME=ManagementNet
</code></pre><p>Subsequent IP addresses were added to the bridge by creating files at
<code>/etc/sysconfig/network-scripts/ifcfg-br-mgmt:{id}</code> replacing {id} with 1
through 9 with the following contents:</p><pre tabindex=0><code>DEVICE={Interface Name}
NM_CONTROLLED=no
ONBOOT=yes
BOOTPROTO=static

IPADDR={IP Address}
NETMASK=255.255.255.0

IPV6INIT=yes
IPV6_PRIVACY=rfc3041

NAME={Service}
</code></pre><p>The following table show the address allocations I used, and what I intend the
address be used for:</p><table><thead><tr><th>Interface Name</th><th>IP Address</th><th>Service</th></tr></thead><tbody><tr><td>br-mgmt:1</td><td>10.100.0.11</td><td>MySQLd</td></tr><tr><td>br-mgmt:2</td><td>10.100.0.12</td><td>Qpidd</td></tr><tr><td>br-mgmt:3</td><td>10.100.0.13</td><td>Keystone/Identity</td></tr><tr><td>br-mgmt:4</td><td>10.100.0.14</td><td>Memcached</td></tr><tr><td>br-mgmt:5</td><td>10.100.0.15</td><td>Nova/Compute</td></tr><tr><td>br-mgmt:6</td><td>10.100.0.16</td><td>Cinder/Volume</td></tr><tr><td>br-mgmt:7</td><td>10.100.0.17</td><td>Glance/Image</td></tr><tr><td>br-mgmt:8</td><td>10.100.0.18</td><td>EC2</td></tr><tr><td>br-mgmt:9</td><td>10.100.0.19</td><td>Quantum/Network</td></tr></tbody></table><h3 id=service-pre-requisites>Service Pre-Requisites</h3><p>When configuring the following service be sure to bind them to the address
listed in the table above in the Service/Management network section.</p><ul><li>Install <a href=https://stelfox.net/notes/mysql/>Mysql Server</a></li><li>Install <a href=https://stelfox.net/notes/qpid/>Qpid Message Broker</a></li><li>Install <a href=https://stelfox.net/notes/chronyd/>Chrony NTP Server</a></li><li>Install <a href=https://stelfox.net/notes/memcached/>Memcache</a></li></ul><h3 id=keystoneidentity>Keystone/Identity</h3><p>Keystone is the OpenStack Identity service and it&rsquo;s configuration is documented
on <a href=https://stelfox.net/notes/openstack_keystone/>it&rsquo;s wiki page</a>.</p><h3 id=glanceimage-service>Glance/Image Service</h3><p>Glance is the OpenStack Image service and it&rsquo;s configuration is documented on
<a href=https://stelfox.net/notes/openstack_glance/>it&rsquo;s wiki page</a></p><h3 id=horizondashboard>Horizon/Dashboard</h3><p>Notes for when I get to this:</p><p>I should make use of the Cached Database session backend:</p><ul><li><a href=http://docs.openstack.org/trunk/openstack-compute/install/apt/content/dashboard-session-cached-database.html>http://docs.openstack.org/trunk/openstack-compute/install/apt/content/dashboard-session-cached-database.html</a></li></ul><p>It will need to have memcache configured as if it was going to be the session
storage:</p><ul><li><a href=http://docs.openstack.org/trunk/openstack-compute/install/apt/content/dashboard-session-memcache.html>http://docs.openstack.org/trunk/openstack-compute/install/apt/content/dashboard-session-memcache.html</a></li></ul><p>Additional notes:</p><ul><li><code>http://docs.openstack.org/trunk/openstack-object-storage/admin/content/memcached-considerations.html</code> (Dead link)</li><li><a href=http://www.cybera.ca/tech-radar/using-memcached-openstack-nova>http://www.cybera.ca/tech-radar/using-memcached-openstack-nova</a></li></ul></div></article><hr><div class=post-info></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.85fad2de4f13fec3bcb3b3cb10430cdb44a7b4a9749b32938241a5c6e77718df7624f1002b880521fdc26e24ec1077fda214bf1cb36ee3045510760d09638cae.js integrity="sha512-hfrS3k8T/sO8s7PLEEMM20SntKl0mzKTgkGlxud3GN92JPEAK4gFIf3CbiTsEHf9ohS/HLNu4wRVEHYNCWOMrg=="></script></body></html>