<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="Note: This page is quite old and is likely out of date. My opinions may have also changed dramatically since this was written. It is here as a reference until I get around to updating it.
I came across this python script that accesses GPIO pins in linux. It&amp;rsquo;s potentially very useful so I&amp;rsquo;m including it here, in it&amp;rsquo;s entirety. I can later on reference this for use in my own programs."><meta name=keywords content="blog,programming,linux,systems,personal,rust,philosophy"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://stelfox.net/notes/gpio/><title>GPIO :: Sam Stelfox
</title><link rel=stylesheet href=/main.949191c1dcc9c4a887997048b240354e47152016d821198f89448496ba42e491.css integrity="sha256-lJGRwdzJxKiHmXBIskA1TkcVIBbYIRmPiUSElrpC5JE="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="GPIO"><meta itemprop=description content="Note: This page is quite old and is likely out of date. My opinions may have also changed dramatically since this was written. It is here as a reference until I get around to updating it.
I came across this python script that accesses GPIO pins in linux. It&rsquo;s potentially very useful so I&rsquo;m including it here, in it&rsquo;s entirety. I can later on reference this for use in my own programs."><meta itemprop=wordCount content="646"><meta name=twitter:card content="summary"><meta name=twitter:title content="GPIO"><meta name=twitter:description content="Note: This page is quite old and is likely out of date. My opinions may have also changed dramatically since this was written. It is here as a reference until I get around to updating it.
I came across this python script that accesses GPIO pins in linux. It&rsquo;s potentially very useful so I&rsquo;m including it here, in it&rsquo;s entirety. I can later on reference this for use in my own programs."></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>./Sam_Stelfox.sh</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about/>About</a></li><li><a href=/blog/>Blog Posts</a></li><li><a href=/notes/>Various Notes</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://stelfox.net/notes/gpio/>GPIO</a></h2><div class=post-content><p><em><strong>Note: This page is quite old and is likely out of date. My opinions may have
also changed dramatically since this was written. It is here as a reference
until I get around to updating it.</strong></em></p><p>I came across this python script that accesses GPIO pins in linux. It&rsquo;s
potentially very useful so I&rsquo;m including it here, in it&rsquo;s entirety. I can later
on reference this for use in my own programs.</p><pre tabindex=0><code>&#34;&#34;&#34;Arduino-like library for Python on BeagleBone&#34;&#34;&#34;
import time

HIGH = &#34;HIGH&#34;
LOW = &#34;LOW&#34;
OUTPUT = &#34;OUTPUT&#34;
INPUT = &#34;INPUT&#34;
pinList = [] # needed for unexport()
startTime = time.time() # needed for millis()
digitalPinDef = {
  &#34;P8.3&#34;:   38,
  &#34;P8.4&#34;:   39,
  &#34;P8.5&#34;:   34,
  &#34;P8.6&#34;:   35,
  &#34;P8.11&#34;:  45,
  &#34;P8.12&#34;:  44,
  &#34;P8.14&#34;:  26,
  &#34;P8.15&#34;:  47,
  &#34;P8.16&#34;:  46,
  &#34;P8.17&#34;:  27,
  &#34;P8.18&#34;:  65,
  &#34;P8.20&#34;:  63,
  &#34;P8.21&#34;:  62,
  &#34;P8.22&#34;:  37,
  &#34;P8.23&#34;:  36,
  &#34;P8.24&#34;:  33,
  &#34;P8.25&#34;:  32,
  &#34;P8.26&#34;:  61,
  &#34;P8.27&#34;:  86,
  &#34;P8.28&#34;:  88,
  &#34;P8.29&#34;:  87,
  &#34;P8.30&#34;:  89,
  &#34;P8.39&#34;:  76,
  &#34;P8.40&#34;:  77,
  &#34;P8.41&#34;:  74,
  &#34;P8.42&#34;:  75,
  &#34;P8.43&#34;:  72,
  &#34;P8.44&#34;:  73,
  &#34;P8.45&#34;:  70,
  &#34;P8.46&#34;:  71,
  &#34;P9.12&#34;:  60,
  &#34;P9.15&#34;:  48,
  &#34;P9.23&#34;:  49,
  &#34;P9.25&#34;:  117,
  &#34;P9.27&#34;:  115,
  &#34;P9.42&#34;:  7
}

analogPinDef = {
  &#34;P9.33&#34;:  &#34;ain4&#34;,
  &#34;P9.35&#34;:  &#34;ain6&#34;,
  &#34;P9.36&#34;:  &#34;ain5&#34;,
  &#34;P9.37&#34;:  &#34;ain2&#34;,
  &#34;P9.38&#34;:  &#34;ain3&#34;,
  &#34;P9.39&#34;:  &#34;ain0&#34;,
  &#34;P9.40&#34;:  &#34;ain1&#34;
}

def pinMode(pin, direction):
  &#34;&#34;&#34;pinMode(pin, direction) opens (exports)  a pin for use and 
  sets the direction&#34;&#34;&#34;
  if pin in digitalPinDef:
    fw = file(&#34;/sys/class/gpio/export&#34;, &#34;w&#34;)
    fw.write(&#34;%d&#34; % (digitalPinDef[pin]))
    fw.close()
    fileName = &#34;/sys/class/gpio/gpio%d/direction&#34; % (digitalPinDef[pin])
    fw = file(fileName, &#34;w&#34;)
    if direction == INPUT:
      fw.write(&#34;in&#34;)
    else:
      fw.write(&#34;out&#34;)
    fw.close()
    pinList.append(digitalPinDef[pin])
  else:
    print &#34;pinMode error: Pin &#34; + pin + &#34; is not defined as a digital I/O pin in the pin definition.&#34;


def digitalWrite(pin, status):
  &#34;&#34;&#34;digitalWrite(pin, status) sets a pin HIGH or LOW&#34;&#34;&#34;
  if pin in digitalPinDef:
    fileName = &#34;/sys/class/gpio/gpio%d/value&#34; % (digitalPinDef[pin])
    fw = file(fileName, &#34;w&#34;)
    if status == HIGH:
      fw.write(&#34;1&#34;)
    if status == LOW:
      fw.write(&#34;0&#34;)
    fw.close()
  else:
    print &#34;digitalWrite error: Pin &#34; + pin + &#34; is not defined as a digital I/O pin in the pin definition.&#34;

def digitalRead(pin):
  &#34;&#34;&#34;digitalRead(pin) returns HIGH or LOW for a given pin.&#34;&#34;&#34;
  if pin in digitalPinDef:
    fileName = &#34;/sys/class/gpio/gpio%d/value&#34; % (digitalPinDef[pin])
    fw = file(fileName, &#34;r&#34;)
    inData = fw.read()
    fw.close()
    if inData == &#34;0\n&#34;:
      return LOW
    if inData == &#34;1\n&#34;:
      return HIGH
  else:
    print &#34;digitalRead error: Pin &#34; + pin + &#34; is not defined as a digital I/O pin in the pin definition.&#34;
    return -1;

def analogRead(pin):
  &#34;&#34;&#34;analogRead(pin) returns analog value for a given pin.&#34;&#34;&#34;
  if pin in analogPinDef:
    fileName = &#34;/sys/devices/platform/tsc/&#34; + (analogPinDef[pin])
    fw = file(fileName, &#34;r&#34;)
    return fw.read()
  fw.close()
else:
  print &#34;analogRead error: Pin &#34; + pin + &#34; is not defined as an analog in pin in the pin definition.&#34;
    return -1;

def pinUnexport(pin):
  &#34;&#34;&#34;pinUnexport(pin) closes a pin in sysfs. This is susally 
  called by cleanup() when a script is exiting.&#34;&#34;&#34;
  fw = file(&#34;/sys/class/gpio/unexport&#34;, &#34;w&#34;)
  fw.write(&#34;%d&#34; % (pin))
  fw.close()

def cleanup():
  &#34;&#34;&#34; takes care of stepping through pins that were set with
  pinMode and unExports them. Prints result&#34;&#34;&#34;
  def find_key(dic, val):
    return [k for k, v in dic.iteritems() if v == val][0]
  print &#34;&#34;
  print &#34;Cleaning up. Unexporting the following pins:&#34;,
  for pin in pinList:
    pinUnexport(pin)
    print find_key(digitalPinDef, pin),

def delay(millis):
  &#34;&#34;&#34;delay(millis) sleeps the script for a given number of 
  milliseconds&#34;&#34;&#34;
  time.sleep(millis/1000.0)

def millis():
  &#34;&#34;&#34;millis() returns an int for the number of milliseconds since 
  the script started.&#34;&#34;&#34;
  return int((time.time() - startTime) * 1000)

def run(setup, main): # from PyBBIO by Alexander Hiam - ahiam@marlboro.edu - www.alexanderhiam.com https://github.com/alexanderhiam/PyBBIO
  &#34;&#34;&#34; The main loop; must be passed a setup and a main function.
  First the setup function will be called once, then the main
  function wil be continuously until a stop signal is raised, 
  e.g. CTRL-C or a call to the stop() function from within the
  main function. &#34;&#34;&#34;
  try:
    setup()
    while (True):
      main()
  except KeyboardInterrupt:
    # Manual exit signal, clean up and exit happy
    cleanup()
  except Exception, e:
    # Something may have gone wrong, clean up and print exception
    cleanup()
    print e
</code></pre></div></article><hr><div class=post-info></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.85fad2de4f13fec3bcb3b3cb10430cdb44a7b4a9749b32938241a5c6e77718df7624f1002b880521fdc26e24ec1077fda214bf1cb36ee3045510760d09638cae.js integrity="sha512-hfrS3k8T/sO8s7PLEEMM20SntKl0mzKTgkGlxud3GN92JPEAK4gFIf3CbiTsEHf9ohS/HLNu4wRVEHYNCWOMrg=="></script></body></html>