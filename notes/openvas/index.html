<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="sam@stelfox.net Sam Stelfox ">
<meta name="description" content="Note: This page is quite old and is likely out of date. My opinions may have also changed dramatically since this was written. It is here as a reference until I get around to updating it.
Setup Install the packages nikto, openvas-scanner, openvas-manager, and openvas-client.
Scanner As root run openvas-mkcert like the following:
[root@localhost ~]# openvas-mkcert ------------------------------------------------------------------------------- Creation of the OpenVAS SSL Certificate ------------------------------------------------------------------------------- This script will now ask you the relevant information to create the SSL certificate of OpenVAS." />
<meta name="keywords" content="blog, programming, linux, systems, personal" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://stelfox.net/notes/openvas/" />


    <title>
        
            OpenVAS :: Sam Stelfox 
        
    </title>




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" integrity="sha512-Cv93isQdFwaKBV+Z4X8kaVBYWHST58Xb/jVOcV9aRsGSArZsgAnFIhMpDoMDcFNoUtday1hdjn0nGp3+KZyyFw==" crossorigin="anonymous" referrerpolicy="no-referrer" />



<link rel="stylesheet" href="/main.2a064c455b0ecbd6b1481b3bf9df2441e95838691022f40a5338c2cb1244f075.css" integrity="sha256-KgZMRVsOy9axSBs7&#43;d8kQelYOGkQIvQKUzjCyxJE8HU=">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="OpenVAS">
<meta itemprop="description" content="Note: This page is quite old and is likely out of date. My opinions may have also changed dramatically since this was written. It is here as a reference until I get around to updating it.
Setup Install the packages nikto, openvas-scanner, openvas-manager, and openvas-client.
Scanner As root run openvas-mkcert like the following:
[root@localhost ~]# openvas-mkcert ------------------------------------------------------------------------------- Creation of the OpenVAS SSL Certificate ------------------------------------------------------------------------------- This script will now ask you the relevant information to create the SSL certificate of OpenVAS.">

<meta itemprop="wordCount" content="6233">
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="OpenVAS"/>
<meta name="twitter:description" content="Note: This page is quite old and is likely out of date. My opinions may have also changed dramatically since this was written. It is here as a reference until I get around to updating it.
Setup Install the packages nikto, openvas-scanner, openvas-manager, and openvas-client.
Scanner As root run openvas-mkcert like the following:
[root@localhost ~]# openvas-mkcert ------------------------------------------------------------------------------- Creation of the OpenVAS SSL Certificate ------------------------------------------------------------------------------- This script will now ask you the relevant information to create the SSL certificate of OpenVAS."/>



    <meta property="og:title" content="OpenVAS" />
<meta property="og:description" content="Note: This page is quite old and is likely out of date. My opinions may have also changed dramatically since this was written. It is here as a reference until I get around to updating it.
Setup Install the packages nikto, openvas-scanner, openvas-manager, and openvas-client.
Scanner As root run openvas-mkcert like the following:
[root@localhost ~]# openvas-mkcert ------------------------------------------------------------------------------- Creation of the OpenVAS SSL Certificate ------------------------------------------------------------------------------- This script will now ask you the relevant information to create the SSL certificate of OpenVAS." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://stelfox.net/notes/openvas/" /><meta property="article:section" content="notes" />

















    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                ./Sam_Stelfox.sh</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/">Home</a></li><li><a href="/about/">About</a></li><li><a href="/blog/">Blog Posts</a></li><li><a href="/notes/">Various Notes</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://stelfox.net/notes/openvas/">OpenVAS</a></h2>

            
            
            

            <div class="post-content">
                <p><em><strong>Note: This page is quite old and is likely out of date. My opinions may have
also changed dramatically since this was written. It is here as a reference
until I get around to updating it.</strong></em></p>
<h2 id="setup">Setup</h2>
<p>Install the packages <code>nikto</code>, <code>openvas-scanner</code>, <code>openvas-manager</code>, and
<code>openvas-client</code>.</p>
<h2 id="scanner">Scanner</h2>
<p>As root run openvas-mkcert like the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[root@localhost ~]# openvas-mkcert
</span></span><span style="display:flex;"><span>-------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>                        Creation of the OpenVAS SSL Certificate
</span></span><span style="display:flex;"><span>-------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>This script will now ask you the relevant information to create the SSL certificate of OpenVAS.
</span></span><span style="display:flex;"><span>Note that this information will *NOT* be sent to anybody (everything stays local), but anyone with the ability to connect to your OpenVAS daemon will be able to retrieve this information.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>CA certificate life time in days [1460]: 3650
</span></span><span style="display:flex;"><span>Server certificate life time in days [365]: 
</span></span><span style="display:flex;"><span>Your country (two letter code) [DE]: US
</span></span><span style="display:flex;"><span>Your state or province name [none]: Some State
</span></span><span style="display:flex;"><span>Your location (e.g. town) [Berlin]: Some City
</span></span><span style="display:flex;"><span>Your organization [OpenVAS Users United]: Example.net
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>                        Creation of the OpenVAS SSL Certificate
</span></span><span style="display:flex;"><span>-------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Congratulations. Your server certificate was properly created.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The following files were created:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Certification authority:
</span></span><span style="display:flex;"><span>   Certificate = /etc/pki/openvas/CA/cacert.pem
</span></span><span style="display:flex;"><span>   Private key = /etc/pki/openvas/private/CA/cakey.pem
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OpenVAS Server :
</span></span><span style="display:flex;"><span>    Certificate = /etc/pki/openvas/CA/servercert.pem
</span></span><span style="display:flex;"><span>    Private key = /etc/pki/openvas/private/CA/serverkey.pem
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Press [ENTER] to exit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[root@localhost ~]#
</span></span></code></pre></div><p>As root get the NVT feed by running the command <code>openvas-nvt-sync</code>.</p>
<p>Create a certificate for the OpenVAS-Manager to connect to the scanner like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[root@localhost ~]# openvas-mkcert-client -i
</span></span><span style="display:flex;"><span>This script will now ask you the relevant information to create the SSL client certificates for OpenVAS.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Client certificates life time in days [365]: 3650
</span></span><span style="display:flex;"><span>Your country (two letter code) [DE]: US
</span></span><span style="display:flex;"><span>Your state or province name [none]: Some State
</span></span><span style="display:flex;"><span>Your location (e.g. town) [Berlin]: Some City
</span></span><span style="display:flex;"><span>Your organization [OpenVAS Users United]: Example.net
</span></span><span style="display:flex;"><span>Your organizational unit [none]: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>**********
</span></span><span style="display:flex;"><span>We are going to ask you some question for each client certificate. 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>If some question has a default answer, you can force an empty answer by entering a single dot &#39;.&#39;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*********
</span></span><span style="display:flex;"><span>OpenVAS username for the new user: om
</span></span><span style="display:flex;"><span>Client certificates life time in days [3650]: 
</span></span><span style="display:flex;"><span>Your country (two letter code) [DE]: US
</span></span><span style="display:flex;"><span>Your state or province name [none]: Some State
</span></span><span style="display:flex;"><span>Your location (e.g. town) [Berlin]: Some City
</span></span><span style="display:flex;"><span>Your organization [OpenVAS Users United]: Example.net
</span></span><span style="display:flex;"><span>Organization unit []: 
</span></span><span style="display:flex;"><span>e-Mail []: 
</span></span><span style="display:flex;"><span>Generating RSA private key, 1024 bit long modulus
</span></span><span style="display:flex;"><span>...................................++++++
</span></span><span style="display:flex;"><span>.................................................++++++
</span></span><span style="display:flex;"><span>e is 65537 (0x10001)
</span></span><span style="display:flex;"><span>You are about to be asked to enter information that will be incorporated
</span></span><span style="display:flex;"><span>into your certificate request.
</span></span><span style="display:flex;"><span>What you are about to enter is what is called a Distinguished Name or a DN.
</span></span><span style="display:flex;"><span>There are quite a few fields but you can leave some blank
</span></span><span style="display:flex;"><span>For some fields there will be a default value,
</span></span><span style="display:flex;"><span>If you enter &#39;.&#39;, the field will be left blank.
</span></span><span style="display:flex;"><span>-----
</span></span><span style="display:flex;"><span>Country Name (2 letter code) [DE]:
</span></span><span style="display:flex;"><span>State or Province Name (full name) [Some-State]:
</span></span><span style="display:flex;"><span>Locality Name (eg, city) []:
</span></span><span style="display:flex;"><span>Organization Name (eg, company) [Internet Widgits Pty Ltd]:
</span></span><span style="display:flex;"><span>Organizational Unit Name (eg, section) []:
</span></span><span style="display:flex;"><span>Common Name (eg, your name or your server&#39;s hostname) []:
</span></span><span style="display:flex;"><span>Email Address []:
</span></span><span style="display:flex;"><span>Using configuration from /tmp/openvas-mkcert-client.26805/stdC.cnf
</span></span><span style="display:flex;"><span>Check that the request matches the signature
</span></span><span style="display:flex;"><span>Signature ok
</span></span><span style="display:flex;"><span>The Subject&#39;s Distinguished Name is as follows
</span></span><span style="display:flex;"><span>countryName           :PRINTABLE:&#39;US&#39;
</span></span><span style="display:flex;"><span>stateOrProvinceName   :PRINTABLE:&#39;Some State&#39;
</span></span><span style="display:flex;"><span>localityName          :PRINTABLE:&#39;Some City&#39;
</span></span><span style="display:flex;"><span>organizationName      :PRINTABLE:&#39;Example.net&#39;
</span></span><span style="display:flex;"><span>commonName            :PRINTABLE:&#39;om&#39;
</span></span><span style="display:flex;"><span>Certificate is to be certified until Aug 20 17:24:00 2021 GMT (3650 days)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Write out database with 1 new entries
</span></span><span style="display:flex;"><span>Data Base Updated
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User rules
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>----------
</span></span><span style="display:flex;"><span>openvassd has a rules system which allows you to restrict the hosts that  has the right to test.
</span></span><span style="display:flex;"><span>For instance, you may want him to be able to scan his own host only.
</span></span><span style="display:flex;"><span>Please see the openvas-adduser(8) man page for the rules syntax.
</span></span><span style="display:flex;"><span>Enter the rules for this user, and hit ctrl-D once you are done:
</span></span><span style="display:flex;"><span>(the user can have an empty rules set)
</span></span><span style="display:flex;"><span>User om added to OpenVAS.
</span></span><span style="display:flex;"><span>[root@localhost ~]#
</span></span></code></pre></div><p>Setup GPG trust of the nvt feed. You&rsquo;ll need to create a GPG key for openvas,
download and verify the transfer integrity key, import &amp; sign the transfer
integrity key and turn on plugin signature checking. This can be done with the
following set of commands:</p>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[root@localhost ~]# mkdir /etc/openvas/gnupg
</span></span><span style="display:flex;"><span>[root@localhost ~]# gpg --homedir=/etc/openvas/gnupg --gen-key
</span></span><span style="display:flex;"><span>gpg: WARNING: unsafe permissions on homedir `/etc/openvas/gnupg&#39;
</span></span><span style="display:flex;"><span>gpg (GnuPG) 1.4.11; Copyright (C) 2010 Free Software Foundation, Inc.
</span></span><span style="display:flex;"><span>This is free software: you are free to change and redistribute it.
</span></span><span style="display:flex;"><span>There is NO WARRANTY, to the extent permitted by law.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gpg: keyring `/etc/openvas/gnupg/secring.gpg&#39; created
</span></span><span style="display:flex;"><span>gpg: keyring `/etc/openvas/gnupg/pubring.gpg&#39; created
</span></span><span style="display:flex;"><span>Please select what kind of key you want:
</span></span><span style="display:flex;"><span>   (1) RSA and RSA (default)
</span></span><span style="display:flex;"><span>   (2) DSA and Elgamal
</span></span><span style="display:flex;"><span>   (3) DSA (sign only)
</span></span><span style="display:flex;"><span>   (4) RSA (sign only)
</span></span><span style="display:flex;"><span>Your selection? 1
</span></span><span style="display:flex;"><span>RSA keys may be between 1024 and 4096 bits long.
</span></span><span style="display:flex;"><span>What keysize do you want? (2048) 
</span></span><span style="display:flex;"><span>Requested keysize is 2048 bits
</span></span><span style="display:flex;"><span>Please specify how long the key should be valid.
</span></span><span style="display:flex;"><span>         0 = key does not expire
</span></span><span style="display:flex;"><span>      &lt;n&gt;  = key expires in n days
</span></span><span style="display:flex;"><span>      &lt;n&gt;w = key expires in n weeks
</span></span><span style="display:flex;"><span>      &lt;n&gt;m = key expires in n months
</span></span><span style="display:flex;"><span>      &lt;n&gt;y = key expires in n years
</span></span><span style="display:flex;"><span>Key is valid for? (0) 
</span></span><span style="display:flex;"><span>Key does not expire at all
</span></span><span style="display:flex;"><span>Is this correct? (y/N) y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>You need a user ID to identify your key; the software constructs the user ID
</span></span><span style="display:flex;"><span>from the Real Name, Comment and Email Address in this form:
</span></span><span style="display:flex;"><span>    &#34;Heinrich Heine (Der Dichter) &lt;heinrichh@duesseldorf.de&gt;&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Real name: OpenVAS Plugin Verifier
</span></span><span style="display:flex;"><span>Email address: 
</span></span><span style="display:flex;"><span>Comment: 
</span></span><span style="display:flex;"><span>You selected this USER-ID:
</span></span><span style="display:flex;"><span>    &#34;OpenVAS Plugin Verifier&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? o
</span></span><span style="display:flex;"><span>You need a Passphrase to protect your secret key.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>You don&#39;t want a passphrase - this is probably a *bad* idea!
</span></span><span style="display:flex;"><span>I will do it anyway.  You can change your passphrase at any time,
</span></span><span style="display:flex;"><span>using this program with the option &#34;--edit-key&#34;.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>We need to generate a lot of random bytes. It is a good idea to perform
</span></span><span style="display:flex;"><span>some other action (type on the keyboard, move the mouse, utilize the
</span></span><span style="display:flex;"><span>disks) during the prime generation; this gives the random number
</span></span><span style="display:flex;"><span>generator a better chance to gain enough entropy.
</span></span><span style="display:flex;"><span>+++++
</span></span><span style="display:flex;"><span>....+++++
</span></span><span style="display:flex;"><span>We need to generate a lot of random bytes. It is a good idea to perform
</span></span><span style="display:flex;"><span>some other action (type on the keyboard, move the mouse, utilize the
</span></span><span style="display:flex;"><span>disks) during the prime generation; this gives the random number
</span></span><span style="display:flex;"><span>generator a better chance to gain enough entropy.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Not enough random bytes available.  Please do some other work to give
</span></span><span style="display:flex;"><span>the OS a chance to collect more entropy! (Need 67 more bytes)
</span></span><span style="display:flex;"><span>....+++++
</span></span><span style="display:flex;"><span>.+++++
</span></span><span style="display:flex;"><span>gpg: /etc/openvas/gnupg/trustdb.gpg: trustdb created
</span></span><span style="display:flex;"><span>gpg: key ######## marked as ultimately trusted
</span></span><span style="display:flex;"><span>public and secret key created and signed.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gpg: checking the trustdb
</span></span><span style="display:flex;"><span>gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model
</span></span><span style="display:flex;"><span>gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u
</span></span><span style="display:flex;"><span>pub   2048R/######## 2011-08-24
</span></span><span style="display:flex;"><span>      Key fingerprint = #### #### #### #### ####  #### #### #### #### ####
</span></span><span style="display:flex;"><span>uid                  OpenVAS Plugin Verifier
</span></span><span style="display:flex;"><span>sub   2048R/######## 2011-08-24
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[root@localhost ~]# wget http://www.openvas.org/OpenVAS_TI.asc
</span></span><span style="display:flex;"><span>--2011-08-23 22:38:34--  http://www.openvas.org/OpenVAS_TI.asc
</span></span><span style="display:flex;"><span>Resolving www.openvas.org... 78.47.251.62
</span></span><span style="display:flex;"><span>Connecting to www.openvas.org|78.47.251.62|:80... connected.
</span></span><span style="display:flex;"><span>HTTP request sent, awaiting response... 200 OK
</span></span><span style="display:flex;"><span>Length: 1673 (1.6K) [text/plain]
</span></span><span style="display:flex;"><span>Saving to: “OpenVAS_TI.asc”
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>100%[==============================================================&gt;] 1,673       --.-K/s   in 0s      
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>####-##-## ##:##:## (152 MB/s) - “OpenVAS_TI.asc” saved [1673/1673]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[root@localhost ~]# gpg --homedir=/etc/openvas/gnupg --import OpenVAS_TI.asc
</span></span><span style="display:flex;"><span>gpg: WARNING: unsafe permissions on homedir `/etc/openvas/gnupg&#39;
</span></span><span style="display:flex;"><span>gpg: key 48DB4530: public key &#34;OpenVAS Transfer Integrity&#34; imported
</span></span><span style="display:flex;"><span>gpg: Total number processed: 1
</span></span><span style="display:flex;"><span>gpg:               imported: 1
</span></span><span style="display:flex;"><span>[root@localhost ~]# gpg --homedir=/etc/openvas/gnupg --lsign-key 48DB4530
</span></span><span style="display:flex;"><span>gpg: WARNING: unsafe permissions on homedir `/etc/openvas/gnupg&#39;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pub  1024D/48DB4530  created: 2007-11-05  expires: never       usage: SC  
</span></span><span style="display:flex;"><span>                     trust: unknown       validity: unknown
</span></span><span style="display:flex;"><span>sub  2048g/70610CFB  created: 2007-11-05  expires: never       usage: E   
</span></span><span style="display:flex;"><span>[ unknown] (1). OpenVAS Transfer Integrity
</span></span><span style="display:flex;"><span>pub  1024D/48DB4530  created: 2007-11-05  expires: never       usage: SC  
</span></span><span style="display:flex;"><span>                     trust: unknown       validity: unknown
</span></span><span style="display:flex;"><span> Primary key fingerprint: C3B4 68D2 288C 68B9 D526  4522 4847 9FF6 48DB 4530
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>     OpenVAS Transfer Integrity
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Are you sure that you want to sign this key with your
</span></span><span style="display:flex;"><span>key &#34;OpenVAS Plugin Verifier&#34; (########)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The signature will be marked as non-exportable.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Really sign? (y/N) y
</span></span></code></pre></div><p>Alright now we need to start up the scanner service for the first time. It will
take a LONG time the first time and a significant amount of time everytime
there are updates to the NVT feed, though not nearly as long for the updates.</p>
<p>It takes so long that the service script will think that it failed. It HASN&rsquo;T,
it&rsquo;s still doing it magic in the background, it&rsquo;s easiest to just watch it go
with top. When it finally settles down it&rsquo;ll be ready for the next step.</p>
<h2 id="openvas-manager">OpenVAS Manager</h2>
<p>Now we need to build the OpenVAS manager database. I&rsquo;m not entirely sure what
the manager gets us as right now we have a working scanner (albeit without
users). I know it provides alternative connection methods such as an XML based
API for web services. Hey it might be useful it might not and there is some
funnyness but it&rsquo;s part of the full installation so I&rsquo;m going to include
directions.</p>
<p>That touch at the beginning? Yeah if you don&rsquo;t create that file you&rsquo;ll get a
&ldquo;Aborted (core dumped)&rdquo; message when you try and rebuild the database. Having
it in existence though allows it to just run smoothly. Pretty big bug if you
ask me but one with an easy work around.</p>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[root@localhost ~]# touch /var/lib/openvas/mgr/tasks.db
</span></span><span style="display:flex;"><span>[root@localhost ~]# openvasmd --rebuild
</span></span></code></pre></div><h2 id="openvas-administrator">OpenVAS Administrator</h2>
<p>This is getting it&rsquo;s own special section as it isn&rsquo;t available via the standard
Fedora package repositories annoyingly enough. For the time being I&rsquo;m going to
leave this alone.</p>
<h2 id="creating-users">Creating Users</h2>
<p>I personally prefer using certificate for authentication against the server.
Easier than typing in a password every time and more secure in some ways. To
create a user that authenticates with a certificate you need to use the
<code>openvas-mkcert-client</code> command like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[root@localhost ~]# openvas-mkcert-client
</span></span><span style="display:flex;"><span>This script will now ask you the relevant information to create the SSL client certificates for OpenVAS.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Client certificates life time in days [365]:
</span></span><span style="display:flex;"><span>Your country (two letter code) [DE]: US
</span></span><span style="display:flex;"><span>Your state or province name [none]: Some State
</span></span><span style="display:flex;"><span>Your location (e.g. town) [Berlin]: Some City
</span></span><span style="display:flex;"><span>Your organization [none]: Example.net
</span></span><span style="display:flex;"><span>Your organizational unit [none]:
</span></span><span style="display:flex;"><span>**********
</span></span><span style="display:flex;"><span>We are going to ask you some question for each client certificate.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>If some question has a default answer, you can force an empty answer by entering a single dot &#39;.&#39;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*********
</span></span><span style="display:flex;"><span>OpenVAS username for the new user: &lt;username&gt;
</span></span><span style="display:flex;"><span>Client certificates life time in days [365]:
</span></span><span style="display:flex;"><span>Country (two letter code) [US]:
</span></span><span style="display:flex;"><span>State or province name [Some State]:
</span></span><span style="display:flex;"><span>Location (e.g. town) [Some City]:
</span></span><span style="display:flex;"><span>Organization [Example.net]:
</span></span><span style="display:flex;"><span>Organization unit []:
</span></span><span style="display:flex;"><span>e-Mail []:
</span></span><span style="display:flex;"><span>Generating RSA private key, 1024 bit long modulus
</span></span><span style="display:flex;"><span>....++++++
</span></span><span style="display:flex;"><span>............................................++++++
</span></span><span style="display:flex;"><span>e is 65537 (0x10001)
</span></span><span style="display:flex;"><span>You are about to be asked to enter information that will be incorporated
</span></span><span style="display:flex;"><span>into your certificate request.
</span></span><span style="display:flex;"><span>What you are about to enter is what is called a Distinguished Name or a DN.
</span></span><span style="display:flex;"><span>There are quite a few fields but you can leave some blank
</span></span><span style="display:flex;"><span>For some fields there will be a default value,
</span></span><span style="display:flex;"><span>If you enter &#39;.&#39;, the field will be left blank.
</span></span><span style="display:flex;"><span>-----
</span></span><span style="display:flex;"><span>Country Name (2 letter code) [DE]:
</span></span><span style="display:flex;"><span>State or Province Name (full name) [Some-State]:
</span></span><span style="display:flex;"><span>Locality Name (eg, city) []:
</span></span><span style="display:flex;"><span>Organization Name (eg, company) [Internet Widgits Pty Ltd]:
</span></span><span style="display:flex;"><span>Organizational Unit Name (eg, section) []:
</span></span><span style="display:flex;"><span>Common Name (eg, your name or your server&#39;s hostname) []:
</span></span><span style="display:flex;"><span>Email Address []:
</span></span><span style="display:flex;"><span>Using configuration from /tmp/openvas-mkcert-client.15980/stdC.cnf
</span></span><span style="display:flex;"><span>Check that the request matches the signature
</span></span><span style="display:flex;"><span>Signature ok
</span></span><span style="display:flex;"><span>The Subject&#39;s Distinguished Name is as follows
</span></span><span style="display:flex;"><span>countryName           :PRINTABLE:&#39;US&#39;
</span></span><span style="display:flex;"><span>stateOrProvinceName   :PRINTABLE:&#39;Some State&#39;
</span></span><span style="display:flex;"><span>localityName          :PRINTABLE:&#39;Some City&#39;
</span></span><span style="display:flex;"><span>organizationName      :PRINTABLE:&#39;Example.net&#39;
</span></span><span style="display:flex;"><span>commonName            :PRINTABLE:&#39;&lt;username&gt;&#39;
</span></span><span style="display:flex;"><span>Certificate is to be certified until Aug 23 18:10:38 2012 GMT (365 days)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Write out database with 1 new entries
</span></span><span style="display:flex;"><span>Data Base Updated
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User rules
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>----------
</span></span><span style="display:flex;"><span>openvassd has a rules system which allows you to restrict the hosts that  has the right to test.
</span></span><span style="display:flex;"><span>For instance, you may want him to be able to scan his own host only.
</span></span><span style="display:flex;"><span>Please see the openvas-adduser(8) man page for the rules syntax.
</span></span><span style="display:flex;"><span>Enter the rules for this user, and hit ctrl-D once you are done:
</span></span><span style="display:flex;"><span>(the user can have an empty rules set)
</span></span><span style="display:flex;"><span>User sstelfox added to OpenVAS.
</span></span><span style="display:flex;"><span>Your client certificates are in /tmp/openvas-mkcert-client.15980 .
</span></span><span style="display:flex;"><span>You will have to copy them by hand.
</span></span><span style="display:flex;"><span>[root@localhost ~]# chown -R &lt;username&gt;:&lt;username&gt; /tmp/openvas-mkcert-client.15980/
</span></span><span style="display:flex;"><span>[root@localhost ~]# mv /tmp/openvas-mkcert-client.15980/ /home/&lt;username&gt;/
</span></span><span style="display:flex;"><span>[root@localhost ~]# cp /etc/pki/openvas/CA/cacert.pem /home/&lt;username&gt;/openvas-mkcert-client.15980/
</span></span></code></pre></div><h2 id="verification">Verification</h2>
<p>Save the following script and make it executable.</p>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#8b949e;font-weight:bold;font-style:italic">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># OpenVAS</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># $Id$</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Description: Script for checking completeness and readiness</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># of OpenVAS.</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Authors:</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Jan-Oliver Wagner &lt;jan-oliver.wagner@greenbone.net&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Michael Wiegand &lt;michael.wiegand@greenbone.net&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Copyright:</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Copyright (C) 2011 Greenbone Networks GmbH</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># This program is free software; you can redistribute it and/or modify</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># it under the terms of the GNU General Public License version 2,</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># or at your option any later version, as published by the</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Free Software Foundation</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># This program is distributed in the hope that it will be useful,</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># GNU General Public License for more details.</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># You should have received a copy of the GNU General Public License</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># along with this program; if not, write to the Free Software</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">LOG</span><span style="color:#ff7b72;font-weight:bold">=</span>/tmp/openvas-check-setup.log
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">CHECKVERSION</span><span style="color:#ff7b72;font-weight:bold">=</span>2.1.3
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$1</span><span style="color:#a5d6ff">&#34;</span> <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;--server&#34;</span> -o <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$2</span><span style="color:#a5d6ff">&#34;</span> <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;--server&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">MODE</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;server&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">MODE</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;desktop&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$1</span><span style="color:#a5d6ff">&#34;</span> <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;--v5&#34;</span> -o <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$2</span><span style="color:#a5d6ff">&#34;</span> <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;--v5&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">VER</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;5&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">SCANNER_MAJOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;3&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">SCANNER_MINOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;3&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">MANAGER_MAJOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;3&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">MANAGER_MINOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">ADMINISTRATOR_MAJOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">ADMINISTRATOR_MINOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">GSA_MAJOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;3&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">GSA_MINOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">CLI_MAJOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">CLI_MINOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">GSD_MAJOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">GSD_MINOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;2&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">VER</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;4&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">SCANNER_MAJOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;3&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">SCANNER_MINOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;2&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">MANAGER_MAJOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;2&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">MANAGER_MINOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">ADMINISTRATOR_MAJOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">ADMINISTRATOR_MINOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">GSA_MAJOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;2&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">GSA_MINOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">CLI_MAJOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">CLI_MINOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">GSD_MAJOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">GSD_MINOR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;2&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;openvas-check-setup </span><span style="color:#79c0ff">$CHECKVERSION</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;  Test completeness and readiness of OpenVAS-</span><span style="color:#79c0ff">$VER</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;  Please report us any non-detected problems and&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;  help us to improve this check routine:&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;  http://lists.wald.intevation.org/mailman/listinfo/openvas-discuss&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;  Send us the log-file (</span><span style="color:#79c0ff">$LOG</span><span style="color:#a5d6ff">) to help analyze the problem.&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$MODE</span><span style="color:#a5d6ff">&#34;</span> <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;desktop&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;  Use the parameter --server to skip checks for client tools&#34;</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;  like GSD and OpenVAS-CLI.&#34;</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>log_and_print <span style="color:#ff7b72;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;       &#34;</span> <span style="color:#79c0ff">$1</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;       &#34;</span> <span style="color:#79c0ff">$1</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>check_failed <span style="color:#ff7b72;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34; ERROR: Your OpenVAS-</span><span style="color:#79c0ff">$VER</span><span style="color:#a5d6ff"> installation is not yet complete!&#34;</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;Please follow the instructions marked with FIX above and run this&#34;</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;script again.&#34;</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;If you think this result is wrong, please report your observation&#34;</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;and help us to improve this check routine:&#34;</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;http://lists.wald.intevation.org/mailman/listinfo/openvas-discuss&#34;</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;Please attach the log-file (</span><span style="color:#79c0ff">$LOG</span><span style="color:#a5d6ff">) to help us analyze the problem.&#34;</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  exit <span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># LOG start</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;openvas-check-setup </span><span style="color:#79c0ff">$CHECKVERSION</span><span style="color:#a5d6ff">&#34;</span> &gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;  Mode:  </span><span style="color:#79c0ff">$MODE</span><span style="color:#a5d6ff">&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;  Date: &#34;</span> <span style="color:#a5d6ff">`</span>date -R<span style="color:#a5d6ff">`</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Step 1: Checking OpenVAS Scanner ... &#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking for old OpenVAS Scanner &lt;= 2.0 ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>openvasd -V &gt;&gt; <span style="color:#79c0ff">$LOG</span> 2&gt;&amp;<span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -eq <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>: <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: Old version of OpenVAS Scanner detected.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Please remove the installation of the old OpenVAS Scanner (openvasd).&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking presence of OpenVAS Scanner ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>openvassd --version &gt;&gt; <span style="color:#79c0ff">$LOG</span> 2&gt;&amp;<span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: No OpenVAS Scanner (openvassd) found.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Please install OpenVAS Scanner.&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking OpenVAS Scanner version ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">VERSION</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>openvassd --version | head -1 | sed -e <span style="color:#a5d6ff">&#34;s/OpenVAS Scanner //&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#a5d6ff">`</span>echo <span style="color:#79c0ff">$VERSION</span> | grep <span style="color:#a5d6ff">&#34;^</span><span style="color:#79c0ff">$SCANNER_MAJOR</span><span style="color:#a5d6ff">\.</span><span style="color:#79c0ff">$SCANNER_MINOR</span><span style="color:#a5d6ff">&#34;</span> | wc -l<span style="color:#a5d6ff">`</span> -ne <span style="color:#a5d6ff">&#34;1&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: OpenVAS Scanner too old or too new: </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Please install OpenVAS Scanner </span><span style="color:#79c0ff">$SCANNER_MAJOR</span><span style="color:#a5d6ff">.</span><span style="color:#79c0ff">$SCANNER_MINOR</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Scanner is present in version </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>openvassd -s &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking OpenVAS Scanner CA cert ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">CAFILE</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>openvassd -s | grep ca_file | sed -e <span style="color:#a5d6ff">&#34;s/^ca_file = //&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> ! -e <span style="color:#79c0ff">$CAFILE</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: No CA certificate file of OpenVAS Scanner found.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Run &#39;openvas-mkcert&#39;.&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Scanner CA Certificate is present as </span><span style="color:#79c0ff">$CAFILE</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking NVT collection ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">PLUGINSFOLDER</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>openvassd -s | grep plugins_folder | sed -e <span style="color:#a5d6ff">&#34;s/^plugins_folder = //&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> ! -d <span style="color:#79c0ff">$PLUGINSFOLDER</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: Directory containing the NVT collection not found.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Run a synchronization script like openvas-nvt-sync or greenbone-nvt-sync.&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">OLDPLUGINSFOLDER</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>echo <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$PLUGINSFOLDER</span><span style="color:#a5d6ff">&#34;</span> | grep -q -v <span style="color:#a5d6ff">&#34;/var/&#34;</span> 2&gt;&amp;1<span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -eq <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>: <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">CONFFILE</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>openvassd -s | grep config_file | sed -e <span style="color:#a5d6ff">&#34;s/^config_file = //&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: Your OpenVAS Scanner configuration seems to be from a pre-OpenVAS-4 installation and contains non-FHS compliant paths.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Delete your OpenVAS Scanner Configuration file (</span><span style="color:#79c0ff">$CONFFILE</span><span style="color:#a5d6ff">).&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">NVTCOUNT</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>find <span style="color:#79c0ff">$PLUGINSFOLDER</span> -name <span style="color:#a5d6ff">&#34;*nasl&#34;</span> | wc -l<span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$NVTCOUNT</span> -lt <span style="color:#a5d6ff">10</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: The NVT collection is very small.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Run a synchronization script like openvas-nvt-sync or greenbone-nvt-sync.&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>log_and_print <span style="color:#a5d6ff">&#34;OK: NVT collection in </span><span style="color:#79c0ff">$PLUGINSFOLDER</span><span style="color:#a5d6ff"> contains </span><span style="color:#79c0ff">$NVTCOUNT</span><span style="color:#a5d6ff"> NVTs.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking status of signature checking in OpenVAS Scanner ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">NOSIGCHECK</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>openvassd -s | grep nasl_no_signature_check | sed -e <span style="color:#a5d6ff">&#34;s/^nasl_no_signature_check = //&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$NOSIGCHECK</span> !<span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;no&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;WARNING: Signature checking of NVTs is not enabled in OpenVAS Scanner.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Enable signature checking (see http://www.openvas.org/trusted-nvts.html).&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;OK: Signature checking of NVTs is enabled in OpenVAS Scanner.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Step 2: Checking OpenVAS Manager ... &#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking presence of OpenVAS Manager ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>openvasmd --version &gt;&gt; <span style="color:#79c0ff">$LOG</span> 2&gt;&amp;<span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: No OpenVAS Manager (openvasmd) found.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Please install OpenVAS Manager.&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">VERSION</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>openvasmd --version | head -1 | sed -e <span style="color:#a5d6ff">&#34;s/OpenVAS Manager //&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#a5d6ff">`</span>echo <span style="color:#79c0ff">$VERSION</span> | grep <span style="color:#a5d6ff">&#34;^</span><span style="color:#79c0ff">$MANAGER_MAJOR</span><span style="color:#a5d6ff">\.</span><span style="color:#79c0ff">$MANAGER_MINOR</span><span style="color:#a5d6ff">&#34;</span> | wc -l<span style="color:#a5d6ff">`</span> -ne <span style="color:#a5d6ff">&#34;1&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: OpenVAS Manager too old or too new: </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Please install OpenVAS Manager </span><span style="color:#79c0ff">$MANAGER_MAJOR</span><span style="color:#a5d6ff">.</span><span style="color:#79c0ff">$MANAGER_MINOR</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Manager is present in version </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking OpenVAS Manager client certificate ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">CERTDIR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>dirname <span style="color:#79c0ff">$CAFILE</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">CLIENTCERTFILE</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$CERTDIR</span><span style="color:#a5d6ff">/clientcert.pem&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> ! -e <span style="color:#79c0ff">$CLIENTCERTFILE</span> <span style="color:#ff7b72;font-weight:bold">]</span>: <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: No client certificate file of OpenVAS Manager found.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Run &#39;openvas-mkcert-client -n om -i&#39;&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Manager client certificate is present as </span><span style="color:#79c0ff">$CLIENTCERTFILE</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking OpenVAS Manager database ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Guess openvas state dir from $PLUGINSFOLDER</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">STATEDIR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>dirname <span style="color:#79c0ff">$PLUGINSFOLDER</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">TASKSDB</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$STATEDIR</span><span style="color:#a5d6ff">/mgr/tasks.db&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> ! -e <span style="color:#79c0ff">$TASKSDB</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: No OpenVAS Manager database found. (Tried: </span><span style="color:#79c0ff">$TASKSDB</span><span style="color:#a5d6ff">)&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Run &#39;openvasmd --rebuild&#39; while OpenVAS Scanner is running.&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Manager database found in </span><span style="color:#79c0ff">$TASKSDB</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking access rights of OpenVAS Manager database ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">TASKSDBPERMS</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>stat -c <span style="color:#a5d6ff">&#34;%a&#34;</span> <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$TASKSDB</span><span style="color:#a5d6ff">&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$TASKSDBPERMS</span><span style="color:#a5d6ff">&#34;</span> !<span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;600&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: The access rights of the OpenVAS Manager database are incorrect.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Run &#39;chmod 600 </span><span style="color:#79c0ff">$TASKSDB</span><span style="color:#a5d6ff">&#39;.&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>log_and_print <span style="color:#a5d6ff">&#34;OK: Access rights for the OpenVAS Manager database are correct.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking sqlite3 presence ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">SQLITE3</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>type sqlite3 2&gt; /dev/null<span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>: <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;WARNING: Could not find sqlite3 binary, extended manager checks of the OpenVAS Manager installation are disabled.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Install sqlite3.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">HAVE_SQLITE</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;OK: sqlite3 found, extended checks of the OpenVAS Manager installation enabled.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">HAVE_SQLITE</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$HAVE_SQLITE</span> -eq <span style="color:#a5d6ff">1</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;Checking OpenVAS Manager database revision ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">TASKSDBREV</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>sqlite3 <span style="color:#79c0ff">$TASKSDB</span> <span style="color:#a5d6ff">&#34;select value from meta where name=&#39;database_version&#39;;&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> -z <span style="color:#79c0ff">$TASKSDBREV</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;ERROR: Could not determine database revision, database corrupt or in invalid format.&#34;</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;FIX: Delete database at </span><span style="color:#79c0ff">$TASKSDB</span><span style="color:#a5d6ff"> and rebuild it.&#34;</span>
</span></span><span style="display:flex;"><span>    check_failed
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Manager database is at revision </span><span style="color:#79c0ff">$TASKSDBREV</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;Checking database revision expected by OpenVAS Manager ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">MANAGERDBREV</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>openvasmd --version | grep <span style="color:#a5d6ff">&#34;Manager DB revision&#34;</span> | sed -e <span style="color:#a5d6ff">&#34;s/.*\ //&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> -z <span style="color:#79c0ff">$MANAGERDBREV</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;ERROR: Could not determine database revision expected by OpenVAS Manager.&#34;</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;FIX: Ensure OpenVAS Manager is installed correctly.&#34;</span>
</span></span><span style="display:flex;"><span>    check_failed
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Manager expects database at revision </span><span style="color:#79c0ff">$MANAGERDBREV</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$TASKSDBREV</span> -lt <span style="color:#79c0ff">$MANAGERDBREV</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;ERROR: Database schema is out of date.&#34;</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;FIX: Run &#39;openvasmd --migrate&#39;.&#34;</span>
</span></span><span style="display:flex;"><span>    check_failed
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;OK: Database schema is up to date.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;Checking OpenVAS Manager database (NVT data) ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">DBNVTCOUNT</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>sqlite3 <span style="color:#79c0ff">$TASKSDB</span> <span style="color:#a5d6ff">&#34;select count(*) from nvts;&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$DBNVTCOUNT</span> -lt <span style="color:#a5d6ff">20000</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;ERROR: The number of NVTs in the OpenVAS Manager database is too low.&#34;</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;FIX: Make sure OpenVAS Scanner is running with an up-to-date NVT collection and run &#39;openvasmd --rebuild&#39;.&#34;</span>
</span></span><span style="display:flex;"><span>    check_failed
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Manager database contains information about </span><span style="color:#79c0ff">$DBNVTCOUNT</span><span style="color:#a5d6ff"> NVTs.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking xsltproc presence ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">XSLTPROC</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>type xsltproc 2&gt; /dev/null<span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;WARNING: Could not find xsltproc binary, most report formats will not work.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Install xsltproc.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;OK: xsltproc found.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Step 3: Checking OpenVAS Administrator ... &#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking presence of OpenVAS Administrator ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>openvasad --version &gt;&gt; <span style="color:#79c0ff">$LOG</span> 2&gt;&amp;<span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: No OpenVAS Administrator (openvasad) found.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Please install OpenVAS Administrator.&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">VERSION</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>openvasad --version | head -1 | sed -e <span style="color:#a5d6ff">&#34;s/OpenVAS Administrator //&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#a5d6ff">`</span>echo <span style="color:#79c0ff">$VERSION</span> | grep <span style="color:#a5d6ff">&#34;^</span><span style="color:#79c0ff">$ADMINISTRATOR_MAJOR</span><span style="color:#a5d6ff">\.</span><span style="color:#79c0ff">$ADMINISTRATOR_MINOR</span><span style="color:#a5d6ff">&#34;</span> | wc -l<span style="color:#a5d6ff">`</span> -ne <span style="color:#a5d6ff">&#34;1&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: OpenVAS Administrator too old or too new: </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Please install OpenVAS Administrator </span><span style="color:#79c0ff">$ADMINISTRATOR_MAJOR</span><span style="color:#a5d6ff">.</span><span style="color:#79c0ff">$ADMINISTRATOR_MINOR</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Administrator is present in version </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking if users exist ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">USERCOUNT</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>openvasad -c <span style="color:#a5d6ff">&#34;list_users&#34;</span> | sed -e <span style="color:#a5d6ff">&#34;/^</span>$<span style="color:#a5d6ff">/d&#34;</span> | wc -l<span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$USERCOUNT</span> -eq <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: No users found. You need to create at least one user to log in.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Create a user using &#39;openvasad -c &#39;add_user&#39; -n &lt;name&gt;&#39;&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;OK: At least one user exists.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking if at least one admin user exists ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">ADMINEXISTS</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>ls <span style="color:#79c0ff">$STATEDIR</span>/users/*/isadmin 2&gt; /dev/null<span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: No admin user found. You need to create at least one admin user to log in.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Create a user using &#39;openvasad -c &#39;add_user&#39; -n &lt;name&gt; -r Admin&#39;&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;OK: At least one admin user exists.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Step 4: Checking Greenbone Security Assistant (GSA) ... &#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking presence of Greenbone Security Assistant ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>gsad --version &gt;&gt; <span style="color:#79c0ff">$LOG</span> 2&gt;&amp;<span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: No Greenbone Security Assistant (gsad) found.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Please install Greenbone Security Assistant.&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">VERSION</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>gsad --version | head -1 | sed -e <span style="color:#a5d6ff">&#34;s/Greenbone Security Assistant //&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#a5d6ff">`</span>echo <span style="color:#79c0ff">$VERSION</span> | grep <span style="color:#a5d6ff">&#34;^</span><span style="color:#79c0ff">$GSA_MAJOR</span><span style="color:#a5d6ff">\.</span><span style="color:#79c0ff">$GSA_MINOR</span><span style="color:#a5d6ff">&#34;</span> | wc -l<span style="color:#a5d6ff">`</span> -ne <span style="color:#a5d6ff">&#34;1&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;ERROR: Greenbone Security Assistant too old or too new: </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;FIX: Please install Greenbone Security Assistant </span><span style="color:#79c0ff">$GSA_MAJOR</span><span style="color:#a5d6ff">.</span><span style="color:#79c0ff">$GSA_MINOR</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>  check_failed
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>log_and_print <span style="color:#a5d6ff">&#34;OK: Greenbone Security Assistant is present in version </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Step 5: Checking OpenVAS CLI ... &#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$MODE</span><span style="color:#a5d6ff">&#34;</span> !<span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;server&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;Checking presence of OpenVAS CLI ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>  omp --version &gt;&gt; <span style="color:#79c0ff">$LOG</span> 2&gt;&amp;<span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;ERROR: No OpenVAS CLI (omp) found.&#34;</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;FIX: Please install OpenVAS CLI.&#34;</span>
</span></span><span style="display:flex;"><span>    check_failed
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">VERSION</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>omp --version | head -1 | sed -e <span style="color:#a5d6ff">&#34;s/OMP Command Line Interface //&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#a5d6ff">`</span>echo <span style="color:#79c0ff">$VERSION</span> | grep <span style="color:#a5d6ff">&#34;^</span><span style="color:#79c0ff">$CLI_MAJOR</span><span style="color:#a5d6ff">\.</span><span style="color:#79c0ff">$CLI_MINOR</span><span style="color:#a5d6ff">&#34;</span> | wc -l<span style="color:#a5d6ff">`</span> -ne <span style="color:#a5d6ff">&#34;1&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;ERROR: OpenVAS CLI too old or too new: </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;FIX: Please install OpenVAS CLI </span><span style="color:#79c0ff">$CLI_MAJOR</span><span style="color:#a5d6ff">.</span><span style="color:#79c0ff">$CLI_MINOR</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>    check_failed
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS CLI version </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;SKIP: Skipping check for OpenVAS CLI.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Step 6: Checking Greenbone Security Desktop (GSD) ... &#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$MODE</span><span style="color:#a5d6ff">&#34;</span> !<span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;server&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;Checking presence of Greenbone Security Desktop ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">DISPLAY</span><span style="color:#ff7b72;font-weight:bold">=</span>fake gsd --version &gt;&gt; <span style="color:#79c0ff">$LOG</span> 2&gt;&amp;<span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;ERROR: No Greenbone Security Desktop (gsd) found or too old.&#34;</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;FIX: Please install Greenbone Security Desktop 1.1.0.&#34;</span>
</span></span><span style="display:flex;"><span>    check_failed
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">VERSION</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>gsd --version | head -1 | sed -e <span style="color:#a5d6ff">&#34;s/Greenbone Security Desktop //&#34;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#a5d6ff">`</span>echo <span style="color:#79c0ff">$VERSION</span> | grep <span style="color:#a5d6ff">&#34;^</span><span style="color:#79c0ff">$GSD_MAJOR</span><span style="color:#a5d6ff">\.</span><span style="color:#79c0ff">$GSD_MINOR</span><span style="color:#a5d6ff">&#34;</span> | wc -l<span style="color:#a5d6ff">`</span> -ne <span style="color:#a5d6ff">&#34;1&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic"># a special exception rule for v4 where also another release is OK</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$VER</span> -eq <span style="color:#a5d6ff">&#34;4&#34;</span> -a <span style="color:#a5d6ff">`</span>echo <span style="color:#79c0ff">$VERSION</span> | grep <span style="color:#a5d6ff">&#34;^1\.1&#34;</span> | wc -l<span style="color:#a5d6ff">`</span> -ne <span style="color:#a5d6ff">&#34;1&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>      log_and_print <span style="color:#a5d6ff">&#34;ERROR: Greenbone Security Desktop too old or too new: </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>      log_and_print <span style="color:#a5d6ff">&#34;FIX: Please install Greenbone Security Desktop </span><span style="color:#79c0ff">$GSD_MAJOR</span><span style="color:#a5d6ff">.</span><span style="color:#79c0ff">$GSD_MINOR</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>      check_failed
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;OK: Greenbone Security Desktop is present in Version </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;SKIP: Skipping check for Greenbone Security Assistant.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Step 7: Checking if OpenVAS services are up and running ... &#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking netstat presence ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">NETSTAT</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>type netstat 2&gt; /dev/null<span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;WARNING: Could not find netstat binary, checks of the OpenVAS services are disabled.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Install netstat.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">HAVE_NETSTAT</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;OK: netstat found, extended checks of the OpenVAS services enabled.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">HAVE_NETSTAT</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$HAVE_NETSTAT</span> -eq <span style="color:#a5d6ff">1</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  netstat -A inet -ntlp 2&gt; /dev/null &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">OPENVASSD_HOST</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>netstat -A inet -ntlp 2&gt; /dev/null | grep openvassd | awk -F<span style="color:#79c0ff">\ </span> <span style="color:#a5d6ff">&#39;{print $4}&#39;</span> | awk -F: <span style="color:#a5d6ff">&#39;{print $1}&#39;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">OPENVASSD_PORT</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>netstat -A inet -ntlp 2&gt; /dev/null | grep openvassd | awk -F<span style="color:#79c0ff">\ </span> <span style="color:#a5d6ff">&#39;{print $4}&#39;</span> | awk -F: <span style="color:#a5d6ff">&#39;{print $2}&#39;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">OPENVASMD_HOST</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>netstat -A inet -ntlp 2&gt; /dev/null | grep openvasmd | awk -F<span style="color:#79c0ff">\ </span> <span style="color:#a5d6ff">&#39;{print $4}&#39;</span> | awk -F: <span style="color:#a5d6ff">&#39;{print $1}&#39;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">OPENVASMD_PORT</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>netstat -A inet -ntlp 2&gt; /dev/null | grep openvasmd | awk -F<span style="color:#79c0ff">\ </span> <span style="color:#a5d6ff">&#39;{print $4}&#39;</span> | awk -F: <span style="color:#a5d6ff">&#39;{print $2}&#39;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">OPENVASAD_HOST</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>netstat -A inet -ntlp 2&gt; /dev/null | grep openvasad | awk -F<span style="color:#79c0ff">\ </span> <span style="color:#a5d6ff">&#39;{print $4}&#39;</span> | awk -F: <span style="color:#a5d6ff">&#39;{print $1}&#39;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">OPENVASAD_PORT</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>netstat -A inet -ntlp 2&gt; /dev/null | grep openvasad | awk -F<span style="color:#79c0ff">\ </span> <span style="color:#a5d6ff">&#39;{print $4}&#39;</span> | awk -F: <span style="color:#a5d6ff">&#39;{print $2}&#39;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">GSAD_HOST</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>netstat -A inet -ntlp 2&gt; /dev/null | grep gsad | awk -F<span style="color:#79c0ff">\ </span> <span style="color:#a5d6ff">&#39;{print $4}&#39;</span> | awk -F: <span style="color:#a5d6ff">&#39;{print $1}&#39;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">GSAD_PORT</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>netstat -A inet -ntlp 2&gt; /dev/null | grep gsad | awk -F<span style="color:#79c0ff">\ </span> <span style="color:#a5d6ff">&#39;{print $4}&#39;</span> | awk -F: <span style="color:#a5d6ff">&#39;{print $2}&#39;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">case</span> <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$OPENVASSD_HOST</span><span style="color:#a5d6ff">&#34;</span> in
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#34;0.0.0.0&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Scanner is running and listening on all interfaces.&#34;</span> ;;
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#34;127.0.0.1&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Scanner is running and listening only on the local interface.&#34;</span> ;;
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#34;&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;ERROR: OpenVAS Scanner is NOT running!&#34;</span> ; log_and_print <span style="color:#a5d6ff">&#34;FIX: Start OpenVAS Scanner (openvassd).&#34;</span> ; <span style="color:#79c0ff">OPENVASSD_PORT</span><span style="color:#ff7b72;font-weight:bold">=</span>-1 ;;
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">esac</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">case</span> <span style="color:#79c0ff">$OPENVASSD_PORT</span> in
</span></span><span style="display:flex;"><span>    -1<span style="color:#ff7b72;font-weight:bold">)</span> ;;
</span></span><span style="display:flex;"><span>    9391<span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Scanner is listening on port 9391, which is the default port.&#34;</span> ;;
</span></span><span style="display:flex;"><span>    *<span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;WARNING: OpenVAS Scanner is listening on port </span><span style="color:#79c0ff">$OPENVASSD_PORT</span><span style="color:#a5d6ff">, which is NOT the default port!&#34;</span>
</span></span><span style="display:flex;"><span>       log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Ensure OpenVAS Scanner is listening on port 9391.&#34;</span> ;;
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">esac</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">case</span> <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$OPENVASMD_HOST</span><span style="color:#a5d6ff">&#34;</span> in
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#34;0.0.0.0&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Manager is running and listening on all interfaces.&#34;</span> ;;
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#34;127.0.0.1&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;WARNING: OpenVAS Manager is running and listening only on the local interface. This means that you will not be able to access the OpenVAS Manager from the outside using GSD or OpenVAS CLI.&#34;</span>
</span></span><span style="display:flex;"><span>                 log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Ensure that OpenVAS Manager listens on all interfaces.&#34;</span> ;;
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#34;&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;ERROR: OpenVAS Manager is NOT running!&#34;</span> ; log_and_print <span style="color:#a5d6ff">&#34;FIX: Start OpenVAS Manager (openvasmd).&#34;</span> ; <span style="color:#79c0ff">OPENVASMD_PORT</span><span style="color:#ff7b72;font-weight:bold">=</span>-1 ;;
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">esac</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">case</span> <span style="color:#79c0ff">$OPENVASMD_PORT</span> in
</span></span><span style="display:flex;"><span>    -1<span style="color:#ff7b72;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>      ;;
</span></span><span style="display:flex;"><span>    9390<span style="color:#ff7b72;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>      log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Manager is listening on port 9390, which is the default port.&#34;</span>
</span></span><span style="display:flex;"><span>      ;;
</span></span><span style="display:flex;"><span>    *<span style="color:#ff7b72;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>      log_and_print <span style="color:#a5d6ff">&#34;WARNING: OpenVAS Manager is listening on port </span><span style="color:#79c0ff">$OPENVASMD_PORT</span><span style="color:#a5d6ff">, which is NOT the default port!&#34;</span>
</span></span><span style="display:flex;"><span>      log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Ensure OpenVAS Manager is listening on port 9390.&#34;</span>
</span></span><span style="display:flex;"><span>      ;;
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">esac</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">case</span> <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$OPENVASAD_HOST</span><span style="color:#a5d6ff">&#34;</span> in
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#34;0.0.0.0&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Administrator is running and listening on all interfaces.&#34;</span> ;;
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#34;127.0.0.1&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Administrator is running and listening only on the local interface.&#34;</span> ;;
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#34;&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;ERROR: OpenVAS Administrator is NOT running!&#34;</span> ; log_and_print <span style="color:#a5d6ff">&#34;FIX: Start OpenVAS Administrator (openvasad).&#34;</span> ; <span style="color:#79c0ff">OPENVASAD_PORT</span><span style="color:#ff7b72;font-weight:bold">=</span>-1 ;;
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">esac</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">case</span> <span style="color:#79c0ff">$OPENVASAD_PORT</span> in
</span></span><span style="display:flex;"><span>    -1<span style="color:#ff7b72;font-weight:bold">)</span> ;;
</span></span><span style="display:flex;"><span>    9393<span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;OK: OpenVAS Administrator is listening on port 9393, which is the default port.&#34;</span> ;;
</span></span><span style="display:flex;"><span>    *<span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;WARNING: OpenVAS Administrator is listening on port </span><span style="color:#79c0ff">$OPENVASAD_PORT</span><span style="color:#a5d6ff">, which is NOT the default port!&#34;</span>
</span></span><span style="display:flex;"><span>       log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Ensure OpenVAS Administrator is listening on port 9393.&#34;</span> ;;
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">esac</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">case</span> <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$GSAD_HOST</span><span style="color:#a5d6ff">&#34;</span> in
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#34;0.0.0.0&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;OK: Greenbone Security Assistant is running and listening on all interfaces.&#34;</span> ;;
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#34;127.0.0.1&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;WARNING: Greenbone Security Assistant is running and listening only on the local interface. This means that you will not be able to access the Greenbone Security Assistant from the outside using a web browser.&#34;</span>
</span></span><span style="display:flex;"><span>                 log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Ensure that Greenbone Security Assistant listens on all interfaces.&#34;</span> ;;
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#34;&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;ERROR: Greenbone Security Assistant is NOT running!&#34;</span> ; log_and_print <span style="color:#a5d6ff">&#34;FIX: Start Greenbone Security Assistant (gsad).&#34;</span> ; <span style="color:#79c0ff">GSAD_PORT</span><span style="color:#ff7b72;font-weight:bold">=</span>-1 ;;
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">esac</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">case</span> <span style="color:#79c0ff">$GSAD_PORT</span> in
</span></span><span style="display:flex;"><span>    -1<span style="color:#ff7b72;font-weight:bold">)</span> ;;
</span></span><span style="display:flex;"><span>    80|443|9392<span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;OK: Greenbone Security Assistant is listening on port </span><span style="color:#79c0ff">$GSAD_PORT</span><span style="color:#a5d6ff">, which is the default port.&#34;</span> ;;
</span></span><span style="display:flex;"><span>    *<span style="color:#ff7b72;font-weight:bold">)</span> log_and_print <span style="color:#a5d6ff">&#34;WARNING: Greenbone Security Assistant is listening on port </span><span style="color:#79c0ff">$GSAD_PORT</span><span style="color:#a5d6ff">, which is NOT the default port!&#34;</span>
</span></span><span style="display:flex;"><span>       log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Ensure Greenbone Security Assistant is listening on one of the following ports: 80, 443, 9392.&#34;</span> ;;
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">esac</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$OPENVASSD_PORT</span> -eq -1 <span style="color:#ff7b72;font-weight:bold">]</span> <span style="color:#ff7b72;font-weight:bold">||</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$OPENVASMD_PORT</span> -eq -1 <span style="color:#ff7b72;font-weight:bold">]</span> <span style="color:#ff7b72;font-weight:bold">||</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$OPENVASAD_PORT</span> -eq -1 <span style="color:#ff7b72;font-weight:bold">]</span> <span style="color:#ff7b72;font-weight:bold">||</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$GSAD_PORT</span> -eq -1 <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    check_failed
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Step 8: Checking nmap installation ...&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking presence of nmap ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">VERSION</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>nmap --version | awk <span style="color:#a5d6ff">&#39;/Nmap version/ { print $3 }&#39;</span><span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;WARNING: No nmap installation found.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: You should install nmap for comprehensive network scanning (see http://nmap.org)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#a5d6ff">`</span>echo <span style="color:#79c0ff">$VERSION</span> | grep <span style="color:#a5d6ff">&#34;5\.51&#34;</span> | wc -l<span style="color:#a5d6ff">`</span> -ne <span style="color:#a5d6ff">&#34;1&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;WARNING: Your version of nmap is not fully supported: </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: You should install nmap 5.51.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;OK: nmap is present in version </span><span style="color:#79c0ff">$VERSION</span><span style="color:#a5d6ff">.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Step 9: Checking presence of optional tools ...&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking presence of pdflatex ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">PDFLATEX</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>type pdflatex 2&gt; /dev/null<span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;WARNING: Could not find pdflatex binary, the PDF report format will not work.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Install pdflatex.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">HAVE_PDFLATEX</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;OK: pdflatex found.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">HAVE_PDFLATEX</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$HAVE_PDFLATEX</span> -eq <span style="color:#a5d6ff">1</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;Checking presence of LaTeX packages required for PDF report generation ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">PDFTMPDIR</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>mktemp -d -t openvas-check-setup-tmp.XXXXXXXXXX<span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">TEXFILE</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$PDFTMPDIR</span><span style="color:#a5d6ff">/test.tex&#34;</span>
</span></span><span style="display:flex;"><span>  cat <span style="color:#a5d6ff">&lt;&lt;EOT &gt; $TEXFILE
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\documentclass{article}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\pagestyle{empty}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">%\usepackage{color}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\usepackage{tabularx}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\usepackage{geometry}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\usepackage{comment}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\usepackage{longtable}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\usepackage{titlesec}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\usepackage{chngpage}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\usepackage{calc}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\usepackage{url}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\usepackage[utf8x]{inputenc}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\DeclareUnicodeCharacter {135}{{\textascii ?}}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\DeclareUnicodeCharacter {129}{{\textascii ?}}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\DeclareUnicodeCharacter {128}{{\textascii ?}}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\usepackage{colortbl}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">% must come last
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\usepackage{hyperref}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\definecolor{linkblue}{rgb}{0.11,0.56,1}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\definecolor{inactive}{rgb}{0.56,0.56,0.56}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\definecolor{openvas_debug}{rgb}{0.78,0.78,0.78}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\definecolor{openvas_false_positive}{rgb}{0.2275,0.2275,0.2275}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\definecolor{openvas_log}{rgb}{0.2275,0.2275,0.2275}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\definecolor{openvas_hole}{rgb}{0.7960,0.1137,0.0902}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\definecolor{openvas_note}{rgb}{0.3255,0.6157,0.7961}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\definecolor{openvas_report}{rgb}{0.68,0.74,0.88}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\definecolor{openvas_user_note}{rgb}{1.0,1.0,0.5625}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\definecolor{openvas_user_override}{rgb}{1.0,1.0,0.5625}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\definecolor{openvas_warning}{rgb}{0.9764,0.6235,0.1922}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\hypersetup{colorlinks=true,linkcolor=linkblue,urlcolor=blue,bookmarks=true,bookmarksopen=true}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\usepackage[all]{hypcap}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">%\geometry{verbose,a4paper,tmargin=24mm,bottom=24mm}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\geometry{verbose,a4paper}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\setlength{\parskip}{\smallskipamount}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\setlength{\parindent}{0pt}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\title{PDF Report Test}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\pagestyle{headings}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\pagenumbering{arabic}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\begin{document}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">This is a test of the PDF generation capabilities of your OpenVAS installation. Please ignore.
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\end{document}
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">EOT</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  pdflatex -interaction batchmode -output-directory <span style="color:#79c0ff">$PDFTMPDIR</span> <span style="color:#79c0ff">$TEXFILE</span> &gt; /dev/null 2&gt;&amp;<span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> ! -f <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$PDFTMPDIR</span><span style="color:#a5d6ff">/test.pdf&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;WARNING: PDF generation failed, most likely due to missing LaTeX packages. The PDF report format will not work.&#34;</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Install required LaTeX packages.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;OK: PDF generation successful. The PDF report format is likely to work.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> -f <span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">$PDFTMPDIR</span><span style="color:#a5d6ff">/test.log&#34;</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    cat <span style="color:#79c0ff">$PDFTMPDIR</span>/test.log &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>  rm -rf <span style="color:#79c0ff">$PDFTMPDIR</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking presence of ssh-keygen ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">SSHKEYGEN</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>type ssh-keygen 2&gt; /dev/null<span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;WARNING: Could not find ssh-keygen binary, LSC credential generation for GNU/Linux targets will not work.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Install ssh-keygen.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">HAVE_SSHKEYGEN</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;OK: ssh-keygen found, LSC credential generation for GNU/Linux targets is likely to work.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">HAVE_SSHKEYGEN</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$HAVE_SSHKEYGEN</span> -eq <span style="color:#a5d6ff">1</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;Checking presence of rpm ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">RPM</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>type rpm 2&gt; /dev/null<span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;WARNING: Could not find rpm binary, LSC credential package generation for RPM and DEB based targets will not work.&#34;</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Install rpm.&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#79c0ff">HAVE_RPM</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>    log_and_print <span style="color:#a5d6ff">&#34;OK: rpm found, LSC credential package generation for RPM based targets is likely to work.&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#79c0ff">HAVE_RPM</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$HAVE_RPM</span> -eq <span style="color:#a5d6ff">1</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#a5d6ff">&#34;Checking presence of alien ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>    <span style="color:#79c0ff">ALIEN</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>type alien 2&gt; /dev/null<span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>      log_and_print <span style="color:#a5d6ff">&#34;WARNING: Could not find alien binary, LSC credential package generation for DEB based targets will not work.&#34;</span>
</span></span><span style="display:flex;"><span>      log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Install alien.&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#79c0ff">HAVE_ALIEN</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>      log_and_print <span style="color:#a5d6ff">&#34;OK: alien found, LSC credential package generation for DEB based targets is likely to work.&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#79c0ff">HAVE_ALIEN</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Checking presence of nsis ...&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">NSIS</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">`</span>type makensis 2&gt; /dev/null<span style="color:#a5d6ff">`</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">[</span> <span style="color:#79c0ff">$?</span> -ne <span style="color:#a5d6ff">0</span> <span style="color:#ff7b72;font-weight:bold">]</span>; <span style="color:#ff7b72">then</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;WARNING: Could not find makensis binary, LSC credential package generation for Microsoft Windows targets will not work.&#34;</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;SUGGEST: Install nsis.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">HAVE_NSIS</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  log_and_print <span style="color:#a5d6ff">&#34;OK: nsis found, LSC credential package generation for Microsoft Windows targets is likely to work.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#79c0ff">HAVE_NSIS</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">fi</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span> &gt;&gt; <span style="color:#79c0ff">$LOG</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;It seems like your OpenVAS-</span><span style="color:#79c0ff">$VER</span><span style="color:#a5d6ff"> installation is OK.&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;If you think it is not OK, please report your observation&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;and help us to improve this check routine:&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;http://lists.wald.intevation.org/mailman/listinfo/openvas-discuss&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;Please attach the log-file (</span><span style="color:#79c0ff">$LOG</span><span style="color:#a5d6ff">) to help us analyze the problem.&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#a5d6ff">&#34;&#34;</span>
</span></span></code></pre></div><p>Make the script executable and run it, it should find any errors with your
installation or steps you skipped.</p>
<h2 id="scanning">Scanning</h2>
<p>I&rsquo;m going to assume that you&rsquo;re using the openvas-client as the scanning
client. Here are a few quick notes for setting up a decent scan setup</p>
<ul>
<li>Global Settings
<ul>
<li>General
<ul>
<li>Range: default</li>
<li>20 concurrent hosts</li>
<li>5 concurrent checks</li>
<li>Do a reverse lookup</li>
<li>Optimize the test</li>
<li>Safe checks</li>
<li>Scanners
<ul>
<li>OpenVAS TCP Scanner</li>
<li>Ping Host</li>
<li>Nmap (NASL wrapper)</li>
</ul>
</li>
</ul>
</li>
<li>Plugins
<ul>
<li>Enable All</li>
<li>Enable at runtime</li>
<li>Not Silent</li>
<li>Automatically enable new plugins</li>
</ul>
</li>
<li>Credentials
<ul>
<li>(Optional but a more thorough scan is done with them)</li>
<li>SSH credentials need to be managed through the Extras-&gt;LSC Credentials Manager in the tool bar. It annoyingly does not support simple username/password SSH combos very well requiring you to generate a key pair, set a comment on the keypair (without spaces), and a password on the key pair EVEN IF YOU DON&rsquo;T INTEND TO USE IT.</li>
</ul>
</li>
<li>Leave target selection as localhost only, these are the global configuration options and you should be forced to set them for each set of scans</li>
<li>KB
<ul>
<li>Enable KB Saving</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>When you&rsquo;re ready to create a scan create a new &ldquo;Task&rdquo; I usually create a Task
per organization that I intend to scan and allows me to organize both different
kinds of scans for that organization as well as multiple scanners.</p>
<p>Create a &ldquo;Scope&rdquo; inside the Task, this will request logging into the server
that you&rsquo;ll be running the scan from and will inherit all of the global
settings. Adjust the target selection and make scan specific adjustments then
Launch!</p>
<h2 id="configuration">Configuration</h2>
<h3 id="etcopenvasopenvassdconf">/etc/openvas/openvassd.conf</h3>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Configuration file of the OpenVAS Security Scanner</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Every line starting with a &#39;#&#39; is a comment</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">[Misc]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Path to the security checks folder:</span>
</span></span><span style="display:flex;"><span>plugins_folder <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">/var/lib/openvas/plugins</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Path to OpenVAS caching folder:</span>
</span></span><span style="display:flex;"><span>cache_folder <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">/var/cache/openvas</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Path to OpenVAS include directories:</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># (multiple entries are separated with colon &#39;:&#39;)</span>
</span></span><span style="display:flex;"><span>include_folders <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">/var/lib/openvas/plugins</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Maximum number of simultaneous hosts tested :</span>
</span></span><span style="display:flex;"><span>max_hosts <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">30</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Maximum number of simultaneous checks against each host tested :</span>
</span></span><span style="display:flex;"><span>max_checks <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Niceness. If set to &#39;yes&#39;, openvassd will renice itself to 10.</span>
</span></span><span style="display:flex;"><span>be_nice <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Log file (or &#39;syslog&#39;) :</span>
</span></span><span style="display:flex;"><span>logfile <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">/var/log/openvas/openvassd.log</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Shall we log every details of the attack ? (disk intensive)</span>
</span></span><span style="display:flex;"><span>log_whole_attack <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">no</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Log the name of the plugins that are loaded by the server ?</span>
</span></span><span style="display:flex;"><span>log_plugins_name_at_load <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">no</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Dump file for debugging output, use `-&#39; for stdout</span>
</span></span><span style="display:flex;"><span>dumpfile <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">/var/log/openvas/openvassd.dump</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Rules file :</span>
</span></span><span style="display:flex;"><span>rules <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">/etc/openvas/openvassd.rules</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># CGI paths to check for (cgi-bin:/cgi-aws:/ can do)</span>
</span></span><span style="display:flex;"><span>cgi_path <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">/cgi-bin:/scripts</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Range of the ports the port scanners will scan :</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># &#39;default&#39; means that OpenVAS will scan ports found in its</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># services file.</span>
</span></span><span style="display:flex;"><span>port_range <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">default</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Optimize the test (recommended) :</span>
</span></span><span style="display:flex;"><span>optimize_test <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Optimization :</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Read timeout for the sockets of the tests :</span>
</span></span><span style="display:flex;"><span>checks_read_timeout <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Ports against which two plugins should not be run simultaneously :</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># non_simult_ports = Services/www, 139, Services/finger</span>
</span></span><span style="display:flex;"><span>non_simult_ports <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">139, 445</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Maximum lifetime of a plugin (in seconds) :</span>
</span></span><span style="display:flex;"><span>plugins_timeout <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">320</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Safe checks rely on banner grabbing :</span>
</span></span><span style="display:flex;"><span>safe_checks <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Automatically activate the plugins that are depended on</span>
</span></span><span style="display:flex;"><span>auto_enable_dependencies <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Do not echo data from plugins which have been automatically enabled</span>
</span></span><span style="display:flex;"><span>silent_dependencies <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">no</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Designate hosts by MAC address, not IP address (useful for DHCP networks)</span>
</span></span><span style="display:flex;"><span>use_mac_addr <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">no</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#--- Knowledge base saving (can be configured by the client) :</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Save the knowledge base on disk :</span>
</span></span><span style="display:flex;"><span>save_knowledge_base <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Restore the KB for each test :</span>
</span></span><span style="display:flex;"><span>kb_restore <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Only test hosts whose KB we do not have :</span>
</span></span><span style="display:flex;"><span>only_test_hosts_whose_kb_we_dont_have <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">no</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Only test hosts whose KB we already have :</span>
</span></span><span style="display:flex;"><span>only_test_hosts_whose_kb_we_have <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">no</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># KB test replay :</span>
</span></span><span style="display:flex;"><span>kb_dont_replay_scanners <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">no</span>
</span></span><span style="display:flex;"><span>kb_dont_replay_info_gathering <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">no</span>
</span></span><span style="display:flex;"><span>kb_dont_replay_attacks <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">no</span>
</span></span><span style="display:flex;"><span>kb_dont_replay_denials <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">no</span>
</span></span><span style="display:flex;"><span>kb_max_age <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">864000</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#--- end of the KB section</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># If this option is set, OpenVAS will not scan a network incrementally</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># (10.0.0.1, then 10.0.0.2, 10.0.0.3 and so on..) but will attempt to</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># slice the workload throughout the whole network (ie: it will scan</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 10.0.0.1, then 10.0.0.127, then 10.0.0.2, then 10.0.0.128 and so on...</span>
</span></span><span style="display:flex;"><span>slice_network_addresses <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">no</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Should consider all the NASL scripts as being signed ? (unsafe if set to &#39;yes&#39;)</span>
</span></span><span style="display:flex;"><span>nasl_no_signature_check <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">no</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#Certificates</span>
</span></span><span style="display:flex;"><span>cert_file<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">/etc/pki/openvas/CA/servercert.pem</span>
</span></span><span style="display:flex;"><span>key_file<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">/etc/pki/openvas/private/CA/serverkey.pem</span>
</span></span><span style="display:flex;"><span>ca_file<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">/etc/pki/openvas/CA/cacert.pem</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># If you decide to protect your private key with a password,</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># uncomment and change next line</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># pem_password=password</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># If you want to force the use of a client certificate, uncomment next line</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># force_pubkey_auth = yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#end.</span>
</span></span></code></pre></div>
            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.c90b8161416b87c69a8e02683b54ddd6edb90aea699648bf655e6cbc45b419b8e465d196e715772463dba35a6faf5decb2eb247480d38680484d54645b434570.js" integrity="sha512-yQuBYUFrh8aajgJoO1Td1u25Cupplki/ZV5svEW0GbjkZdGW5xV3JGPbo1pvr13ssuskdIDThoBITVRkW0NFcA=="></script>



    </body>
</html>
