<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="Note: This page is quite old and is likely out of date. My opinions may have also changed dramatically since this was written. It is here as a reference until I get around to updating it.
SetupInstall the packages nikto, openvas-scanner, openvas-manager, and openvas-client.
ScannerAs root run openvas-mkcert like the following:
[root@localhost ~]# openvas-mkcert ------------------------------------------------------------------------------- Creation of the OpenVAS SSL Certificate ------------------------------------------------------------------------------- This script will now ask you the relevant information to create the SSL certificate of OpenVAS."><meta name=keywords content="blog,programming,linux,systems,personal,rust,philosophy"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://stelfox.net/notes/openvas/><title>OpenVAS :: ./Sam_Stelfox.sh — A simple place for my collected thoughts and notes.
</title><link rel=stylesheet href=/main.949191c1dcc9c4a887997048b240354e47152016d821198f89448496ba42e491.css integrity="sha256-lJGRwdzJxKiHmXBIskA1TkcVIBbYIRmPiUSElrpC5JE="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel="shortcut icon" href=/favicon.ico><meta itemprop=name content="OpenVAS"><meta itemprop=description content="Note: This page is quite old and is likely out of date. My opinions may have also changed dramatically since this was written. It is here as a reference until I get around to updating it.
SetupInstall the packages nikto, openvas-scanner, openvas-manager, and openvas-client.
ScannerAs root run openvas-mkcert like the following:
[root@localhost ~]# openvas-mkcert ------------------------------------------------------------------------------- Creation of the OpenVAS SSL Certificate ------------------------------------------------------------------------------- This script will now ask you the relevant information to create the SSL certificate of OpenVAS."><meta itemprop=datePublished content="2013-01-01T00:00:01+00:00"><meta itemprop=dateModified content="2013-01-01T00:00:01+00:00"><meta itemprop=wordCount content="7038"><meta name=twitter:card content="summary"><meta name=twitter:title content="OpenVAS"><meta name=twitter:description content="Note: This page is quite old and is likely out of date. My opinions may have also changed dramatically since this was written. It is here as a reference until I get around to updating it.
SetupInstall the packages nikto, openvas-scanner, openvas-manager, and openvas-client.
ScannerAs root run openvas-mkcert like the following:
[root@localhost ~]# openvas-mkcert ------------------------------------------------------------------------------- Creation of the OpenVAS SSL Certificate ------------------------------------------------------------------------------- This script will now ask you the relevant information to create the SSL certificate of OpenVAS."><meta property="article:published_time" content="2013-01-01 00:00:01 +0000 UTC"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>./Sam_Stelfox.sh</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about/>About</a></li><li><a href=/notes/>Notes</a></li><li><a href=/blog/>Posts</a></li></ul></nav><span class=menu-trigger><svg viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://stelfox.net/notes/openvas/>OpenVAS</a></h2><div class=post-content><p><em><strong>Note: This page is quite old and is likely out of date. My opinions may have
also changed dramatically since this was written. It is here as a reference
until I get around to updating it.</strong></em></p><h2 id=setup>Setup</h2><p>Install the packages <code>nikto</code>, <code>openvas-scanner</code>, <code>openvas-manager</code>, and
<code>openvas-client</code>.</p><h2 id=scanner>Scanner</h2><p>As root run openvas-mkcert like the following:</p><pre tabindex=0><code>[root@localhost ~]# openvas-mkcert
-------------------------------------------------------------------------------
                        Creation of the OpenVAS SSL Certificate
-------------------------------------------------------------------------------

This script will now ask you the relevant information to create the SSL certificate of OpenVAS.
Note that this information will *NOT* be sent to anybody (everything stays local), but anyone with the ability to connect to your OpenVAS daemon will be able to retrieve this information.

CA certificate life time in days [1460]: 3650
Server certificate life time in days [365]: 
Your country (two letter code) [DE]: US
Your state or province name [none]: Some State
Your location (e.g. town) [Berlin]: Some City
Your organization [OpenVAS Users United]: Example.net

-------------------------------------------------------------------------------
                        Creation of the OpenVAS SSL Certificate
-------------------------------------------------------------------------------

Congratulations. Your server certificate was properly created.

The following files were created:

Certification authority:
   Certificate = /etc/pki/openvas/CA/cacert.pem
   Private key = /etc/pki/openvas/private/CA/cakey.pem

OpenVAS Server :
    Certificate = /etc/pki/openvas/CA/servercert.pem
    Private key = /etc/pki/openvas/private/CA/serverkey.pem

Press [ENTER] to exit

[root@localhost ~]#
</code></pre><p>As root get the NVT feed by running the command <code>openvas-nvt-sync</code>.</p><p>Create a certificate for the OpenVAS-Manager to connect to the scanner like so:</p><pre tabindex=0><code>[root@localhost ~]# openvas-mkcert-client -i
This script will now ask you the relevant information to create the SSL client certificates for OpenVAS.

Client certificates life time in days [365]: 3650
Your country (two letter code) [DE]: US
Your state or province name [none]: Some State
Your location (e.g. town) [Berlin]: Some City
Your organization [OpenVAS Users United]: Example.net
Your organizational unit [none]: 

**********
We are going to ask you some question for each client certificate. 

If some question has a default answer, you can force an empty answer by entering a single dot &#39;.&#39;

*********
OpenVAS username for the new user: om
Client certificates life time in days [3650]: 
Your country (two letter code) [DE]: US
Your state or province name [none]: Some State
Your location (e.g. town) [Berlin]: Some City
Your organization [OpenVAS Users United]: Example.net
Organization unit []: 
e-Mail []: 
Generating RSA private key, 1024 bit long modulus
...................................++++++
.................................................++++++
e is 65537 (0x10001)
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter &#39;.&#39;, the field will be left blank.
-----
Country Name (2 letter code) [DE]:
State or Province Name (full name) [Some-State]:
Locality Name (eg, city) []:
Organization Name (eg, company) [Internet Widgits Pty Ltd]:
Organizational Unit Name (eg, section) []:
Common Name (eg, your name or your server&#39;s hostname) []:
Email Address []:
Using configuration from /tmp/openvas-mkcert-client.26805/stdC.cnf
Check that the request matches the signature
Signature ok
The Subject&#39;s Distinguished Name is as follows
countryName           :PRINTABLE:&#39;US&#39;
stateOrProvinceName   :PRINTABLE:&#39;Some State&#39;
localityName          :PRINTABLE:&#39;Some City&#39;
organizationName      :PRINTABLE:&#39;Example.net&#39;
commonName            :PRINTABLE:&#39;om&#39;
Certificate is to be certified until Aug 20 17:24:00 2021 GMT (3650 days)

Write out database with 1 new entries
Data Base Updated

User rules

----------
openvassd has a rules system which allows you to restrict the hosts that  has the right to test.
For instance, you may want him to be able to scan his own host only.
Please see the openvas-adduser(8) man page for the rules syntax.
Enter the rules for this user, and hit ctrl-D once you are done:
(the user can have an empty rules set)
User om added to OpenVAS.
[root@localhost ~]#
</code></pre><p>Setup GPG trust of the nvt feed. You'll need to create a GPG key for openvas,
download and verify the transfer integrity key, import & sign the transfer
integrity key and turn on plugin signature checking. This can be done with the
following set of commands:</p><pre tabindex=0><code>[root@localhost ~]# mkdir /etc/openvas/gnupg
[root@localhost ~]# gpg --homedir=/etc/openvas/gnupg --gen-key
gpg: WARNING: unsafe permissions on homedir `/etc/openvas/gnupg&#39;
gpg (GnuPG) 1.4.11; Copyright (C) 2010 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

gpg: keyring `/etc/openvas/gnupg/secring.gpg&#39; created
gpg: keyring `/etc/openvas/gnupg/pubring.gpg&#39; created
Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
Your selection? 1
RSA keys may be between 1024 and 4096 bits long.
What keysize do you want? (2048) 
Requested keysize is 2048 bits
Please specify how long the key should be valid.
         0 = key does not expire
      &lt;n&gt;  = key expires in n days
      &lt;n&gt;w = key expires in n weeks
      &lt;n&gt;m = key expires in n months
      &lt;n&gt;y = key expires in n years
Key is valid for? (0) 
Key does not expire at all
Is this correct? (y/N) y

You need a user ID to identify your key; the software constructs the user ID
from the Real Name, Comment and Email Address in this form:
    &#34;Heinrich Heine (Der Dichter) &lt;heinrichh@duesseldorf.de&gt;&#34;

Real name: OpenVAS Plugin Verifier
Email address: 
Comment: 
You selected this USER-ID:
    &#34;OpenVAS Plugin Verifier&#34;

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? o
You need a Passphrase to protect your secret key.

You don&#39;t want a passphrase - this is probably a *bad* idea!
I will do it anyway.  You can change your passphrase at any time,
using this program with the option &#34;--edit-key&#34;.

We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
+++++
....+++++
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.

Not enough random bytes available.  Please do some other work to give
the OS a chance to collect more entropy! (Need 67 more bytes)
....+++++
.+++++
gpg: /etc/openvas/gnupg/trustdb.gpg: trustdb created
gpg: key ######## marked as ultimately trusted
public and secret key created and signed.

gpg: checking the trustdb
gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model
gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u
pub   2048R/######## 2011-08-24
      Key fingerprint = #### #### #### #### ####  #### #### #### #### ####
uid                  OpenVAS Plugin Verifier
sub   2048R/######## 2011-08-24

[root@localhost ~]# wget http://www.openvas.org/OpenVAS_TI.asc
--2011-08-23 22:38:34--  http://www.openvas.org/OpenVAS_TI.asc
Resolving www.openvas.org... 78.47.251.62
Connecting to www.openvas.org|78.47.251.62|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1673 (1.6K) [text/plain]
Saving to: “OpenVAS_TI.asc”

100%[==============================================================&gt;] 1,673       --.-K/s   in 0s      

####-##-## ##:##:## (152 MB/s) - “OpenVAS_TI.asc” saved [1673/1673]

[root@localhost ~]# gpg --homedir=/etc/openvas/gnupg --import OpenVAS_TI.asc
gpg: WARNING: unsafe permissions on homedir `/etc/openvas/gnupg&#39;
gpg: key 48DB4530: public key &#34;OpenVAS Transfer Integrity&#34; imported
gpg: Total number processed: 1
gpg:               imported: 1
[root@localhost ~]# gpg --homedir=/etc/openvas/gnupg --lsign-key 48DB4530
gpg: WARNING: unsafe permissions on homedir `/etc/openvas/gnupg&#39;

pub  1024D/48DB4530  created: 2007-11-05  expires: never       usage: SC  
                     trust: unknown       validity: unknown
sub  2048g/70610CFB  created: 2007-11-05  expires: never       usage: E   
[ unknown] (1). OpenVAS Transfer Integrity
pub  1024D/48DB4530  created: 2007-11-05  expires: never       usage: SC  
                     trust: unknown       validity: unknown
 Primary key fingerprint: C3B4 68D2 288C 68B9 D526  4522 4847 9FF6 48DB 4530

     OpenVAS Transfer Integrity

Are you sure that you want to sign this key with your
key &#34;OpenVAS Plugin Verifier&#34; (########)

The signature will be marked as non-exportable.

Really sign? (y/N) y
</code></pre><p>Alright now we need to start up the scanner service for the first time. It will
take a LONG time the first time and a significant amount of time everytime
there are updates to the NVT feed, though not nearly as long for the updates.</p><p>It takes so long that the service script will think that it failed. It HASN'T,
it's still doing it magic in the background, it's easiest to just watch it go
with top. When it finally settles down it'll be ready for the next step.</p><h2 id=openvas-manager>OpenVAS Manager</h2><p>Now we need to build the OpenVAS manager database. I'm not entirely sure what
the manager gets us as right now we have a working scanner (albeit without
users). I know it provides alternative connection methods such as an XML based
API for web services. Hey it might be useful it might not and there is some
funnyness but it's part of the full installation so I'm going to include
directions.</p><p>That touch at the beginning? Yeah if you don't create that file you'll get a
"Aborted (core dumped)" message when you try and rebuild the database. Having
it in existence though allows it to just run smoothly. Pretty big bug if you
ask me but one with an easy work around.</p><pre tabindex=0><code>[root@localhost ~]# touch /var/lib/openvas/mgr/tasks.db
[root@localhost ~]# openvasmd --rebuild
</code></pre><h2 id=openvas-administrator>OpenVAS Administrator</h2><p>This is getting it's own special section as it isn't available via the standard
Fedora package repositories annoyingly enough. For the time being I'm going to
leave this alone.</p><h2 id=creating-users>Creating Users</h2><p>I personally prefer using certificate for authentication against the server.
Easier than typing in a password every time and more secure in some ways. To
create a user that authenticates with a certificate you need to use the
<code>openvas-mkcert-client</code> command like so:</p><pre tabindex=0><code>[root@localhost ~]# openvas-mkcert-client
This script will now ask you the relevant information to create the SSL client certificates for OpenVAS.

Client certificates life time in days [365]:
Your country (two letter code) [DE]: US
Your state or province name [none]: Some State
Your location (e.g. town) [Berlin]: Some City
Your organization [none]: Example.net
Your organizational unit [none]:
**********
We are going to ask you some question for each client certificate.

If some question has a default answer, you can force an empty answer by entering a single dot &#39;.&#39;

*********
OpenVAS username for the new user: &lt;username&gt;
Client certificates life time in days [365]:
Country (two letter code) [US]:
State or province name [Some State]:
Location (e.g. town) [Some City]:
Organization [Example.net]:
Organization unit []:
e-Mail []:
Generating RSA private key, 1024 bit long modulus
....++++++
............................................++++++
e is 65537 (0x10001)
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter &#39;.&#39;, the field will be left blank.
-----
Country Name (2 letter code) [DE]:
State or Province Name (full name) [Some-State]:
Locality Name (eg, city) []:
Organization Name (eg, company) [Internet Widgits Pty Ltd]:
Organizational Unit Name (eg, section) []:
Common Name (eg, your name or your server&#39;s hostname) []:
Email Address []:
Using configuration from /tmp/openvas-mkcert-client.15980/stdC.cnf
Check that the request matches the signature
Signature ok
The Subject&#39;s Distinguished Name is as follows
countryName           :PRINTABLE:&#39;US&#39;
stateOrProvinceName   :PRINTABLE:&#39;Some State&#39;
localityName          :PRINTABLE:&#39;Some City&#39;
organizationName      :PRINTABLE:&#39;Example.net&#39;
commonName            :PRINTABLE:&#39;&lt;username&gt;&#39;
Certificate is to be certified until Aug 23 18:10:38 2012 GMT (365 days)

Write out database with 1 new entries
Data Base Updated

User rules

----------
openvassd has a rules system which allows you to restrict the hosts that  has the right to test.
For instance, you may want him to be able to scan his own host only.
Please see the openvas-adduser(8) man page for the rules syntax.
Enter the rules for this user, and hit ctrl-D once you are done:
(the user can have an empty rules set)
User sstelfox added to OpenVAS.
Your client certificates are in /tmp/openvas-mkcert-client.15980 .
You will have to copy them by hand.
[root@localhost ~]# chown -R &lt;username&gt;:&lt;username&gt; /tmp/openvas-mkcert-client.15980/
[root@localhost ~]# mv /tmp/openvas-mkcert-client.15980/ /home/&lt;username&gt;/
[root@localhost ~]# cp /etc/pki/openvas/CA/cacert.pem /home/&lt;username&gt;/openvas-mkcert-client.15980/
</code></pre><h2 id=verification>Verification</h2><p>Save the following script and make it executable.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>  1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>  2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3>  3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4>  4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5>  5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6>  6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7>  7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8>  8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9>  9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10> 10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11> 11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12> 12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13> 13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14> 14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15> 15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16> 16</a>
</span><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17> 17</a>
</span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18> 18</a>
</span><span class=lnt id=hl-5-19><a class=lnlinks href=#hl-5-19> 19</a>
</span><span class=lnt id=hl-5-20><a class=lnlinks href=#hl-5-20> 20</a>
</span><span class=lnt id=hl-5-21><a class=lnlinks href=#hl-5-21> 21</a>
</span><span class=lnt id=hl-5-22><a class=lnlinks href=#hl-5-22> 22</a>
</span><span class=lnt id=hl-5-23><a class=lnlinks href=#hl-5-23> 23</a>
</span><span class=lnt id=hl-5-24><a class=lnlinks href=#hl-5-24> 24</a>
</span><span class=lnt id=hl-5-25><a class=lnlinks href=#hl-5-25> 25</a>
</span><span class=lnt id=hl-5-26><a class=lnlinks href=#hl-5-26> 26</a>
</span><span class=lnt id=hl-5-27><a class=lnlinks href=#hl-5-27> 27</a>
</span><span class=lnt id=hl-5-28><a class=lnlinks href=#hl-5-28> 28</a>
</span><span class=lnt id=hl-5-29><a class=lnlinks href=#hl-5-29> 29</a>
</span><span class=lnt id=hl-5-30><a class=lnlinks href=#hl-5-30> 30</a>
</span><span class=lnt id=hl-5-31><a class=lnlinks href=#hl-5-31> 31</a>
</span><span class=lnt id=hl-5-32><a class=lnlinks href=#hl-5-32> 32</a>
</span><span class=lnt id=hl-5-33><a class=lnlinks href=#hl-5-33> 33</a>
</span><span class=lnt id=hl-5-34><a class=lnlinks href=#hl-5-34> 34</a>
</span><span class=lnt id=hl-5-35><a class=lnlinks href=#hl-5-35> 35</a>
</span><span class=lnt id=hl-5-36><a class=lnlinks href=#hl-5-36> 36</a>
</span><span class=lnt id=hl-5-37><a class=lnlinks href=#hl-5-37> 37</a>
</span><span class=lnt id=hl-5-38><a class=lnlinks href=#hl-5-38> 38</a>
</span><span class=lnt id=hl-5-39><a class=lnlinks href=#hl-5-39> 39</a>
</span><span class=lnt id=hl-5-40><a class=lnlinks href=#hl-5-40> 40</a>
</span><span class=lnt id=hl-5-41><a class=lnlinks href=#hl-5-41> 41</a>
</span><span class=lnt id=hl-5-42><a class=lnlinks href=#hl-5-42> 42</a>
</span><span class=lnt id=hl-5-43><a class=lnlinks href=#hl-5-43> 43</a>
</span><span class=lnt id=hl-5-44><a class=lnlinks href=#hl-5-44> 44</a>
</span><span class=lnt id=hl-5-45><a class=lnlinks href=#hl-5-45> 45</a>
</span><span class=lnt id=hl-5-46><a class=lnlinks href=#hl-5-46> 46</a>
</span><span class=lnt id=hl-5-47><a class=lnlinks href=#hl-5-47> 47</a>
</span><span class=lnt id=hl-5-48><a class=lnlinks href=#hl-5-48> 48</a>
</span><span class=lnt id=hl-5-49><a class=lnlinks href=#hl-5-49> 49</a>
</span><span class=lnt id=hl-5-50><a class=lnlinks href=#hl-5-50> 50</a>
</span><span class=lnt id=hl-5-51><a class=lnlinks href=#hl-5-51> 51</a>
</span><span class=lnt id=hl-5-52><a class=lnlinks href=#hl-5-52> 52</a>
</span><span class=lnt id=hl-5-53><a class=lnlinks href=#hl-5-53> 53</a>
</span><span class=lnt id=hl-5-54><a class=lnlinks href=#hl-5-54> 54</a>
</span><span class=lnt id=hl-5-55><a class=lnlinks href=#hl-5-55> 55</a>
</span><span class=lnt id=hl-5-56><a class=lnlinks href=#hl-5-56> 56</a>
</span><span class=lnt id=hl-5-57><a class=lnlinks href=#hl-5-57> 57</a>
</span><span class=lnt id=hl-5-58><a class=lnlinks href=#hl-5-58> 58</a>
</span><span class=lnt id=hl-5-59><a class=lnlinks href=#hl-5-59> 59</a>
</span><span class=lnt id=hl-5-60><a class=lnlinks href=#hl-5-60> 60</a>
</span><span class=lnt id=hl-5-61><a class=lnlinks href=#hl-5-61> 61</a>
</span><span class=lnt id=hl-5-62><a class=lnlinks href=#hl-5-62> 62</a>
</span><span class=lnt id=hl-5-63><a class=lnlinks href=#hl-5-63> 63</a>
</span><span class=lnt id=hl-5-64><a class=lnlinks href=#hl-5-64> 64</a>
</span><span class=lnt id=hl-5-65><a class=lnlinks href=#hl-5-65> 65</a>
</span><span class=lnt id=hl-5-66><a class=lnlinks href=#hl-5-66> 66</a>
</span><span class=lnt id=hl-5-67><a class=lnlinks href=#hl-5-67> 67</a>
</span><span class=lnt id=hl-5-68><a class=lnlinks href=#hl-5-68> 68</a>
</span><span class=lnt id=hl-5-69><a class=lnlinks href=#hl-5-69> 69</a>
</span><span class=lnt id=hl-5-70><a class=lnlinks href=#hl-5-70> 70</a>
</span><span class=lnt id=hl-5-71><a class=lnlinks href=#hl-5-71> 71</a>
</span><span class=lnt id=hl-5-72><a class=lnlinks href=#hl-5-72> 72</a>
</span><span class=lnt id=hl-5-73><a class=lnlinks href=#hl-5-73> 73</a>
</span><span class=lnt id=hl-5-74><a class=lnlinks href=#hl-5-74> 74</a>
</span><span class=lnt id=hl-5-75><a class=lnlinks href=#hl-5-75> 75</a>
</span><span class=lnt id=hl-5-76><a class=lnlinks href=#hl-5-76> 76</a>
</span><span class=lnt id=hl-5-77><a class=lnlinks href=#hl-5-77> 77</a>
</span><span class=lnt id=hl-5-78><a class=lnlinks href=#hl-5-78> 78</a>
</span><span class=lnt id=hl-5-79><a class=lnlinks href=#hl-5-79> 79</a>
</span><span class=lnt id=hl-5-80><a class=lnlinks href=#hl-5-80> 80</a>
</span><span class=lnt id=hl-5-81><a class=lnlinks href=#hl-5-81> 81</a>
</span><span class=lnt id=hl-5-82><a class=lnlinks href=#hl-5-82> 82</a>
</span><span class=lnt id=hl-5-83><a class=lnlinks href=#hl-5-83> 83</a>
</span><span class=lnt id=hl-5-84><a class=lnlinks href=#hl-5-84> 84</a>
</span><span class=lnt id=hl-5-85><a class=lnlinks href=#hl-5-85> 85</a>
</span><span class=lnt id=hl-5-86><a class=lnlinks href=#hl-5-86> 86</a>
</span><span class=lnt id=hl-5-87><a class=lnlinks href=#hl-5-87> 87</a>
</span><span class=lnt id=hl-5-88><a class=lnlinks href=#hl-5-88> 88</a>
</span><span class=lnt id=hl-5-89><a class=lnlinks href=#hl-5-89> 89</a>
</span><span class=lnt id=hl-5-90><a class=lnlinks href=#hl-5-90> 90</a>
</span><span class=lnt id=hl-5-91><a class=lnlinks href=#hl-5-91> 91</a>
</span><span class=lnt id=hl-5-92><a class=lnlinks href=#hl-5-92> 92</a>
</span><span class=lnt id=hl-5-93><a class=lnlinks href=#hl-5-93> 93</a>
</span><span class=lnt id=hl-5-94><a class=lnlinks href=#hl-5-94> 94</a>
</span><span class=lnt id=hl-5-95><a class=lnlinks href=#hl-5-95> 95</a>
</span><span class=lnt id=hl-5-96><a class=lnlinks href=#hl-5-96> 96</a>
</span><span class=lnt id=hl-5-97><a class=lnlinks href=#hl-5-97> 97</a>
</span><span class=lnt id=hl-5-98><a class=lnlinks href=#hl-5-98> 98</a>
</span><span class=lnt id=hl-5-99><a class=lnlinks href=#hl-5-99> 99</a>
</span><span class=lnt id=hl-5-100><a class=lnlinks href=#hl-5-100>100</a>
</span><span class=lnt id=hl-5-101><a class=lnlinks href=#hl-5-101>101</a>
</span><span class=lnt id=hl-5-102><a class=lnlinks href=#hl-5-102>102</a>
</span><span class=lnt id=hl-5-103><a class=lnlinks href=#hl-5-103>103</a>
</span><span class=lnt id=hl-5-104><a class=lnlinks href=#hl-5-104>104</a>
</span><span class=lnt id=hl-5-105><a class=lnlinks href=#hl-5-105>105</a>
</span><span class=lnt id=hl-5-106><a class=lnlinks href=#hl-5-106>106</a>
</span><span class=lnt id=hl-5-107><a class=lnlinks href=#hl-5-107>107</a>
</span><span class=lnt id=hl-5-108><a class=lnlinks href=#hl-5-108>108</a>
</span><span class=lnt id=hl-5-109><a class=lnlinks href=#hl-5-109>109</a>
</span><span class=lnt id=hl-5-110><a class=lnlinks href=#hl-5-110>110</a>
</span><span class=lnt id=hl-5-111><a class=lnlinks href=#hl-5-111>111</a>
</span><span class=lnt id=hl-5-112><a class=lnlinks href=#hl-5-112>112</a>
</span><span class=lnt id=hl-5-113><a class=lnlinks href=#hl-5-113>113</a>
</span><span class=lnt id=hl-5-114><a class=lnlinks href=#hl-5-114>114</a>
</span><span class=lnt id=hl-5-115><a class=lnlinks href=#hl-5-115>115</a>
</span><span class=lnt id=hl-5-116><a class=lnlinks href=#hl-5-116>116</a>
</span><span class=lnt id=hl-5-117><a class=lnlinks href=#hl-5-117>117</a>
</span><span class=lnt id=hl-5-118><a class=lnlinks href=#hl-5-118>118</a>
</span><span class=lnt id=hl-5-119><a class=lnlinks href=#hl-5-119>119</a>
</span><span class=lnt id=hl-5-120><a class=lnlinks href=#hl-5-120>120</a>
</span><span class=lnt id=hl-5-121><a class=lnlinks href=#hl-5-121>121</a>
</span><span class=lnt id=hl-5-122><a class=lnlinks href=#hl-5-122>122</a>
</span><span class=lnt id=hl-5-123><a class=lnlinks href=#hl-5-123>123</a>
</span><span class=lnt id=hl-5-124><a class=lnlinks href=#hl-5-124>124</a>
</span><span class=lnt id=hl-5-125><a class=lnlinks href=#hl-5-125>125</a>
</span><span class=lnt id=hl-5-126><a class=lnlinks href=#hl-5-126>126</a>
</span><span class=lnt id=hl-5-127><a class=lnlinks href=#hl-5-127>127</a>
</span><span class=lnt id=hl-5-128><a class=lnlinks href=#hl-5-128>128</a>
</span><span class=lnt id=hl-5-129><a class=lnlinks href=#hl-5-129>129</a>
</span><span class=lnt id=hl-5-130><a class=lnlinks href=#hl-5-130>130</a>
</span><span class=lnt id=hl-5-131><a class=lnlinks href=#hl-5-131>131</a>
</span><span class=lnt id=hl-5-132><a class=lnlinks href=#hl-5-132>132</a>
</span><span class=lnt id=hl-5-133><a class=lnlinks href=#hl-5-133>133</a>
</span><span class=lnt id=hl-5-134><a class=lnlinks href=#hl-5-134>134</a>
</span><span class=lnt id=hl-5-135><a class=lnlinks href=#hl-5-135>135</a>
</span><span class=lnt id=hl-5-136><a class=lnlinks href=#hl-5-136>136</a>
</span><span class=lnt id=hl-5-137><a class=lnlinks href=#hl-5-137>137</a>
</span><span class=lnt id=hl-5-138><a class=lnlinks href=#hl-5-138>138</a>
</span><span class=lnt id=hl-5-139><a class=lnlinks href=#hl-5-139>139</a>
</span><span class=lnt id=hl-5-140><a class=lnlinks href=#hl-5-140>140</a>
</span><span class=lnt id=hl-5-141><a class=lnlinks href=#hl-5-141>141</a>
</span><span class=lnt id=hl-5-142><a class=lnlinks href=#hl-5-142>142</a>
</span><span class=lnt id=hl-5-143><a class=lnlinks href=#hl-5-143>143</a>
</span><span class=lnt id=hl-5-144><a class=lnlinks href=#hl-5-144>144</a>
</span><span class=lnt id=hl-5-145><a class=lnlinks href=#hl-5-145>145</a>
</span><span class=lnt id=hl-5-146><a class=lnlinks href=#hl-5-146>146</a>
</span><span class=lnt id=hl-5-147><a class=lnlinks href=#hl-5-147>147</a>
</span><span class=lnt id=hl-5-148><a class=lnlinks href=#hl-5-148>148</a>
</span><span class=lnt id=hl-5-149><a class=lnlinks href=#hl-5-149>149</a>
</span><span class=lnt id=hl-5-150><a class=lnlinks href=#hl-5-150>150</a>
</span><span class=lnt id=hl-5-151><a class=lnlinks href=#hl-5-151>151</a>
</span><span class=lnt id=hl-5-152><a class=lnlinks href=#hl-5-152>152</a>
</span><span class=lnt id=hl-5-153><a class=lnlinks href=#hl-5-153>153</a>
</span><span class=lnt id=hl-5-154><a class=lnlinks href=#hl-5-154>154</a>
</span><span class=lnt id=hl-5-155><a class=lnlinks href=#hl-5-155>155</a>
</span><span class=lnt id=hl-5-156><a class=lnlinks href=#hl-5-156>156</a>
</span><span class=lnt id=hl-5-157><a class=lnlinks href=#hl-5-157>157</a>
</span><span class=lnt id=hl-5-158><a class=lnlinks href=#hl-5-158>158</a>
</span><span class=lnt id=hl-5-159><a class=lnlinks href=#hl-5-159>159</a>
</span><span class=lnt id=hl-5-160><a class=lnlinks href=#hl-5-160>160</a>
</span><span class=lnt id=hl-5-161><a class=lnlinks href=#hl-5-161>161</a>
</span><span class=lnt id=hl-5-162><a class=lnlinks href=#hl-5-162>162</a>
</span><span class=lnt id=hl-5-163><a class=lnlinks href=#hl-5-163>163</a>
</span><span class=lnt id=hl-5-164><a class=lnlinks href=#hl-5-164>164</a>
</span><span class=lnt id=hl-5-165><a class=lnlinks href=#hl-5-165>165</a>
</span><span class=lnt id=hl-5-166><a class=lnlinks href=#hl-5-166>166</a>
</span><span class=lnt id=hl-5-167><a class=lnlinks href=#hl-5-167>167</a>
</span><span class=lnt id=hl-5-168><a class=lnlinks href=#hl-5-168>168</a>
</span><span class=lnt id=hl-5-169><a class=lnlinks href=#hl-5-169>169</a>
</span><span class=lnt id=hl-5-170><a class=lnlinks href=#hl-5-170>170</a>
</span><span class=lnt id=hl-5-171><a class=lnlinks href=#hl-5-171>171</a>
</span><span class=lnt id=hl-5-172><a class=lnlinks href=#hl-5-172>172</a>
</span><span class=lnt id=hl-5-173><a class=lnlinks href=#hl-5-173>173</a>
</span><span class=lnt id=hl-5-174><a class=lnlinks href=#hl-5-174>174</a>
</span><span class=lnt id=hl-5-175><a class=lnlinks href=#hl-5-175>175</a>
</span><span class=lnt id=hl-5-176><a class=lnlinks href=#hl-5-176>176</a>
</span><span class=lnt id=hl-5-177><a class=lnlinks href=#hl-5-177>177</a>
</span><span class=lnt id=hl-5-178><a class=lnlinks href=#hl-5-178>178</a>
</span><span class=lnt id=hl-5-179><a class=lnlinks href=#hl-5-179>179</a>
</span><span class=lnt id=hl-5-180><a class=lnlinks href=#hl-5-180>180</a>
</span><span class=lnt id=hl-5-181><a class=lnlinks href=#hl-5-181>181</a>
</span><span class=lnt id=hl-5-182><a class=lnlinks href=#hl-5-182>182</a>
</span><span class=lnt id=hl-5-183><a class=lnlinks href=#hl-5-183>183</a>
</span><span class=lnt id=hl-5-184><a class=lnlinks href=#hl-5-184>184</a>
</span><span class=lnt id=hl-5-185><a class=lnlinks href=#hl-5-185>185</a>
</span><span class=lnt id=hl-5-186><a class=lnlinks href=#hl-5-186>186</a>
</span><span class=lnt id=hl-5-187><a class=lnlinks href=#hl-5-187>187</a>
</span><span class=lnt id=hl-5-188><a class=lnlinks href=#hl-5-188>188</a>
</span><span class=lnt id=hl-5-189><a class=lnlinks href=#hl-5-189>189</a>
</span><span class=lnt id=hl-5-190><a class=lnlinks href=#hl-5-190>190</a>
</span><span class=lnt id=hl-5-191><a class=lnlinks href=#hl-5-191>191</a>
</span><span class=lnt id=hl-5-192><a class=lnlinks href=#hl-5-192>192</a>
</span><span class=lnt id=hl-5-193><a class=lnlinks href=#hl-5-193>193</a>
</span><span class=lnt id=hl-5-194><a class=lnlinks href=#hl-5-194>194</a>
</span><span class=lnt id=hl-5-195><a class=lnlinks href=#hl-5-195>195</a>
</span><span class=lnt id=hl-5-196><a class=lnlinks href=#hl-5-196>196</a>
</span><span class=lnt id=hl-5-197><a class=lnlinks href=#hl-5-197>197</a>
</span><span class=lnt id=hl-5-198><a class=lnlinks href=#hl-5-198>198</a>
</span><span class=lnt id=hl-5-199><a class=lnlinks href=#hl-5-199>199</a>
</span><span class=lnt id=hl-5-200><a class=lnlinks href=#hl-5-200>200</a>
</span><span class=lnt id=hl-5-201><a class=lnlinks href=#hl-5-201>201</a>
</span><span class=lnt id=hl-5-202><a class=lnlinks href=#hl-5-202>202</a>
</span><span class=lnt id=hl-5-203><a class=lnlinks href=#hl-5-203>203</a>
</span><span class=lnt id=hl-5-204><a class=lnlinks href=#hl-5-204>204</a>
</span><span class=lnt id=hl-5-205><a class=lnlinks href=#hl-5-205>205</a>
</span><span class=lnt id=hl-5-206><a class=lnlinks href=#hl-5-206>206</a>
</span><span class=lnt id=hl-5-207><a class=lnlinks href=#hl-5-207>207</a>
</span><span class=lnt id=hl-5-208><a class=lnlinks href=#hl-5-208>208</a>
</span><span class=lnt id=hl-5-209><a class=lnlinks href=#hl-5-209>209</a>
</span><span class=lnt id=hl-5-210><a class=lnlinks href=#hl-5-210>210</a>
</span><span class=lnt id=hl-5-211><a class=lnlinks href=#hl-5-211>211</a>
</span><span class=lnt id=hl-5-212><a class=lnlinks href=#hl-5-212>212</a>
</span><span class=lnt id=hl-5-213><a class=lnlinks href=#hl-5-213>213</a>
</span><span class=lnt id=hl-5-214><a class=lnlinks href=#hl-5-214>214</a>
</span><span class=lnt id=hl-5-215><a class=lnlinks href=#hl-5-215>215</a>
</span><span class=lnt id=hl-5-216><a class=lnlinks href=#hl-5-216>216</a>
</span><span class=lnt id=hl-5-217><a class=lnlinks href=#hl-5-217>217</a>
</span><span class=lnt id=hl-5-218><a class=lnlinks href=#hl-5-218>218</a>
</span><span class=lnt id=hl-5-219><a class=lnlinks href=#hl-5-219>219</a>
</span><span class=lnt id=hl-5-220><a class=lnlinks href=#hl-5-220>220</a>
</span><span class=lnt id=hl-5-221><a class=lnlinks href=#hl-5-221>221</a>
</span><span class=lnt id=hl-5-222><a class=lnlinks href=#hl-5-222>222</a>
</span><span class=lnt id=hl-5-223><a class=lnlinks href=#hl-5-223>223</a>
</span><span class=lnt id=hl-5-224><a class=lnlinks href=#hl-5-224>224</a>
</span><span class=lnt id=hl-5-225><a class=lnlinks href=#hl-5-225>225</a>
</span><span class=lnt id=hl-5-226><a class=lnlinks href=#hl-5-226>226</a>
</span><span class=lnt id=hl-5-227><a class=lnlinks href=#hl-5-227>227</a>
</span><span class=lnt id=hl-5-228><a class=lnlinks href=#hl-5-228>228</a>
</span><span class=lnt id=hl-5-229><a class=lnlinks href=#hl-5-229>229</a>
</span><span class=lnt id=hl-5-230><a class=lnlinks href=#hl-5-230>230</a>
</span><span class=lnt id=hl-5-231><a class=lnlinks href=#hl-5-231>231</a>
</span><span class=lnt id=hl-5-232><a class=lnlinks href=#hl-5-232>232</a>
</span><span class=lnt id=hl-5-233><a class=lnlinks href=#hl-5-233>233</a>
</span><span class=lnt id=hl-5-234><a class=lnlinks href=#hl-5-234>234</a>
</span><span class=lnt id=hl-5-235><a class=lnlinks href=#hl-5-235>235</a>
</span><span class=lnt id=hl-5-236><a class=lnlinks href=#hl-5-236>236</a>
</span><span class=lnt id=hl-5-237><a class=lnlinks href=#hl-5-237>237</a>
</span><span class=lnt id=hl-5-238><a class=lnlinks href=#hl-5-238>238</a>
</span><span class=lnt id=hl-5-239><a class=lnlinks href=#hl-5-239>239</a>
</span><span class=lnt id=hl-5-240><a class=lnlinks href=#hl-5-240>240</a>
</span><span class=lnt id=hl-5-241><a class=lnlinks href=#hl-5-241>241</a>
</span><span class=lnt id=hl-5-242><a class=lnlinks href=#hl-5-242>242</a>
</span><span class=lnt id=hl-5-243><a class=lnlinks href=#hl-5-243>243</a>
</span><span class=lnt id=hl-5-244><a class=lnlinks href=#hl-5-244>244</a>
</span><span class=lnt id=hl-5-245><a class=lnlinks href=#hl-5-245>245</a>
</span><span class=lnt id=hl-5-246><a class=lnlinks href=#hl-5-246>246</a>
</span><span class=lnt id=hl-5-247><a class=lnlinks href=#hl-5-247>247</a>
</span><span class=lnt id=hl-5-248><a class=lnlinks href=#hl-5-248>248</a>
</span><span class=lnt id=hl-5-249><a class=lnlinks href=#hl-5-249>249</a>
</span><span class=lnt id=hl-5-250><a class=lnlinks href=#hl-5-250>250</a>
</span><span class=lnt id=hl-5-251><a class=lnlinks href=#hl-5-251>251</a>
</span><span class=lnt id=hl-5-252><a class=lnlinks href=#hl-5-252>252</a>
</span><span class=lnt id=hl-5-253><a class=lnlinks href=#hl-5-253>253</a>
</span><span class=lnt id=hl-5-254><a class=lnlinks href=#hl-5-254>254</a>
</span><span class=lnt id=hl-5-255><a class=lnlinks href=#hl-5-255>255</a>
</span><span class=lnt id=hl-5-256><a class=lnlinks href=#hl-5-256>256</a>
</span><span class=lnt id=hl-5-257><a class=lnlinks href=#hl-5-257>257</a>
</span><span class=lnt id=hl-5-258><a class=lnlinks href=#hl-5-258>258</a>
</span><span class=lnt id=hl-5-259><a class=lnlinks href=#hl-5-259>259</a>
</span><span class=lnt id=hl-5-260><a class=lnlinks href=#hl-5-260>260</a>
</span><span class=lnt id=hl-5-261><a class=lnlinks href=#hl-5-261>261</a>
</span><span class=lnt id=hl-5-262><a class=lnlinks href=#hl-5-262>262</a>
</span><span class=lnt id=hl-5-263><a class=lnlinks href=#hl-5-263>263</a>
</span><span class=lnt id=hl-5-264><a class=lnlinks href=#hl-5-264>264</a>
</span><span class=lnt id=hl-5-265><a class=lnlinks href=#hl-5-265>265</a>
</span><span class=lnt id=hl-5-266><a class=lnlinks href=#hl-5-266>266</a>
</span><span class=lnt id=hl-5-267><a class=lnlinks href=#hl-5-267>267</a>
</span><span class=lnt id=hl-5-268><a class=lnlinks href=#hl-5-268>268</a>
</span><span class=lnt id=hl-5-269><a class=lnlinks href=#hl-5-269>269</a>
</span><span class=lnt id=hl-5-270><a class=lnlinks href=#hl-5-270>270</a>
</span><span class=lnt id=hl-5-271><a class=lnlinks href=#hl-5-271>271</a>
</span><span class=lnt id=hl-5-272><a class=lnlinks href=#hl-5-272>272</a>
</span><span class=lnt id=hl-5-273><a class=lnlinks href=#hl-5-273>273</a>
</span><span class=lnt id=hl-5-274><a class=lnlinks href=#hl-5-274>274</a>
</span><span class=lnt id=hl-5-275><a class=lnlinks href=#hl-5-275>275</a>
</span><span class=lnt id=hl-5-276><a class=lnlinks href=#hl-5-276>276</a>
</span><span class=lnt id=hl-5-277><a class=lnlinks href=#hl-5-277>277</a>
</span><span class=lnt id=hl-5-278><a class=lnlinks href=#hl-5-278>278</a>
</span><span class=lnt id=hl-5-279><a class=lnlinks href=#hl-5-279>279</a>
</span><span class=lnt id=hl-5-280><a class=lnlinks href=#hl-5-280>280</a>
</span><span class=lnt id=hl-5-281><a class=lnlinks href=#hl-5-281>281</a>
</span><span class=lnt id=hl-5-282><a class=lnlinks href=#hl-5-282>282</a>
</span><span class=lnt id=hl-5-283><a class=lnlinks href=#hl-5-283>283</a>
</span><span class=lnt id=hl-5-284><a class=lnlinks href=#hl-5-284>284</a>
</span><span class=lnt id=hl-5-285><a class=lnlinks href=#hl-5-285>285</a>
</span><span class=lnt id=hl-5-286><a class=lnlinks href=#hl-5-286>286</a>
</span><span class=lnt id=hl-5-287><a class=lnlinks href=#hl-5-287>287</a>
</span><span class=lnt id=hl-5-288><a class=lnlinks href=#hl-5-288>288</a>
</span><span class=lnt id=hl-5-289><a class=lnlinks href=#hl-5-289>289</a>
</span><span class=lnt id=hl-5-290><a class=lnlinks href=#hl-5-290>290</a>
</span><span class=lnt id=hl-5-291><a class=lnlinks href=#hl-5-291>291</a>
</span><span class=lnt id=hl-5-292><a class=lnlinks href=#hl-5-292>292</a>
</span><span class=lnt id=hl-5-293><a class=lnlinks href=#hl-5-293>293</a>
</span><span class=lnt id=hl-5-294><a class=lnlinks href=#hl-5-294>294</a>
</span><span class=lnt id=hl-5-295><a class=lnlinks href=#hl-5-295>295</a>
</span><span class=lnt id=hl-5-296><a class=lnlinks href=#hl-5-296>296</a>
</span><span class=lnt id=hl-5-297><a class=lnlinks href=#hl-5-297>297</a>
</span><span class=lnt id=hl-5-298><a class=lnlinks href=#hl-5-298>298</a>
</span><span class=lnt id=hl-5-299><a class=lnlinks href=#hl-5-299>299</a>
</span><span class=lnt id=hl-5-300><a class=lnlinks href=#hl-5-300>300</a>
</span><span class=lnt id=hl-5-301><a class=lnlinks href=#hl-5-301>301</a>
</span><span class=lnt id=hl-5-302><a class=lnlinks href=#hl-5-302>302</a>
</span><span class=lnt id=hl-5-303><a class=lnlinks href=#hl-5-303>303</a>
</span><span class=lnt id=hl-5-304><a class=lnlinks href=#hl-5-304>304</a>
</span><span class=lnt id=hl-5-305><a class=lnlinks href=#hl-5-305>305</a>
</span><span class=lnt id=hl-5-306><a class=lnlinks href=#hl-5-306>306</a>
</span><span class=lnt id=hl-5-307><a class=lnlinks href=#hl-5-307>307</a>
</span><span class=lnt id=hl-5-308><a class=lnlinks href=#hl-5-308>308</a>
</span><span class=lnt id=hl-5-309><a class=lnlinks href=#hl-5-309>309</a>
</span><span class=lnt id=hl-5-310><a class=lnlinks href=#hl-5-310>310</a>
</span><span class=lnt id=hl-5-311><a class=lnlinks href=#hl-5-311>311</a>
</span><span class=lnt id=hl-5-312><a class=lnlinks href=#hl-5-312>312</a>
</span><span class=lnt id=hl-5-313><a class=lnlinks href=#hl-5-313>313</a>
</span><span class=lnt id=hl-5-314><a class=lnlinks href=#hl-5-314>314</a>
</span><span class=lnt id=hl-5-315><a class=lnlinks href=#hl-5-315>315</a>
</span><span class=lnt id=hl-5-316><a class=lnlinks href=#hl-5-316>316</a>
</span><span class=lnt id=hl-5-317><a class=lnlinks href=#hl-5-317>317</a>
</span><span class=lnt id=hl-5-318><a class=lnlinks href=#hl-5-318>318</a>
</span><span class=lnt id=hl-5-319><a class=lnlinks href=#hl-5-319>319</a>
</span><span class=lnt id=hl-5-320><a class=lnlinks href=#hl-5-320>320</a>
</span><span class=lnt id=hl-5-321><a class=lnlinks href=#hl-5-321>321</a>
</span><span class=lnt id=hl-5-322><a class=lnlinks href=#hl-5-322>322</a>
</span><span class=lnt id=hl-5-323><a class=lnlinks href=#hl-5-323>323</a>
</span><span class=lnt id=hl-5-324><a class=lnlinks href=#hl-5-324>324</a>
</span><span class=lnt id=hl-5-325><a class=lnlinks href=#hl-5-325>325</a>
</span><span class=lnt id=hl-5-326><a class=lnlinks href=#hl-5-326>326</a>
</span><span class=lnt id=hl-5-327><a class=lnlinks href=#hl-5-327>327</a>
</span><span class=lnt id=hl-5-328><a class=lnlinks href=#hl-5-328>328</a>
</span><span class=lnt id=hl-5-329><a class=lnlinks href=#hl-5-329>329</a>
</span><span class=lnt id=hl-5-330><a class=lnlinks href=#hl-5-330>330</a>
</span><span class=lnt id=hl-5-331><a class=lnlinks href=#hl-5-331>331</a>
</span><span class=lnt id=hl-5-332><a class=lnlinks href=#hl-5-332>332</a>
</span><span class=lnt id=hl-5-333><a class=lnlinks href=#hl-5-333>333</a>
</span><span class=lnt id=hl-5-334><a class=lnlinks href=#hl-5-334>334</a>
</span><span class=lnt id=hl-5-335><a class=lnlinks href=#hl-5-335>335</a>
</span><span class=lnt id=hl-5-336><a class=lnlinks href=#hl-5-336>336</a>
</span><span class=lnt id=hl-5-337><a class=lnlinks href=#hl-5-337>337</a>
</span><span class=lnt id=hl-5-338><a class=lnlinks href=#hl-5-338>338</a>
</span><span class=lnt id=hl-5-339><a class=lnlinks href=#hl-5-339>339</a>
</span><span class=lnt id=hl-5-340><a class=lnlinks href=#hl-5-340>340</a>
</span><span class=lnt id=hl-5-341><a class=lnlinks href=#hl-5-341>341</a>
</span><span class=lnt id=hl-5-342><a class=lnlinks href=#hl-5-342>342</a>
</span><span class=lnt id=hl-5-343><a class=lnlinks href=#hl-5-343>343</a>
</span><span class=lnt id=hl-5-344><a class=lnlinks href=#hl-5-344>344</a>
</span><span class=lnt id=hl-5-345><a class=lnlinks href=#hl-5-345>345</a>
</span><span class=lnt id=hl-5-346><a class=lnlinks href=#hl-5-346>346</a>
</span><span class=lnt id=hl-5-347><a class=lnlinks href=#hl-5-347>347</a>
</span><span class=lnt id=hl-5-348><a class=lnlinks href=#hl-5-348>348</a>
</span><span class=lnt id=hl-5-349><a class=lnlinks href=#hl-5-349>349</a>
</span><span class=lnt id=hl-5-350><a class=lnlinks href=#hl-5-350>350</a>
</span><span class=lnt id=hl-5-351><a class=lnlinks href=#hl-5-351>351</a>
</span><span class=lnt id=hl-5-352><a class=lnlinks href=#hl-5-352>352</a>
</span><span class=lnt id=hl-5-353><a class=lnlinks href=#hl-5-353>353</a>
</span><span class=lnt id=hl-5-354><a class=lnlinks href=#hl-5-354>354</a>
</span><span class=lnt id=hl-5-355><a class=lnlinks href=#hl-5-355>355</a>
</span><span class=lnt id=hl-5-356><a class=lnlinks href=#hl-5-356>356</a>
</span><span class=lnt id=hl-5-357><a class=lnlinks href=#hl-5-357>357</a>
</span><span class=lnt id=hl-5-358><a class=lnlinks href=#hl-5-358>358</a>
</span><span class=lnt id=hl-5-359><a class=lnlinks href=#hl-5-359>359</a>
</span><span class=lnt id=hl-5-360><a class=lnlinks href=#hl-5-360>360</a>
</span><span class=lnt id=hl-5-361><a class=lnlinks href=#hl-5-361>361</a>
</span><span class=lnt id=hl-5-362><a class=lnlinks href=#hl-5-362>362</a>
</span><span class=lnt id=hl-5-363><a class=lnlinks href=#hl-5-363>363</a>
</span><span class=lnt id=hl-5-364><a class=lnlinks href=#hl-5-364>364</a>
</span><span class=lnt id=hl-5-365><a class=lnlinks href=#hl-5-365>365</a>
</span><span class=lnt id=hl-5-366><a class=lnlinks href=#hl-5-366>366</a>
</span><span class=lnt id=hl-5-367><a class=lnlinks href=#hl-5-367>367</a>
</span><span class=lnt id=hl-5-368><a class=lnlinks href=#hl-5-368>368</a>
</span><span class=lnt id=hl-5-369><a class=lnlinks href=#hl-5-369>369</a>
</span><span class=lnt id=hl-5-370><a class=lnlinks href=#hl-5-370>370</a>
</span><span class=lnt id=hl-5-371><a class=lnlinks href=#hl-5-371>371</a>
</span><span class=lnt id=hl-5-372><a class=lnlinks href=#hl-5-372>372</a>
</span><span class=lnt id=hl-5-373><a class=lnlinks href=#hl-5-373>373</a>
</span><span class=lnt id=hl-5-374><a class=lnlinks href=#hl-5-374>374</a>
</span><span class=lnt id=hl-5-375><a class=lnlinks href=#hl-5-375>375</a>
</span><span class=lnt id=hl-5-376><a class=lnlinks href=#hl-5-376>376</a>
</span><span class=lnt id=hl-5-377><a class=lnlinks href=#hl-5-377>377</a>
</span><span class=lnt id=hl-5-378><a class=lnlinks href=#hl-5-378>378</a>
</span><span class=lnt id=hl-5-379><a class=lnlinks href=#hl-5-379>379</a>
</span><span class=lnt id=hl-5-380><a class=lnlinks href=#hl-5-380>380</a>
</span><span class=lnt id=hl-5-381><a class=lnlinks href=#hl-5-381>381</a>
</span><span class=lnt id=hl-5-382><a class=lnlinks href=#hl-5-382>382</a>
</span><span class=lnt id=hl-5-383><a class=lnlinks href=#hl-5-383>383</a>
</span><span class=lnt id=hl-5-384><a class=lnlinks href=#hl-5-384>384</a>
</span><span class=lnt id=hl-5-385><a class=lnlinks href=#hl-5-385>385</a>
</span><span class=lnt id=hl-5-386><a class=lnlinks href=#hl-5-386>386</a>
</span><span class=lnt id=hl-5-387><a class=lnlinks href=#hl-5-387>387</a>
</span><span class=lnt id=hl-5-388><a class=lnlinks href=#hl-5-388>388</a>
</span><span class=lnt id=hl-5-389><a class=lnlinks href=#hl-5-389>389</a>
</span><span class=lnt id=hl-5-390><a class=lnlinks href=#hl-5-390>390</a>
</span><span class=lnt id=hl-5-391><a class=lnlinks href=#hl-5-391>391</a>
</span><span class=lnt id=hl-5-392><a class=lnlinks href=#hl-5-392>392</a>
</span><span class=lnt id=hl-5-393><a class=lnlinks href=#hl-5-393>393</a>
</span><span class=lnt id=hl-5-394><a class=lnlinks href=#hl-5-394>394</a>
</span><span class=lnt id=hl-5-395><a class=lnlinks href=#hl-5-395>395</a>
</span><span class=lnt id=hl-5-396><a class=lnlinks href=#hl-5-396>396</a>
</span><span class=lnt id=hl-5-397><a class=lnlinks href=#hl-5-397>397</a>
</span><span class=lnt id=hl-5-398><a class=lnlinks href=#hl-5-398>398</a>
</span><span class=lnt id=hl-5-399><a class=lnlinks href=#hl-5-399>399</a>
</span><span class=lnt id=hl-5-400><a class=lnlinks href=#hl-5-400>400</a>
</span><span class=lnt id=hl-5-401><a class=lnlinks href=#hl-5-401>401</a>
</span><span class=lnt id=hl-5-402><a class=lnlinks href=#hl-5-402>402</a>
</span><span class=lnt id=hl-5-403><a class=lnlinks href=#hl-5-403>403</a>
</span><span class=lnt id=hl-5-404><a class=lnlinks href=#hl-5-404>404</a>
</span><span class=lnt id=hl-5-405><a class=lnlinks href=#hl-5-405>405</a>
</span><span class=lnt id=hl-5-406><a class=lnlinks href=#hl-5-406>406</a>
</span><span class=lnt id=hl-5-407><a class=lnlinks href=#hl-5-407>407</a>
</span><span class=lnt id=hl-5-408><a class=lnlinks href=#hl-5-408>408</a>
</span><span class=lnt id=hl-5-409><a class=lnlinks href=#hl-5-409>409</a>
</span><span class=lnt id=hl-5-410><a class=lnlinks href=#hl-5-410>410</a>
</span><span class=lnt id=hl-5-411><a class=lnlinks href=#hl-5-411>411</a>
</span><span class=lnt id=hl-5-412><a class=lnlinks href=#hl-5-412>412</a>
</span><span class=lnt id=hl-5-413><a class=lnlinks href=#hl-5-413>413</a>
</span><span class=lnt id=hl-5-414><a class=lnlinks href=#hl-5-414>414</a>
</span><span class=lnt id=hl-5-415><a class=lnlinks href=#hl-5-415>415</a>
</span><span class=lnt id=hl-5-416><a class=lnlinks href=#hl-5-416>416</a>
</span><span class=lnt id=hl-5-417><a class=lnlinks href=#hl-5-417>417</a>
</span><span class=lnt id=hl-5-418><a class=lnlinks href=#hl-5-418>418</a>
</span><span class=lnt id=hl-5-419><a class=lnlinks href=#hl-5-419>419</a>
</span><span class=lnt id=hl-5-420><a class=lnlinks href=#hl-5-420>420</a>
</span><span class=lnt id=hl-5-421><a class=lnlinks href=#hl-5-421>421</a>
</span><span class=lnt id=hl-5-422><a class=lnlinks href=#hl-5-422>422</a>
</span><span class=lnt id=hl-5-423><a class=lnlinks href=#hl-5-423>423</a>
</span><span class=lnt id=hl-5-424><a class=lnlinks href=#hl-5-424>424</a>
</span><span class=lnt id=hl-5-425><a class=lnlinks href=#hl-5-425>425</a>
</span><span class=lnt id=hl-5-426><a class=lnlinks href=#hl-5-426>426</a>
</span><span class=lnt id=hl-5-427><a class=lnlinks href=#hl-5-427>427</a>
</span><span class=lnt id=hl-5-428><a class=lnlinks href=#hl-5-428>428</a>
</span><span class=lnt id=hl-5-429><a class=lnlinks href=#hl-5-429>429</a>
</span><span class=lnt id=hl-5-430><a class=lnlinks href=#hl-5-430>430</a>
</span><span class=lnt id=hl-5-431><a class=lnlinks href=#hl-5-431>431</a>
</span><span class=lnt id=hl-5-432><a class=lnlinks href=#hl-5-432>432</a>
</span><span class=lnt id=hl-5-433><a class=lnlinks href=#hl-5-433>433</a>
</span><span class=lnt id=hl-5-434><a class=lnlinks href=#hl-5-434>434</a>
</span><span class=lnt id=hl-5-435><a class=lnlinks href=#hl-5-435>435</a>
</span><span class=lnt id=hl-5-436><a class=lnlinks href=#hl-5-436>436</a>
</span><span class=lnt id=hl-5-437><a class=lnlinks href=#hl-5-437>437</a>
</span><span class=lnt id=hl-5-438><a class=lnlinks href=#hl-5-438>438</a>
</span><span class=lnt id=hl-5-439><a class=lnlinks href=#hl-5-439>439</a>
</span><span class=lnt id=hl-5-440><a class=lnlinks href=#hl-5-440>440</a>
</span><span class=lnt id=hl-5-441><a class=lnlinks href=#hl-5-441>441</a>
</span><span class=lnt id=hl-5-442><a class=lnlinks href=#hl-5-442>442</a>
</span><span class=lnt id=hl-5-443><a class=lnlinks href=#hl-5-443>443</a>
</span><span class=lnt id=hl-5-444><a class=lnlinks href=#hl-5-444>444</a>
</span><span class=lnt id=hl-5-445><a class=lnlinks href=#hl-5-445>445</a>
</span><span class=lnt id=hl-5-446><a class=lnlinks href=#hl-5-446>446</a>
</span><span class=lnt id=hl-5-447><a class=lnlinks href=#hl-5-447>447</a>
</span><span class=lnt id=hl-5-448><a class=lnlinks href=#hl-5-448>448</a>
</span><span class=lnt id=hl-5-449><a class=lnlinks href=#hl-5-449>449</a>
</span><span class=lnt id=hl-5-450><a class=lnlinks href=#hl-5-450>450</a>
</span><span class=lnt id=hl-5-451><a class=lnlinks href=#hl-5-451>451</a>
</span><span class=lnt id=hl-5-452><a class=lnlinks href=#hl-5-452>452</a>
</span><span class=lnt id=hl-5-453><a class=lnlinks href=#hl-5-453>453</a>
</span><span class=lnt id=hl-5-454><a class=lnlinks href=#hl-5-454>454</a>
</span><span class=lnt id=hl-5-455><a class=lnlinks href=#hl-5-455>455</a>
</span><span class=lnt id=hl-5-456><a class=lnlinks href=#hl-5-456>456</a>
</span><span class=lnt id=hl-5-457><a class=lnlinks href=#hl-5-457>457</a>
</span><span class=lnt id=hl-5-458><a class=lnlinks href=#hl-5-458>458</a>
</span><span class=lnt id=hl-5-459><a class=lnlinks href=#hl-5-459>459</a>
</span><span class=lnt id=hl-5-460><a class=lnlinks href=#hl-5-460>460</a>
</span><span class=lnt id=hl-5-461><a class=lnlinks href=#hl-5-461>461</a>
</span><span class=lnt id=hl-5-462><a class=lnlinks href=#hl-5-462>462</a>
</span><span class=lnt id=hl-5-463><a class=lnlinks href=#hl-5-463>463</a>
</span><span class=lnt id=hl-5-464><a class=lnlinks href=#hl-5-464>464</a>
</span><span class=lnt id=hl-5-465><a class=lnlinks href=#hl-5-465>465</a>
</span><span class=lnt id=hl-5-466><a class=lnlinks href=#hl-5-466>466</a>
</span><span class=lnt id=hl-5-467><a class=lnlinks href=#hl-5-467>467</a>
</span><span class=lnt id=hl-5-468><a class=lnlinks href=#hl-5-468>468</a>
</span><span class=lnt id=hl-5-469><a class=lnlinks href=#hl-5-469>469</a>
</span><span class=lnt id=hl-5-470><a class=lnlinks href=#hl-5-470>470</a>
</span><span class=lnt id=hl-5-471><a class=lnlinks href=#hl-5-471>471</a>
</span><span class=lnt id=hl-5-472><a class=lnlinks href=#hl-5-472>472</a>
</span><span class=lnt id=hl-5-473><a class=lnlinks href=#hl-5-473>473</a>
</span><span class=lnt id=hl-5-474><a class=lnlinks href=#hl-5-474>474</a>
</span><span class=lnt id=hl-5-475><a class=lnlinks href=#hl-5-475>475</a>
</span><span class=lnt id=hl-5-476><a class=lnlinks href=#hl-5-476>476</a>
</span><span class=lnt id=hl-5-477><a class=lnlinks href=#hl-5-477>477</a>
</span><span class=lnt id=hl-5-478><a class=lnlinks href=#hl-5-478>478</a>
</span><span class=lnt id=hl-5-479><a class=lnlinks href=#hl-5-479>479</a>
</span><span class=lnt id=hl-5-480><a class=lnlinks href=#hl-5-480>480</a>
</span><span class=lnt id=hl-5-481><a class=lnlinks href=#hl-5-481>481</a>
</span><span class=lnt id=hl-5-482><a class=lnlinks href=#hl-5-482>482</a>
</span><span class=lnt id=hl-5-483><a class=lnlinks href=#hl-5-483>483</a>
</span><span class=lnt id=hl-5-484><a class=lnlinks href=#hl-5-484>484</a>
</span><span class=lnt id=hl-5-485><a class=lnlinks href=#hl-5-485>485</a>
</span><span class=lnt id=hl-5-486><a class=lnlinks href=#hl-5-486>486</a>
</span><span class=lnt id=hl-5-487><a class=lnlinks href=#hl-5-487>487</a>
</span><span class=lnt id=hl-5-488><a class=lnlinks href=#hl-5-488>488</a>
</span><span class=lnt id=hl-5-489><a class=lnlinks href=#hl-5-489>489</a>
</span><span class=lnt id=hl-5-490><a class=lnlinks href=#hl-5-490>490</a>
</span><span class=lnt id=hl-5-491><a class=lnlinks href=#hl-5-491>491</a>
</span><span class=lnt id=hl-5-492><a class=lnlinks href=#hl-5-492>492</a>
</span><span class=lnt id=hl-5-493><a class=lnlinks href=#hl-5-493>493</a>
</span><span class=lnt id=hl-5-494><a class=lnlinks href=#hl-5-494>494</a>
</span><span class=lnt id=hl-5-495><a class=lnlinks href=#hl-5-495>495</a>
</span><span class=lnt id=hl-5-496><a class=lnlinks href=#hl-5-496>496</a>
</span><span class=lnt id=hl-5-497><a class=lnlinks href=#hl-5-497>497</a>
</span><span class=lnt id=hl-5-498><a class=lnlinks href=#hl-5-498>498</a>
</span><span class=lnt id=hl-5-499><a class=lnlinks href=#hl-5-499>499</a>
</span><span class=lnt id=hl-5-500><a class=lnlinks href=#hl-5-500>500</a>
</span><span class=lnt id=hl-5-501><a class=lnlinks href=#hl-5-501>501</a>
</span><span class=lnt id=hl-5-502><a class=lnlinks href=#hl-5-502>502</a>
</span><span class=lnt id=hl-5-503><a class=lnlinks href=#hl-5-503>503</a>
</span><span class=lnt id=hl-5-504><a class=lnlinks href=#hl-5-504>504</a>
</span><span class=lnt id=hl-5-505><a class=lnlinks href=#hl-5-505>505</a>
</span><span class=lnt id=hl-5-506><a class=lnlinks href=#hl-5-506>506</a>
</span><span class=lnt id=hl-5-507><a class=lnlinks href=#hl-5-507>507</a>
</span><span class=lnt id=hl-5-508><a class=lnlinks href=#hl-5-508>508</a>
</span><span class=lnt id=hl-5-509><a class=lnlinks href=#hl-5-509>509</a>
</span><span class=lnt id=hl-5-510><a class=lnlinks href=#hl-5-510>510</a>
</span><span class=lnt id=hl-5-511><a class=lnlinks href=#hl-5-511>511</a>
</span><span class=lnt id=hl-5-512><a class=lnlinks href=#hl-5-512>512</a>
</span><span class=lnt id=hl-5-513><a class=lnlinks href=#hl-5-513>513</a>
</span><span class=lnt id=hl-5-514><a class=lnlinks href=#hl-5-514>514</a>
</span><span class=lnt id=hl-5-515><a class=lnlinks href=#hl-5-515>515</a>
</span><span class=lnt id=hl-5-516><a class=lnlinks href=#hl-5-516>516</a>
</span><span class=lnt id=hl-5-517><a class=lnlinks href=#hl-5-517>517</a>
</span><span class=lnt id=hl-5-518><a class=lnlinks href=#hl-5-518>518</a>
</span><span class=lnt id=hl-5-519><a class=lnlinks href=#hl-5-519>519</a>
</span><span class=lnt id=hl-5-520><a class=lnlinks href=#hl-5-520>520</a>
</span><span class=lnt id=hl-5-521><a class=lnlinks href=#hl-5-521>521</a>
</span><span class=lnt id=hl-5-522><a class=lnlinks href=#hl-5-522>522</a>
</span><span class=lnt id=hl-5-523><a class=lnlinks href=#hl-5-523>523</a>
</span><span class=lnt id=hl-5-524><a class=lnlinks href=#hl-5-524>524</a>
</span><span class=lnt id=hl-5-525><a class=lnlinks href=#hl-5-525>525</a>
</span><span class=lnt id=hl-5-526><a class=lnlinks href=#hl-5-526>526</a>
</span><span class=lnt id=hl-5-527><a class=lnlinks href=#hl-5-527>527</a>
</span><span class=lnt id=hl-5-528><a class=lnlinks href=#hl-5-528>528</a>
</span><span class=lnt id=hl-5-529><a class=lnlinks href=#hl-5-529>529</a>
</span><span class=lnt id=hl-5-530><a class=lnlinks href=#hl-5-530>530</a>
</span><span class=lnt id=hl-5-531><a class=lnlinks href=#hl-5-531>531</a>
</span><span class=lnt id=hl-5-532><a class=lnlinks href=#hl-5-532>532</a>
</span><span class=lnt id=hl-5-533><a class=lnlinks href=#hl-5-533>533</a>
</span><span class=lnt id=hl-5-534><a class=lnlinks href=#hl-5-534>534</a>
</span><span class=lnt id=hl-5-535><a class=lnlinks href=#hl-5-535>535</a>
</span><span class=lnt id=hl-5-536><a class=lnlinks href=#hl-5-536>536</a>
</span><span class=lnt id=hl-5-537><a class=lnlinks href=#hl-5-537>537</a>
</span><span class=lnt id=hl-5-538><a class=lnlinks href=#hl-5-538>538</a>
</span><span class=lnt id=hl-5-539><a class=lnlinks href=#hl-5-539>539</a>
</span><span class=lnt id=hl-5-540><a class=lnlinks href=#hl-5-540>540</a>
</span><span class=lnt id=hl-5-541><a class=lnlinks href=#hl-5-541>541</a>
</span><span class=lnt id=hl-5-542><a class=lnlinks href=#hl-5-542>542</a>
</span><span class=lnt id=hl-5-543><a class=lnlinks href=#hl-5-543>543</a>
</span><span class=lnt id=hl-5-544><a class=lnlinks href=#hl-5-544>544</a>
</span><span class=lnt id=hl-5-545><a class=lnlinks href=#hl-5-545>545</a>
</span><span class=lnt id=hl-5-546><a class=lnlinks href=#hl-5-546>546</a>
</span><span class=lnt id=hl-5-547><a class=lnlinks href=#hl-5-547>547</a>
</span><span class=lnt id=hl-5-548><a class=lnlinks href=#hl-5-548>548</a>
</span><span class=lnt id=hl-5-549><a class=lnlinks href=#hl-5-549>549</a>
</span><span class=lnt id=hl-5-550><a class=lnlinks href=#hl-5-550>550</a>
</span><span class=lnt id=hl-5-551><a class=lnlinks href=#hl-5-551>551</a>
</span><span class=lnt id=hl-5-552><a class=lnlinks href=#hl-5-552>552</a>
</span><span class=lnt id=hl-5-553><a class=lnlinks href=#hl-5-553>553</a>
</span><span class=lnt id=hl-5-554><a class=lnlinks href=#hl-5-554>554</a>
</span><span class=lnt id=hl-5-555><a class=lnlinks href=#hl-5-555>555</a>
</span><span class=lnt id=hl-5-556><a class=lnlinks href=#hl-5-556>556</a>
</span><span class=lnt id=hl-5-557><a class=lnlinks href=#hl-5-557>557</a>
</span><span class=lnt id=hl-5-558><a class=lnlinks href=#hl-5-558>558</a>
</span><span class=lnt id=hl-5-559><a class=lnlinks href=#hl-5-559>559</a>
</span><span class=lnt id=hl-5-560><a class=lnlinks href=#hl-5-560>560</a>
</span><span class=lnt id=hl-5-561><a class=lnlinks href=#hl-5-561>561</a>
</span><span class=lnt id=hl-5-562><a class=lnlinks href=#hl-5-562>562</a>
</span><span class=lnt id=hl-5-563><a class=lnlinks href=#hl-5-563>563</a>
</span><span class=lnt id=hl-5-564><a class=lnlinks href=#hl-5-564>564</a>
</span><span class=lnt id=hl-5-565><a class=lnlinks href=#hl-5-565>565</a>
</span><span class=lnt id=hl-5-566><a class=lnlinks href=#hl-5-566>566</a>
</span><span class=lnt id=hl-5-567><a class=lnlinks href=#hl-5-567>567</a>
</span><span class=lnt id=hl-5-568><a class=lnlinks href=#hl-5-568>568</a>
</span><span class=lnt id=hl-5-569><a class=lnlinks href=#hl-5-569>569</a>
</span><span class=lnt id=hl-5-570><a class=lnlinks href=#hl-5-570>570</a>
</span><span class=lnt id=hl-5-571><a class=lnlinks href=#hl-5-571>571</a>
</span><span class=lnt id=hl-5-572><a class=lnlinks href=#hl-5-572>572</a>
</span><span class=lnt id=hl-5-573><a class=lnlinks href=#hl-5-573>573</a>
</span><span class=lnt id=hl-5-574><a class=lnlinks href=#hl-5-574>574</a>
</span><span class=lnt id=hl-5-575><a class=lnlinks href=#hl-5-575>575</a>
</span><span class=lnt id=hl-5-576><a class=lnlinks href=#hl-5-576>576</a>
</span><span class=lnt id=hl-5-577><a class=lnlinks href=#hl-5-577>577</a>
</span><span class=lnt id=hl-5-578><a class=lnlinks href=#hl-5-578>578</a>
</span><span class=lnt id=hl-5-579><a class=lnlinks href=#hl-5-579>579</a>
</span><span class=lnt id=hl-5-580><a class=lnlinks href=#hl-5-580>580</a>
</span><span class=lnt id=hl-5-581><a class=lnlinks href=#hl-5-581>581</a>
</span><span class=lnt id=hl-5-582><a class=lnlinks href=#hl-5-582>582</a>
</span><span class=lnt id=hl-5-583><a class=lnlinks href=#hl-5-583>583</a>
</span><span class=lnt id=hl-5-584><a class=lnlinks href=#hl-5-584>584</a>
</span><span class=lnt id=hl-5-585><a class=lnlinks href=#hl-5-585>585</a>
</span><span class=lnt id=hl-5-586><a class=lnlinks href=#hl-5-586>586</a>
</span><span class=lnt id=hl-5-587><a class=lnlinks href=#hl-5-587>587</a>
</span><span class=lnt id=hl-5-588><a class=lnlinks href=#hl-5-588>588</a>
</span><span class=lnt id=hl-5-589><a class=lnlinks href=#hl-5-589>589</a>
</span><span class=lnt id=hl-5-590><a class=lnlinks href=#hl-5-590>590</a>
</span><span class=lnt id=hl-5-591><a class=lnlinks href=#hl-5-591>591</a>
</span><span class=lnt id=hl-5-592><a class=lnlinks href=#hl-5-592>592</a>
</span><span class=lnt id=hl-5-593><a class=lnlinks href=#hl-5-593>593</a>
</span><span class=lnt id=hl-5-594><a class=lnlinks href=#hl-5-594>594</a>
</span><span class=lnt id=hl-5-595><a class=lnlinks href=#hl-5-595>595</a>
</span><span class=lnt id=hl-5-596><a class=lnlinks href=#hl-5-596>596</a>
</span><span class=lnt id=hl-5-597><a class=lnlinks href=#hl-5-597>597</a>
</span><span class=lnt id=hl-5-598><a class=lnlinks href=#hl-5-598>598</a>
</span><span class=lnt id=hl-5-599><a class=lnlinks href=#hl-5-599>599</a>
</span><span class=lnt id=hl-5-600><a class=lnlinks href=#hl-5-600>600</a>
</span><span class=lnt id=hl-5-601><a class=lnlinks href=#hl-5-601>601</a>
</span><span class=lnt id=hl-5-602><a class=lnlinks href=#hl-5-602>602</a>
</span><span class=lnt id=hl-5-603><a class=lnlinks href=#hl-5-603>603</a>
</span><span class=lnt id=hl-5-604><a class=lnlinks href=#hl-5-604>604</a>
</span><span class=lnt id=hl-5-605><a class=lnlinks href=#hl-5-605>605</a>
</span><span class=lnt id=hl-5-606><a class=lnlinks href=#hl-5-606>606</a>
</span><span class=lnt id=hl-5-607><a class=lnlinks href=#hl-5-607>607</a>
</span><span class=lnt id=hl-5-608><a class=lnlinks href=#hl-5-608>608</a>
</span><span class=lnt id=hl-5-609><a class=lnlinks href=#hl-5-609>609</a>
</span><span class=lnt id=hl-5-610><a class=lnlinks href=#hl-5-610>610</a>
</span><span class=lnt id=hl-5-611><a class=lnlinks href=#hl-5-611>611</a>
</span><span class=lnt id=hl-5-612><a class=lnlinks href=#hl-5-612>612</a>
</span><span class=lnt id=hl-5-613><a class=lnlinks href=#hl-5-613>613</a>
</span><span class=lnt id=hl-5-614><a class=lnlinks href=#hl-5-614>614</a>
</span><span class=lnt id=hl-5-615><a class=lnlinks href=#hl-5-615>615</a>
</span><span class=lnt id=hl-5-616><a class=lnlinks href=#hl-5-616>616</a>
</span><span class=lnt id=hl-5-617><a class=lnlinks href=#hl-5-617>617</a>
</span><span class=lnt id=hl-5-618><a class=lnlinks href=#hl-5-618>618</a>
</span><span class=lnt id=hl-5-619><a class=lnlinks href=#hl-5-619>619</a>
</span><span class=lnt id=hl-5-620><a class=lnlinks href=#hl-5-620>620</a>
</span><span class=lnt id=hl-5-621><a class=lnlinks href=#hl-5-621>621</a>
</span><span class=lnt id=hl-5-622><a class=lnlinks href=#hl-5-622>622</a>
</span><span class=lnt id=hl-5-623><a class=lnlinks href=#hl-5-623>623</a>
</span><span class=lnt id=hl-5-624><a class=lnlinks href=#hl-5-624>624</a>
</span><span class=lnt id=hl-5-625><a class=lnlinks href=#hl-5-625>625</a>
</span><span class=lnt id=hl-5-626><a class=lnlinks href=#hl-5-626>626</a>
</span><span class=lnt id=hl-5-627><a class=lnlinks href=#hl-5-627>627</a>
</span><span class=lnt id=hl-5-628><a class=lnlinks href=#hl-5-628>628</a>
</span><span class=lnt id=hl-5-629><a class=lnlinks href=#hl-5-629>629</a>
</span><span class=lnt id=hl-5-630><a class=lnlinks href=#hl-5-630>630</a>
</span><span class=lnt id=hl-5-631><a class=lnlinks href=#hl-5-631>631</a>
</span><span class=lnt id=hl-5-632><a class=lnlinks href=#hl-5-632>632</a>
</span><span class=lnt id=hl-5-633><a class=lnlinks href=#hl-5-633>633</a>
</span><span class=lnt id=hl-5-634><a class=lnlinks href=#hl-5-634>634</a>
</span><span class=lnt id=hl-5-635><a class=lnlinks href=#hl-5-635>635</a>
</span><span class=lnt id=hl-5-636><a class=lnlinks href=#hl-5-636>636</a>
</span><span class=lnt id=hl-5-637><a class=lnlinks href=#hl-5-637>637</a>
</span><span class=lnt id=hl-5-638><a class=lnlinks href=#hl-5-638>638</a>
</span><span class=lnt id=hl-5-639><a class=lnlinks href=#hl-5-639>639</a>
</span><span class=lnt id=hl-5-640><a class=lnlinks href=#hl-5-640>640</a>
</span><span class=lnt id=hl-5-641><a class=lnlinks href=#hl-5-641>641</a>
</span><span class=lnt id=hl-5-642><a class=lnlinks href=#hl-5-642>642</a>
</span><span class=lnt id=hl-5-643><a class=lnlinks href=#hl-5-643>643</a>
</span><span class=lnt id=hl-5-644><a class=lnlinks href=#hl-5-644>644</a>
</span><span class=lnt id=hl-5-645><a class=lnlinks href=#hl-5-645>645</a>
</span><span class=lnt id=hl-5-646><a class=lnlinks href=#hl-5-646>646</a>
</span><span class=lnt id=hl-5-647><a class=lnlinks href=#hl-5-647>647</a>
</span><span class=lnt id=hl-5-648><a class=lnlinks href=#hl-5-648>648</a>
</span><span class=lnt id=hl-5-649><a class=lnlinks href=#hl-5-649>649</a>
</span><span class=lnt id=hl-5-650><a class=lnlinks href=#hl-5-650>650</a>
</span><span class=lnt id=hl-5-651><a class=lnlinks href=#hl-5-651>651</a>
</span><span class=lnt id=hl-5-652><a class=lnlinks href=#hl-5-652>652</a>
</span><span class=lnt id=hl-5-653><a class=lnlinks href=#hl-5-653>653</a>
</span><span class=lnt id=hl-5-654><a class=lnlinks href=#hl-5-654>654</a>
</span><span class=lnt id=hl-5-655><a class=lnlinks href=#hl-5-655>655</a>
</span><span class=lnt id=hl-5-656><a class=lnlinks href=#hl-5-656>656</a>
</span><span class=lnt id=hl-5-657><a class=lnlinks href=#hl-5-657>657</a>
</span><span class=lnt id=hl-5-658><a class=lnlinks href=#hl-5-658>658</a>
</span><span class=lnt id=hl-5-659><a class=lnlinks href=#hl-5-659>659</a>
</span><span class=lnt id=hl-5-660><a class=lnlinks href=#hl-5-660>660</a>
</span><span class=lnt id=hl-5-661><a class=lnlinks href=#hl-5-661>661</a>
</span><span class=lnt id=hl-5-662><a class=lnlinks href=#hl-5-662>662</a>
</span><span class=lnt id=hl-5-663><a class=lnlinks href=#hl-5-663>663</a>
</span><span class=lnt id=hl-5-664><a class=lnlinks href=#hl-5-664>664</a>
</span><span class=lnt id=hl-5-665><a class=lnlinks href=#hl-5-665>665</a>
</span><span class=lnt id=hl-5-666><a class=lnlinks href=#hl-5-666>666</a>
</span><span class=lnt id=hl-5-667><a class=lnlinks href=#hl-5-667>667</a>
</span><span class=lnt id=hl-5-668><a class=lnlinks href=#hl-5-668>668</a>
</span><span class=lnt id=hl-5-669><a class=lnlinks href=#hl-5-669>669</a>
</span><span class=lnt id=hl-5-670><a class=lnlinks href=#hl-5-670>670</a>
</span><span class=lnt id=hl-5-671><a class=lnlinks href=#hl-5-671>671</a>
</span><span class=lnt id=hl-5-672><a class=lnlinks href=#hl-5-672>672</a>
</span><span class=lnt id=hl-5-673><a class=lnlinks href=#hl-5-673>673</a>
</span><span class=lnt id=hl-5-674><a class=lnlinks href=#hl-5-674>674</a>
</span><span class=lnt id=hl-5-675><a class=lnlinks href=#hl-5-675>675</a>
</span><span class=lnt id=hl-5-676><a class=lnlinks href=#hl-5-676>676</a>
</span><span class=lnt id=hl-5-677><a class=lnlinks href=#hl-5-677>677</a>
</span><span class=lnt id=hl-5-678><a class=lnlinks href=#hl-5-678>678</a>
</span><span class=lnt id=hl-5-679><a class=lnlinks href=#hl-5-679>679</a>
</span><span class=lnt id=hl-5-680><a class=lnlinks href=#hl-5-680>680</a>
</span><span class=lnt id=hl-5-681><a class=lnlinks href=#hl-5-681>681</a>
</span><span class=lnt id=hl-5-682><a class=lnlinks href=#hl-5-682>682</a>
</span><span class=lnt id=hl-5-683><a class=lnlinks href=#hl-5-683>683</a>
</span><span class=lnt id=hl-5-684><a class=lnlinks href=#hl-5-684>684</a>
</span><span class=lnt id=hl-5-685><a class=lnlinks href=#hl-5-685>685</a>
</span><span class=lnt id=hl-5-686><a class=lnlinks href=#hl-5-686>686</a>
</span><span class=lnt id=hl-5-687><a class=lnlinks href=#hl-5-687>687</a>
</span><span class=lnt id=hl-5-688><a class=lnlinks href=#hl-5-688>688</a>
</span><span class=lnt id=hl-5-689><a class=lnlinks href=#hl-5-689>689</a>
</span><span class=lnt id=hl-5-690><a class=lnlinks href=#hl-5-690>690</a>
</span><span class=lnt id=hl-5-691><a class=lnlinks href=#hl-5-691>691</a>
</span><span class=lnt id=hl-5-692><a class=lnlinks href=#hl-5-692>692</a>
</span><span class=lnt id=hl-5-693><a class=lnlinks href=#hl-5-693>693</a>
</span><span class=lnt id=hl-5-694><a class=lnlinks href=#hl-5-694>694</a>
</span><span class=lnt id=hl-5-695><a class=lnlinks href=#hl-5-695>695</a>
</span><span class=lnt id=hl-5-696><a class=lnlinks href=#hl-5-696>696</a>
</span><span class=lnt id=hl-5-697><a class=lnlinks href=#hl-5-697>697</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=cp>#!/bin/sh
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=c1># OpenVAS</span>
</span></span><span class=line><span class=cl><span class=c1># $Id$</span>
</span></span><span class=line><span class=cl><span class=c1># Description: Script for checking completeness and readiness</span>
</span></span><span class=line><span class=cl><span class=c1># of OpenVAS.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Authors:</span>
</span></span><span class=line><span class=cl><span class=c1># Jan-Oliver Wagner &lt;jan-oliver.wagner@greenbone.net&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># Michael Wiegand &lt;michael.wiegand@greenbone.net&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Copyright:</span>
</span></span><span class=line><span class=cl><span class=c1># Copyright (C) 2011 Greenbone Networks GmbH</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># This program is free software; you can redistribute it and/or modify</span>
</span></span><span class=line><span class=cl><span class=c1># it under the terms of the GNU General Public License version 2,</span>
</span></span><span class=line><span class=cl><span class=c1># or at your option any later version, as published by the</span>
</span></span><span class=line><span class=cl><span class=c1># Free Software Foundation</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># This program is distributed in the hope that it will be useful,</span>
</span></span><span class=line><span class=cl><span class=c1># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
</span></span><span class=line><span class=cl><span class=c1># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
</span></span><span class=line><span class=cl><span class=c1># GNU General Public License for more details.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># You should have received a copy of the GNU General Public License</span>
</span></span><span class=line><span class=cl><span class=c1># along with this program; if not, write to the Free Software</span>
</span></span><span class=line><span class=cl><span class=c1># Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>LOG</span><span class=o>=</span>/tmp/openvas-check-setup.log
</span></span><span class=line><span class=cl><span class=nv>CHECKVERSION</span><span class=o>=</span>2.1.3
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s2>&#34;--server&#34;</span> -o <span class=s2>&#34;</span><span class=nv>$2</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s2>&#34;--server&#34;</span> <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>  <span class=nv>MODE</span><span class=o>=</span><span class=s2>&#34;server&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  <span class=nv>MODE</span><span class=o>=</span><span class=s2>&#34;desktop&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s2>&#34;--v5&#34;</span> -o <span class=s2>&#34;</span><span class=nv>$2</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s2>&#34;--v5&#34;</span> <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>  <span class=nv>VER</span><span class=o>=</span><span class=s2>&#34;5&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>SCANNER_MAJOR</span><span class=o>=</span><span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>SCANNER_MINOR</span><span class=o>=</span><span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>MANAGER_MAJOR</span><span class=o>=</span><span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>MANAGER_MINOR</span><span class=o>=</span><span class=s2>&#34;0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>ADMINISTRATOR_MAJOR</span><span class=o>=</span><span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>ADMINISTRATOR_MINOR</span><span class=o>=</span><span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>GSA_MAJOR</span><span class=o>=</span><span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>GSA_MINOR</span><span class=o>=</span><span class=s2>&#34;0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>CLI_MAJOR</span><span class=o>=</span><span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>CLI_MINOR</span><span class=o>=</span><span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>GSD_MAJOR</span><span class=o>=</span><span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>GSD_MINOR</span><span class=o>=</span><span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  <span class=nv>VER</span><span class=o>=</span><span class=s2>&#34;4&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>SCANNER_MAJOR</span><span class=o>=</span><span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>SCANNER_MINOR</span><span class=o>=</span><span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>MANAGER_MAJOR</span><span class=o>=</span><span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>MANAGER_MINOR</span><span class=o>=</span><span class=s2>&#34;0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>ADMINISTRATOR_MAJOR</span><span class=o>=</span><span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>ADMINISTRATOR_MINOR</span><span class=o>=</span><span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>GSA_MAJOR</span><span class=o>=</span><span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>GSA_MINOR</span><span class=o>=</span><span class=s2>&#34;0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>CLI_MAJOR</span><span class=o>=</span><span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>CLI_MINOR</span><span class=o>=</span><span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>GSD_MAJOR</span><span class=o>=</span><span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>GSD_MINOR</span><span class=o>=</span><span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;openvas-check-setup </span><span class=nv>$CHECKVERSION</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;  Test completeness and readiness of OpenVAS-</span><span class=nv>$VER</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;  Please report us any non-detected problems and&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;  help us to improve this check routine:&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;  http://lists.wald.intevation.org/mailman/listinfo/openvas-discuss&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;  Send us the log-file (</span><span class=nv>$LOG</span><span class=s2>) to help analyze the problem.&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$MODE</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s2>&#34;desktop&#34;</span> <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;  Use the parameter --server to skip checks for client tools&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;  like GSD and OpenVAS-CLI.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>log_and_print <span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;       &#34;</span> <span class=nv>$1</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;       &#34;</span> <span class=nv>$1</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>check_failed <span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34; ERROR: Your OpenVAS-</span><span class=nv>$VER</span><span class=s2> installation is not yet complete!&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Please follow the instructions marked with FIX above and run this&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;script again.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;If you think this result is wrong, please report your observation&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;and help us to improve this check routine:&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;http://lists.wald.intevation.org/mailman/listinfo/openvas-discuss&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Please attach the log-file (</span><span class=nv>$LOG</span><span class=s2>) to help us analyze the problem.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># LOG start</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;openvas-check-setup </span><span class=nv>$CHECKVERSION</span><span class=s2>&#34;</span> &gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;  Mode:  </span><span class=nv>$MODE</span><span class=s2>&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;  Date: &#34;</span> <span class=sb>`</span>date -R<span class=sb>`</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Step 1: Checking OpenVAS Scanner ... &#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking for old OpenVAS Scanner &lt;= 2.0 ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>openvasd -V &gt;&gt; <span class=nv>$LOG</span> 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -eq <span class=m>0</span> <span class=o>]</span>: <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: Old version of OpenVAS Scanner detected.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Please remove the installation of the old OpenVAS Scanner (openvasd).&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking presence of OpenVAS Scanner ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>openvassd --version &gt;&gt; <span class=nv>$LOG</span> 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: No OpenVAS Scanner (openvassd) found.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Please install OpenVAS Scanner.&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking OpenVAS Scanner version ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>VERSION</span><span class=o>=</span><span class=sb>`</span>openvassd --version <span class=p>|</span> head -1 <span class=p>|</span> sed -e <span class=s2>&#34;s/OpenVAS Scanner //&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=sb>`</span><span class=nb>echo</span> <span class=nv>$VERSION</span> <span class=p>|</span> grep <span class=s2>&#34;^</span><span class=nv>$SCANNER_MAJOR</span><span class=s2>\.</span><span class=nv>$SCANNER_MINOR</span><span class=s2>&#34;</span> <span class=p>|</span> wc -l<span class=sb>`</span> -ne <span class=s2>&#34;1&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: OpenVAS Scanner too old or too new: </span><span class=nv>$VERSION</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Please install OpenVAS Scanner </span><span class=nv>$SCANNER_MAJOR</span><span class=s2>.</span><span class=nv>$SCANNER_MINOR</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>log_and_print <span class=s2>&#34;OK: OpenVAS Scanner is present in version </span><span class=nv>$VERSION</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>openvassd -s &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking OpenVAS Scanner CA cert ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nv>CAFILE</span><span class=o>=</span><span class=sb>`</span>openvassd -s <span class=p>|</span> grep ca_file <span class=p>|</span> sed -e <span class=s2>&#34;s/^ca_file = //&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> ! -e <span class=nv>$CAFILE</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: No CA certificate file of OpenVAS Scanner found.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Run &#39;openvas-mkcert&#39;.&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>log_and_print <span class=s2>&#34;OK: OpenVAS Scanner CA Certificate is present as </span><span class=nv>$CAFILE</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking NVT collection ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>PLUGINSFOLDER</span><span class=o>=</span><span class=sb>`</span>openvassd -s <span class=p>|</span> grep plugins_folder <span class=p>|</span> sed -e <span class=s2>&#34;s/^plugins_folder = //&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> ! -d <span class=nv>$PLUGINSFOLDER</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: Directory containing the NVT collection not found.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Run a synchronization script like openvas-nvt-sync or greenbone-nvt-sync.&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>OLDPLUGINSFOLDER</span><span class=o>=</span><span class=sb>`</span><span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$PLUGINSFOLDER</span><span class=s2>&#34;</span> <span class=p>|</span> grep -q -v <span class=s2>&#34;/var/&#34;</span> 2&gt;<span class=p>&amp;</span>1<span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -eq <span class=m>0</span> <span class=o>]</span>: <span class=k>then</span>
</span></span><span class=line><span class=cl>  <span class=nv>CONFFILE</span><span class=o>=</span><span class=sb>`</span>openvassd -s <span class=p>|</span> grep config_file <span class=p>|</span> sed -e <span class=s2>&#34;s/^config_file = //&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: Your OpenVAS Scanner configuration seems to be from a pre-OpenVAS-4 installation and contains non-FHS compliant paths.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Delete your OpenVAS Scanner Configuration file (</span><span class=nv>$CONFFILE</span><span class=s2>).&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>NVTCOUNT</span><span class=o>=</span><span class=sb>`</span>find <span class=nv>$PLUGINSFOLDER</span> -name <span class=s2>&#34;*nasl&#34;</span> <span class=p>|</span> wc -l<span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$NVTCOUNT</span> -lt <span class=m>10</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: The NVT collection is very small.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Run a synchronization script like openvas-nvt-sync or greenbone-nvt-sync.&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>log_and_print <span class=s2>&#34;OK: NVT collection in </span><span class=nv>$PLUGINSFOLDER</span><span class=s2> contains </span><span class=nv>$NVTCOUNT</span><span class=s2> NVTs.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking status of signature checking in OpenVAS Scanner ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nv>NOSIGCHECK</span><span class=o>=</span><span class=sb>`</span>openvassd -s <span class=p>|</span> grep nasl_no_signature_check <span class=p>|</span> sed -e <span class=s2>&#34;s/^nasl_no_signature_check = //&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$NOSIGCHECK</span> !<span class=o>=</span> <span class=s2>&#34;no&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;WARNING: Signature checking of NVTs is not enabled in OpenVAS Scanner.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;SUGGEST: Enable signature checking (see http://www.openvas.org/trusted-nvts.html).&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;OK: Signature checking of NVTs is enabled in OpenVAS Scanner.&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Step 2: Checking OpenVAS Manager ... &#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking presence of OpenVAS Manager ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>openvasmd --version &gt;&gt; <span class=nv>$LOG</span> 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: No OpenVAS Manager (openvasmd) found.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Please install OpenVAS Manager.&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>VERSION</span><span class=o>=</span><span class=sb>`</span>openvasmd --version <span class=p>|</span> head -1 <span class=p>|</span> sed -e <span class=s2>&#34;s/OpenVAS Manager //&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=sb>`</span><span class=nb>echo</span> <span class=nv>$VERSION</span> <span class=p>|</span> grep <span class=s2>&#34;^</span><span class=nv>$MANAGER_MAJOR</span><span class=s2>\.</span><span class=nv>$MANAGER_MINOR</span><span class=s2>&#34;</span> <span class=p>|</span> wc -l<span class=sb>`</span> -ne <span class=s2>&#34;1&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: OpenVAS Manager too old or too new: </span><span class=nv>$VERSION</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Please install OpenVAS Manager </span><span class=nv>$MANAGER_MAJOR</span><span class=s2>.</span><span class=nv>$MANAGER_MINOR</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>log_and_print <span class=s2>&#34;OK: OpenVAS Manager is present in version </span><span class=nv>$VERSION</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking OpenVAS Manager client certificate ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nv>CERTDIR</span><span class=o>=</span><span class=sb>`</span>dirname <span class=nv>$CAFILE</span><span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=nv>CLIENTCERTFILE</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$CERTDIR</span><span class=s2>/clientcert.pem&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> ! -e <span class=nv>$CLIENTCERTFILE</span> <span class=o>]</span>: <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: No client certificate file of OpenVAS Manager found.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Run &#39;openvas-mkcert-client -n om -i&#39;&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>log_and_print <span class=s2>&#34;OK: OpenVAS Manager client certificate is present as </span><span class=nv>$CLIENTCERTFILE</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking OpenVAS Manager database ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=c1># Guess openvas state dir from $PLUGINSFOLDER</span>
</span></span><span class=line><span class=cl><span class=nv>STATEDIR</span><span class=o>=</span><span class=sb>`</span>dirname <span class=nv>$PLUGINSFOLDER</span><span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=nv>TASKSDB</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$STATEDIR</span><span class=s2>/mgr/tasks.db&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> ! -e <span class=nv>$TASKSDB</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: No OpenVAS Manager database found. (Tried: </span><span class=nv>$TASKSDB</span><span class=s2>)&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Run &#39;openvasmd --rebuild&#39; while OpenVAS Scanner is running.&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>log_and_print <span class=s2>&#34;OK: OpenVAS Manager database found in </span><span class=nv>$TASKSDB</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking access rights of OpenVAS Manager database ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nv>TASKSDBPERMS</span><span class=o>=</span><span class=sb>`</span>stat -c <span class=s2>&#34;%a&#34;</span> <span class=s2>&#34;</span><span class=nv>$TASKSDB</span><span class=s2>&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$TASKSDBPERMS</span><span class=s2>&#34;</span> !<span class=o>=</span> <span class=s2>&#34;600&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: The access rights of the OpenVAS Manager database are incorrect.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Run &#39;chmod 600 </span><span class=nv>$TASKSDB</span><span class=s2>&#39;.&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>log_and_print <span class=s2>&#34;OK: Access rights for the OpenVAS Manager database are correct.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking sqlite3 presence ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nv>SQLITE3</span><span class=o>=</span><span class=sb>`</span><span class=nb>type</span> sqlite3 2&gt; /dev/null<span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span>: <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;WARNING: Could not find sqlite3 binary, extended manager checks of the OpenVAS Manager installation are disabled.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;SUGGEST: Install sqlite3.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>HAVE_SQLITE</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;OK: sqlite3 found, extended checks of the OpenVAS Manager installation enabled.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>HAVE_SQLITE</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$HAVE_SQLITE</span> -eq <span class=m>1</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Checking OpenVAS Manager database revision ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>  <span class=nv>TASKSDBREV</span><span class=o>=</span><span class=sb>`</span>sqlite3 <span class=nv>$TASKSDB</span> <span class=s2>&#34;select value from meta where name=&#39;database_version&#39;;&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> -z <span class=nv>$TASKSDBREV</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;ERROR: Could not determine database revision, database corrupt or in invalid format.&#34;</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;FIX: Delete database at </span><span class=nv>$TASKSDB</span><span class=s2> and rebuild it.&#34;</span>
</span></span><span class=line><span class=cl>    check_failed
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;OK: OpenVAS Manager database is at revision </span><span class=nv>$TASKSDBREV</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Checking database revision expected by OpenVAS Manager ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>  <span class=nv>MANAGERDBREV</span><span class=o>=</span><span class=sb>`</span>openvasmd --version <span class=p>|</span> grep <span class=s2>&#34;Manager DB revision&#34;</span> <span class=p>|</span> sed -e <span class=s2>&#34;s/.*\ //&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> -z <span class=nv>$MANAGERDBREV</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;ERROR: Could not determine database revision expected by OpenVAS Manager.&#34;</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;FIX: Ensure OpenVAS Manager is installed correctly.&#34;</span>
</span></span><span class=line><span class=cl>    check_failed
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;OK: OpenVAS Manager expects database at revision </span><span class=nv>$MANAGERDBREV</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> <span class=nv>$TASKSDBREV</span> -lt <span class=nv>$MANAGERDBREV</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;ERROR: Database schema is out of date.&#34;</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;FIX: Run &#39;openvasmd --migrate&#39;.&#34;</span>
</span></span><span class=line><span class=cl>    check_failed
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;OK: Database schema is up to date.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Checking OpenVAS Manager database (NVT data) ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>  <span class=nv>DBNVTCOUNT</span><span class=o>=</span><span class=sb>`</span>sqlite3 <span class=nv>$TASKSDB</span> <span class=s2>&#34;select count(*) from nvts;&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> <span class=nv>$DBNVTCOUNT</span> -lt <span class=m>20000</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;ERROR: The number of NVTs in the OpenVAS Manager database is too low.&#34;</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;FIX: Make sure OpenVAS Scanner is running with an up-to-date NVT collection and run &#39;openvasmd --rebuild&#39;.&#34;</span>
</span></span><span class=line><span class=cl>    check_failed
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;OK: OpenVAS Manager database contains information about </span><span class=nv>$DBNVTCOUNT</span><span class=s2> NVTs.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking xsltproc presence ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nv>XSLTPROC</span><span class=o>=</span><span class=sb>`</span><span class=nb>type</span> xsltproc 2&gt; /dev/null<span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;WARNING: Could not find xsltproc binary, most report formats will not work.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;SUGGEST: Install xsltproc.&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;OK: xsltproc found.&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Step 3: Checking OpenVAS Administrator ... &#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking presence of OpenVAS Administrator ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>openvasad --version &gt;&gt; <span class=nv>$LOG</span> 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: No OpenVAS Administrator (openvasad) found.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Please install OpenVAS Administrator.&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>VERSION</span><span class=o>=</span><span class=sb>`</span>openvasad --version <span class=p>|</span> head -1 <span class=p>|</span> sed -e <span class=s2>&#34;s/OpenVAS Administrator //&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=sb>`</span><span class=nb>echo</span> <span class=nv>$VERSION</span> <span class=p>|</span> grep <span class=s2>&#34;^</span><span class=nv>$ADMINISTRATOR_MAJOR</span><span class=s2>\.</span><span class=nv>$ADMINISTRATOR_MINOR</span><span class=s2>&#34;</span> <span class=p>|</span> wc -l<span class=sb>`</span> -ne <span class=s2>&#34;1&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: OpenVAS Administrator too old or too new: </span><span class=nv>$VERSION</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Please install OpenVAS Administrator </span><span class=nv>$ADMINISTRATOR_MAJOR</span><span class=s2>.</span><span class=nv>$ADMINISTRATOR_MINOR</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>log_and_print <span class=s2>&#34;OK: OpenVAS Administrator is present in version </span><span class=nv>$VERSION</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking if users exist ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nv>USERCOUNT</span><span class=o>=</span><span class=sb>`</span>openvasad -c <span class=s2>&#34;list_users&#34;</span> <span class=p>|</span> sed -e <span class=s2>&#34;/^</span>$<span class=s2>/d&#34;</span> <span class=p>|</span> wc -l<span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$USERCOUNT</span> -eq <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: No users found. You need to create at least one user to log in.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Create a user using &#39;openvasad -c &#39;add_user&#39; -n &lt;name&gt;&#39;&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;OK: At least one user exists.&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking if at least one admin user exists ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nv>ADMINEXISTS</span><span class=o>=</span><span class=sb>`</span>ls <span class=nv>$STATEDIR</span>/users/*/isadmin 2&gt; /dev/null<span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: No admin user found. You need to create at least one admin user to log in.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Create a user using &#39;openvasad -c &#39;add_user&#39; -n &lt;name&gt; -r Admin&#39;&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;OK: At least one admin user exists.&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Step 4: Checking Greenbone Security Assistant (GSA) ... &#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking presence of Greenbone Security Assistant ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>gsad --version &gt;&gt; <span class=nv>$LOG</span> 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: No Greenbone Security Assistant (gsad) found.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Please install Greenbone Security Assistant.&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>VERSION</span><span class=o>=</span><span class=sb>`</span>gsad --version <span class=p>|</span> head -1 <span class=p>|</span> sed -e <span class=s2>&#34;s/Greenbone Security Assistant //&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=sb>`</span><span class=nb>echo</span> <span class=nv>$VERSION</span> <span class=p>|</span> grep <span class=s2>&#34;^</span><span class=nv>$GSA_MAJOR</span><span class=s2>\.</span><span class=nv>$GSA_MINOR</span><span class=s2>&#34;</span> <span class=p>|</span> wc -l<span class=sb>`</span> -ne <span class=s2>&#34;1&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;ERROR: Greenbone Security Assistant too old or too new: </span><span class=nv>$VERSION</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;FIX: Please install Greenbone Security Assistant </span><span class=nv>$GSA_MAJOR</span><span class=s2>.</span><span class=nv>$GSA_MINOR</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>  check_failed
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>log_and_print <span class=s2>&#34;OK: Greenbone Security Assistant is present in version </span><span class=nv>$VERSION</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Step 5: Checking OpenVAS CLI ... &#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$MODE</span><span class=s2>&#34;</span> !<span class=o>=</span> <span class=s2>&#34;server&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Checking presence of OpenVAS CLI ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>  omp --version &gt;&gt; <span class=nv>$LOG</span> 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;ERROR: No OpenVAS CLI (omp) found.&#34;</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;FIX: Please install OpenVAS CLI.&#34;</span>
</span></span><span class=line><span class=cl>    check_failed
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nv>VERSION</span><span class=o>=</span><span class=sb>`</span>omp --version <span class=p>|</span> head -1 <span class=p>|</span> sed -e <span class=s2>&#34;s/OMP Command Line Interface //&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> <span class=sb>`</span><span class=nb>echo</span> <span class=nv>$VERSION</span> <span class=p>|</span> grep <span class=s2>&#34;^</span><span class=nv>$CLI_MAJOR</span><span class=s2>\.</span><span class=nv>$CLI_MINOR</span><span class=s2>&#34;</span> <span class=p>|</span> wc -l<span class=sb>`</span> -ne <span class=s2>&#34;1&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;ERROR: OpenVAS CLI too old or too new: </span><span class=nv>$VERSION</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;FIX: Please install OpenVAS CLI </span><span class=nv>$CLI_MAJOR</span><span class=s2>.</span><span class=nv>$CLI_MINOR</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>    check_failed
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;OK: OpenVAS CLI version </span><span class=nv>$VERSION</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;SKIP: Skipping check for OpenVAS CLI.&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Step 6: Checking Greenbone Security Desktop (GSD) ... &#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$MODE</span><span class=s2>&#34;</span> !<span class=o>=</span> <span class=s2>&#34;server&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Checking presence of Greenbone Security Desktop ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>  <span class=nv>DISPLAY</span><span class=o>=</span>fake gsd --version &gt;&gt; <span class=nv>$LOG</span> 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;ERROR: No Greenbone Security Desktop (gsd) found or too old.&#34;</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;FIX: Please install Greenbone Security Desktop 1.1.0.&#34;</span>
</span></span><span class=line><span class=cl>    check_failed
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nv>VERSION</span><span class=o>=</span><span class=sb>`</span>gsd --version <span class=p>|</span> head -1 <span class=p>|</span> sed -e <span class=s2>&#34;s/Greenbone Security Desktop //&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> <span class=sb>`</span><span class=nb>echo</span> <span class=nv>$VERSION</span> <span class=p>|</span> grep <span class=s2>&#34;^</span><span class=nv>$GSD_MAJOR</span><span class=s2>\.</span><span class=nv>$GSD_MINOR</span><span class=s2>&#34;</span> <span class=p>|</span> wc -l<span class=sb>`</span> -ne <span class=s2>&#34;1&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=c1># a special exception rule for v4 where also another release is OK</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> <span class=nv>$VER</span> -eq <span class=s2>&#34;4&#34;</span> -a <span class=sb>`</span><span class=nb>echo</span> <span class=nv>$VERSION</span> <span class=p>|</span> grep <span class=s2>&#34;^1\.1&#34;</span> <span class=p>|</span> wc -l<span class=sb>`</span> -ne <span class=s2>&#34;1&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>      log_and_print <span class=s2>&#34;ERROR: Greenbone Security Desktop too old or too new: </span><span class=nv>$VERSION</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      log_and_print <span class=s2>&#34;FIX: Please install Greenbone Security Desktop </span><span class=nv>$GSD_MAJOR</span><span class=s2>.</span><span class=nv>$GSD_MINOR</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>      check_failed
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;OK: Greenbone Security Desktop is present in Version </span><span class=nv>$VERSION</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;SKIP: Skipping check for Greenbone Security Assistant.&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Step 7: Checking if OpenVAS services are up and running ... &#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking netstat presence ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>NETSTAT</span><span class=o>=</span><span class=sb>`</span><span class=nb>type</span> netstat 2&gt; /dev/null<span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;WARNING: Could not find netstat binary, checks of the OpenVAS services are disabled.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;SUGGEST: Install netstat.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>HAVE_NETSTAT</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;OK: netstat found, extended checks of the OpenVAS services enabled.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>HAVE_NETSTAT</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$HAVE_NETSTAT</span> -eq <span class=m>1</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  netstat -A inet -ntlp 2&gt; /dev/null &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>  <span class=nv>OPENVASSD_HOST</span><span class=o>=</span><span class=sb>`</span>netstat -A inet -ntlp 2&gt; /dev/null <span class=p>|</span> grep openvassd <span class=p>|</span> awk -F<span class=se>\ </span> <span class=s1>&#39;{print $4}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $1}&#39;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>  <span class=nv>OPENVASSD_PORT</span><span class=o>=</span><span class=sb>`</span>netstat -A inet -ntlp 2&gt; /dev/null <span class=p>|</span> grep openvassd <span class=p>|</span> awk -F<span class=se>\ </span> <span class=s1>&#39;{print $4}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $2}&#39;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>  <span class=nv>OPENVASMD_HOST</span><span class=o>=</span><span class=sb>`</span>netstat -A inet -ntlp 2&gt; /dev/null <span class=p>|</span> grep openvasmd <span class=p>|</span> awk -F<span class=se>\ </span> <span class=s1>&#39;{print $4}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $1}&#39;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>  <span class=nv>OPENVASMD_PORT</span><span class=o>=</span><span class=sb>`</span>netstat -A inet -ntlp 2&gt; /dev/null <span class=p>|</span> grep openvasmd <span class=p>|</span> awk -F<span class=se>\ </span> <span class=s1>&#39;{print $4}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $2}&#39;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>  <span class=nv>OPENVASAD_HOST</span><span class=o>=</span><span class=sb>`</span>netstat -A inet -ntlp 2&gt; /dev/null <span class=p>|</span> grep openvasad <span class=p>|</span> awk -F<span class=se>\ </span> <span class=s1>&#39;{print $4}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $1}&#39;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>  <span class=nv>OPENVASAD_PORT</span><span class=o>=</span><span class=sb>`</span>netstat -A inet -ntlp 2&gt; /dev/null <span class=p>|</span> grep openvasad <span class=p>|</span> awk -F<span class=se>\ </span> <span class=s1>&#39;{print $4}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $2}&#39;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>  <span class=nv>GSAD_HOST</span><span class=o>=</span><span class=sb>`</span>netstat -A inet -ntlp 2&gt; /dev/null <span class=p>|</span> grep gsad <span class=p>|</span> awk -F<span class=se>\ </span> <span class=s1>&#39;{print $4}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $1}&#39;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>  <span class=nv>GSAD_PORT</span><span class=o>=</span><span class=sb>`</span>netstat -A inet -ntlp 2&gt; /dev/null <span class=p>|</span> grep gsad <span class=p>|</span> awk -F<span class=se>\ </span> <span class=s1>&#39;{print $4}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $2}&#39;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=s2>&#34;</span><span class=nv>$OPENVASSD_HOST</span><span class=s2>&#34;</span> in
</span></span><span class=line><span class=cl>    <span class=s2>&#34;0.0.0.0&#34;</span><span class=o>)</span> log_and_print <span class=s2>&#34;OK: OpenVAS Scanner is running and listening on all interfaces.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;127.0.0.1&#34;</span><span class=o>)</span> log_and_print <span class=s2>&#34;OK: OpenVAS Scanner is running and listening only on the local interface.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;</span><span class=o>)</span> log_and_print <span class=s2>&#34;ERROR: OpenVAS Scanner is NOT running!&#34;</span> <span class=p>;</span> log_and_print <span class=s2>&#34;FIX: Start OpenVAS Scanner (openvassd).&#34;</span> <span class=p>;</span> <span class=nv>OPENVASSD_PORT</span><span class=o>=</span>-1 <span class=p>;;</span>
</span></span><span class=line><span class=cl>  <span class=k>esac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=nv>$OPENVASSD_PORT</span> in
</span></span><span class=line><span class=cl>    -1<span class=o>)</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    9391<span class=o>)</span> log_and_print <span class=s2>&#34;OK: OpenVAS Scanner is listening on port 9391, which is the default port.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    *<span class=o>)</span> log_and_print <span class=s2>&#34;WARNING: OpenVAS Scanner is listening on port </span><span class=nv>$OPENVASSD_PORT</span><span class=s2>, which is NOT the default port!&#34;</span>
</span></span><span class=line><span class=cl>       log_and_print <span class=s2>&#34;SUGGEST: Ensure OpenVAS Scanner is listening on port 9391.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>  <span class=k>esac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=s2>&#34;</span><span class=nv>$OPENVASMD_HOST</span><span class=s2>&#34;</span> in
</span></span><span class=line><span class=cl>    <span class=s2>&#34;0.0.0.0&#34;</span><span class=o>)</span> log_and_print <span class=s2>&#34;OK: OpenVAS Manager is running and listening on all interfaces.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;127.0.0.1&#34;</span><span class=o>)</span> log_and_print <span class=s2>&#34;WARNING: OpenVAS Manager is running and listening only on the local interface. This means that you will not be able to access the OpenVAS Manager from the outside using GSD or OpenVAS CLI.&#34;</span>
</span></span><span class=line><span class=cl>                 log_and_print <span class=s2>&#34;SUGGEST: Ensure that OpenVAS Manager listens on all interfaces.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;</span><span class=o>)</span> log_and_print <span class=s2>&#34;ERROR: OpenVAS Manager is NOT running!&#34;</span> <span class=p>;</span> log_and_print <span class=s2>&#34;FIX: Start OpenVAS Manager (openvasmd).&#34;</span> <span class=p>;</span> <span class=nv>OPENVASMD_PORT</span><span class=o>=</span>-1 <span class=p>;;</span>
</span></span><span class=line><span class=cl>  <span class=k>esac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=nv>$OPENVASMD_PORT</span> in
</span></span><span class=line><span class=cl>    -1<span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=p>;;</span>
</span></span><span class=line><span class=cl>    9390<span class=o>)</span>
</span></span><span class=line><span class=cl>      log_and_print <span class=s2>&#34;OK: OpenVAS Manager is listening on port 9390, which is the default port.&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>;;</span>
</span></span><span class=line><span class=cl>    *<span class=o>)</span>
</span></span><span class=line><span class=cl>      log_and_print <span class=s2>&#34;WARNING: OpenVAS Manager is listening on port </span><span class=nv>$OPENVASMD_PORT</span><span class=s2>, which is NOT the default port!&#34;</span>
</span></span><span class=line><span class=cl>      log_and_print <span class=s2>&#34;SUGGEST: Ensure OpenVAS Manager is listening on port 9390.&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>;;</span>
</span></span><span class=line><span class=cl>  <span class=k>esac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=s2>&#34;</span><span class=nv>$OPENVASAD_HOST</span><span class=s2>&#34;</span> in
</span></span><span class=line><span class=cl>    <span class=s2>&#34;0.0.0.0&#34;</span><span class=o>)</span> log_and_print <span class=s2>&#34;OK: OpenVAS Administrator is running and listening on all interfaces.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;127.0.0.1&#34;</span><span class=o>)</span> log_and_print <span class=s2>&#34;OK: OpenVAS Administrator is running and listening only on the local interface.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;</span><span class=o>)</span> log_and_print <span class=s2>&#34;ERROR: OpenVAS Administrator is NOT running!&#34;</span> <span class=p>;</span> log_and_print <span class=s2>&#34;FIX: Start OpenVAS Administrator (openvasad).&#34;</span> <span class=p>;</span> <span class=nv>OPENVASAD_PORT</span><span class=o>=</span>-1 <span class=p>;;</span>
</span></span><span class=line><span class=cl>  <span class=k>esac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=nv>$OPENVASAD_PORT</span> in
</span></span><span class=line><span class=cl>    -1<span class=o>)</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    9393<span class=o>)</span> log_and_print <span class=s2>&#34;OK: OpenVAS Administrator is listening on port 9393, which is the default port.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    *<span class=o>)</span> log_and_print <span class=s2>&#34;WARNING: OpenVAS Administrator is listening on port </span><span class=nv>$OPENVASAD_PORT</span><span class=s2>, which is NOT the default port!&#34;</span>
</span></span><span class=line><span class=cl>       log_and_print <span class=s2>&#34;SUGGEST: Ensure OpenVAS Administrator is listening on port 9393.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>  <span class=k>esac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=s2>&#34;</span><span class=nv>$GSAD_HOST</span><span class=s2>&#34;</span> in
</span></span><span class=line><span class=cl>    <span class=s2>&#34;0.0.0.0&#34;</span><span class=o>)</span> log_and_print <span class=s2>&#34;OK: Greenbone Security Assistant is running and listening on all interfaces.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;127.0.0.1&#34;</span><span class=o>)</span> log_and_print <span class=s2>&#34;WARNING: Greenbone Security Assistant is running and listening only on the local interface. This means that you will not be able to access the Greenbone Security Assistant from the outside using a web browser.&#34;</span>
</span></span><span class=line><span class=cl>                 log_and_print <span class=s2>&#34;SUGGEST: Ensure that Greenbone Security Assistant listens on all interfaces.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;</span><span class=o>)</span> log_and_print <span class=s2>&#34;ERROR: Greenbone Security Assistant is NOT running!&#34;</span> <span class=p>;</span> log_and_print <span class=s2>&#34;FIX: Start Greenbone Security Assistant (gsad).&#34;</span> <span class=p>;</span> <span class=nv>GSAD_PORT</span><span class=o>=</span>-1 <span class=p>;;</span>
</span></span><span class=line><span class=cl>  <span class=k>esac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=nv>$GSAD_PORT</span> in
</span></span><span class=line><span class=cl>    -1<span class=o>)</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    80<span class=p>|</span>443<span class=p>|</span>9392<span class=o>)</span> log_and_print <span class=s2>&#34;OK: Greenbone Security Assistant is listening on port </span><span class=nv>$GSAD_PORT</span><span class=s2>, which is the default port.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>    *<span class=o>)</span> log_and_print <span class=s2>&#34;WARNING: Greenbone Security Assistant is listening on port </span><span class=nv>$GSAD_PORT</span><span class=s2>, which is NOT the default port!&#34;</span>
</span></span><span class=line><span class=cl>       log_and_print <span class=s2>&#34;SUGGEST: Ensure Greenbone Security Assistant is listening on one of the following ports: 80, 443, 9392.&#34;</span> <span class=p>;;</span>
</span></span><span class=line><span class=cl>  <span class=k>esac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> <span class=nv>$OPENVASSD_PORT</span> -eq -1 <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> <span class=nv>$OPENVASMD_PORT</span> -eq -1 <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> <span class=nv>$OPENVASAD_PORT</span> -eq -1 <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> <span class=nv>$GSAD_PORT</span> -eq -1 <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    check_failed
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Step 8: Checking nmap installation ...&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking presence of nmap ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nv>VERSION</span><span class=o>=</span><span class=sb>`</span>nmap --version <span class=p>|</span> awk <span class=s1>&#39;/Nmap version/ { print $3 }&#39;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;WARNING: No nmap installation found.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;SUGGEST: You should install nmap for comprehensive network scanning (see http://nmap.org)&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> <span class=sb>`</span><span class=nb>echo</span> <span class=nv>$VERSION</span> <span class=p>|</span> grep <span class=s2>&#34;5\.51&#34;</span> <span class=p>|</span> wc -l<span class=sb>`</span> -ne <span class=s2>&#34;1&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;WARNING: Your version of nmap is not fully supported: </span><span class=nv>$VERSION</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;SUGGEST: You should install nmap 5.51.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;OK: nmap is present in version </span><span class=nv>$VERSION</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Step 9: Checking presence of optional tools ...&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking presence of pdflatex ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nv>PDFLATEX</span><span class=o>=</span><span class=sb>`</span><span class=nb>type</span> pdflatex 2&gt; /dev/null<span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;WARNING: Could not find pdflatex binary, the PDF report format will not work.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;SUGGEST: Install pdflatex.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>HAVE_PDFLATEX</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;OK: pdflatex found.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>HAVE_PDFLATEX</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$HAVE_PDFLATEX</span> -eq <span class=m>1</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Checking presence of LaTeX packages required for PDF report generation ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>  <span class=nv>PDFTMPDIR</span><span class=o>=</span><span class=sb>`</span>mktemp -d -t openvas-check-setup-tmp.XXXXXXXXXX<span class=sb>`</span>
</span></span><span class=line><span class=cl>  <span class=nv>TEXFILE</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$PDFTMPDIR</span><span class=s2>/test.tex&#34;</span>
</span></span><span class=line><span class=cl>  cat <span class=s>&lt;&lt;EOT &gt; $TEXFILE
</span></span></span><span class=line><span class=cl><span class=s>\documentclass{article}
</span></span></span><span class=line><span class=cl><span class=s>\pagestyle{empty}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>%\usepackage{color}
</span></span></span><span class=line><span class=cl><span class=s>\usepackage{tabularx}
</span></span></span><span class=line><span class=cl><span class=s>\usepackage{geometry}
</span></span></span><span class=line><span class=cl><span class=s>\usepackage{comment}
</span></span></span><span class=line><span class=cl><span class=s>\usepackage{longtable}
</span></span></span><span class=line><span class=cl><span class=s>\usepackage{titlesec}
</span></span></span><span class=line><span class=cl><span class=s>\usepackage{chngpage}
</span></span></span><span class=line><span class=cl><span class=s>\usepackage{calc}
</span></span></span><span class=line><span class=cl><span class=s>\usepackage{url}
</span></span></span><span class=line><span class=cl><span class=s>\usepackage[utf8x]{inputenc}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>\DeclareUnicodeCharacter {135}{{\textascii ?}}
</span></span></span><span class=line><span class=cl><span class=s>\DeclareUnicodeCharacter {129}{{\textascii ?}}
</span></span></span><span class=line><span class=cl><span class=s>\DeclareUnicodeCharacter {128}{{\textascii ?}}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>\usepackage{colortbl}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>% must come last
</span></span></span><span class=line><span class=cl><span class=s>\usepackage{hyperref}
</span></span></span><span class=line><span class=cl><span class=s>\definecolor{linkblue}{rgb}{0.11,0.56,1}
</span></span></span><span class=line><span class=cl><span class=s>\definecolor{inactive}{rgb}{0.56,0.56,0.56}
</span></span></span><span class=line><span class=cl><span class=s>\definecolor{openvas_debug}{rgb}{0.78,0.78,0.78}
</span></span></span><span class=line><span class=cl><span class=s>\definecolor{openvas_false_positive}{rgb}{0.2275,0.2275,0.2275}
</span></span></span><span class=line><span class=cl><span class=s>\definecolor{openvas_log}{rgb}{0.2275,0.2275,0.2275}
</span></span></span><span class=line><span class=cl><span class=s>\definecolor{openvas_hole}{rgb}{0.7960,0.1137,0.0902}
</span></span></span><span class=line><span class=cl><span class=s>\definecolor{openvas_note}{rgb}{0.3255,0.6157,0.7961}
</span></span></span><span class=line><span class=cl><span class=s>\definecolor{openvas_report}{rgb}{0.68,0.74,0.88}
</span></span></span><span class=line><span class=cl><span class=s>\definecolor{openvas_user_note}{rgb}{1.0,1.0,0.5625}
</span></span></span><span class=line><span class=cl><span class=s>\definecolor{openvas_user_override}{rgb}{1.0,1.0,0.5625}
</span></span></span><span class=line><span class=cl><span class=s>\definecolor{openvas_warning}{rgb}{0.9764,0.6235,0.1922}
</span></span></span><span class=line><span class=cl><span class=s>\hypersetup{colorlinks=true,linkcolor=linkblue,urlcolor=blue,bookmarks=true,bookmarksopen=true}
</span></span></span><span class=line><span class=cl><span class=s>\usepackage[all]{hypcap}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>%\geometry{verbose,a4paper,tmargin=24mm,bottom=24mm}
</span></span></span><span class=line><span class=cl><span class=s>\geometry{verbose,a4paper}
</span></span></span><span class=line><span class=cl><span class=s>\setlength{\parskip}{\smallskipamount}
</span></span></span><span class=line><span class=cl><span class=s>\setlength{\parindent}{0pt}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>\title{PDF Report Test}
</span></span></span><span class=line><span class=cl><span class=s>\pagestyle{headings}
</span></span></span><span class=line><span class=cl><span class=s>\pagenumbering{arabic}
</span></span></span><span class=line><span class=cl><span class=s>\begin{document}
</span></span></span><span class=line><span class=cl><span class=s>This is a test of the PDF generation capabilities of your OpenVAS installation. Please ignore.
</span></span></span><span class=line><span class=cl><span class=s>\end{document}
</span></span></span><span class=line><span class=cl><span class=s>EOT</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  pdflatex -interaction batchmode -output-directory <span class=nv>$PDFTMPDIR</span> <span class=nv>$TEXFILE</span> &gt; /dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> ! -f <span class=s2>&#34;</span><span class=nv>$PDFTMPDIR</span><span class=s2>/test.pdf&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;WARNING: PDF generation failed, most likely due to missing LaTeX packages. The PDF report format will not work.&#34;</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;SUGGEST: Install required LaTeX packages.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;OK: PDF generation successful. The PDF report format is likely to work.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> -f <span class=s2>&#34;</span><span class=nv>$PDFTMPDIR</span><span class=s2>/test.log&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    cat <span class=nv>$PDFTMPDIR</span>/test.log &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl>  rm -rf <span class=nv>$PDFTMPDIR</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking presence of ssh-keygen ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nv>SSHKEYGEN</span><span class=o>=</span><span class=sb>`</span><span class=nb>type</span> ssh-keygen 2&gt; /dev/null<span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;WARNING: Could not find ssh-keygen binary, LSC credential generation for GNU/Linux targets will not work.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;SUGGEST: Install ssh-keygen.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>HAVE_SSHKEYGEN</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;OK: ssh-keygen found, LSC credential generation for GNU/Linux targets is likely to work.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>HAVE_SSHKEYGEN</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$HAVE_SSHKEYGEN</span> -eq <span class=m>1</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Checking presence of rpm ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>  <span class=nv>RPM</span><span class=o>=</span><span class=sb>`</span><span class=nb>type</span> rpm 2&gt; /dev/null<span class=sb>`</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;WARNING: Could not find rpm binary, LSC credential package generation for RPM and DEB based targets will not work.&#34;</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;SUGGEST: Install rpm.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>HAVE_RPM</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    log_and_print <span class=s2>&#34;OK: rpm found, LSC credential package generation for RPM based targets is likely to work.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>HAVE_RPM</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> <span class=nv>$HAVE_RPM</span> -eq <span class=m>1</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Checking presence of alien ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>    <span class=nv>ALIEN</span><span class=o>=</span><span class=sb>`</span><span class=nb>type</span> alien 2&gt; /dev/null<span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>      log_and_print <span class=s2>&#34;WARNING: Could not find alien binary, LSC credential package generation for DEB based targets will not work.&#34;</span>
</span></span><span class=line><span class=cl>      log_and_print <span class=s2>&#34;SUGGEST: Install alien.&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nv>HAVE_ALIEN</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>      log_and_print <span class=s2>&#34;OK: alien found, LSC credential package generation for DEB based targets is likely to work.&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nv>HAVE_ALIEN</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Checking presence of nsis ...&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl><span class=nv>NSIS</span><span class=o>=</span><span class=sb>`</span><span class=nb>type</span> makensis 2&gt; /dev/null<span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;WARNING: Could not find makensis binary, LSC credential package generation for Microsoft Windows targets will not work.&#34;</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;SUGGEST: Install nsis.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>HAVE_NSIS</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  log_and_print <span class=s2>&#34;OK: nsis found, LSC credential package generation for Microsoft Windows targets is likely to work.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>HAVE_NSIS</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> &gt;&gt; <span class=nv>$LOG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;It seems like your OpenVAS-</span><span class=nv>$VER</span><span class=s2> installation is OK.&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;If you think it is not OK, please report your observation&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;and help us to improve this check routine:&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;http://lists.wald.intevation.org/mailman/listinfo/openvas-discuss&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Please attach the log-file (</span><span class=nv>$LOG</span><span class=s2>) to help us analyze the problem.&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>Make the script executable and run it, it should find any errors with your
installation or steps you skipped.</p><h2 id=scanning>Scanning</h2><p>I'm going to assume that you're using the openvas-client as the scanning
client. Here are a few quick notes for setting up a decent scan setup</p><ul><li>Global Settings<ul><li>General<ul><li>Range: default</li><li>20 concurrent hosts</li><li>5 concurrent checks</li><li>Do a reverse lookup</li><li>Optimize the test</li><li>Safe checks</li><li>Scanners<ul><li>OpenVAS TCP Scanner</li><li>Ping Host</li><li>Nmap (NASL wrapper)</li></ul></li></ul></li><li>Plugins<ul><li>Enable All</li><li>Enable at runtime</li><li>Not Silent</li><li>Automatically enable new plugins</li></ul></li><li>Credentials<ul><li>(Optional but a more thorough scan is done with them)</li><li>SSH credentials need to be managed through the Extras->LSC Credentials Manager in the tool bar. It annoyingly does not support simple username/password SSH combos very well requiring you to generate a key pair, set a comment on the keypair (without spaces), and a password on the key pair EVEN IF YOU DON'T INTEND TO USE IT.</li></ul></li><li>Leave target selection as localhost only, these are the global configuration options and you should be forced to set them for each set of scans</li><li>KB<ul><li>Enable KB Saving</li></ul></li></ul></li></ul><p>When you're ready to create a scan create a new "Task" I usually create a Task
per organization that I intend to scan and allows me to organize both different
kinds of scans for that organization as well as multiple scanners.</p><p>Create a "Scope" inside the Task, this will request logging into the server
that you'll be running the scan from and will inherit all of the global
settings. Adjust the target selection and make scan specific adjustments then
Launch!</p><h2 id=configuration>Configuration</h2><h3 id=etcopenvasopenvassdconf>/etc/openvas/openvassd.conf</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>  1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2>  2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3>  3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4>  4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5>  5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6>  6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7>  7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8>  8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9>  9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10> 10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11> 11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12> 12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13> 13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14> 14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15> 15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16> 16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17> 17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18> 18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19> 19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20> 20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21> 21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22> 22</a>
</span><span class=lnt id=hl-6-23><a class=lnlinks href=#hl-6-23> 23</a>
</span><span class=lnt id=hl-6-24><a class=lnlinks href=#hl-6-24> 24</a>
</span><span class=lnt id=hl-6-25><a class=lnlinks href=#hl-6-25> 25</a>
</span><span class=lnt id=hl-6-26><a class=lnlinks href=#hl-6-26> 26</a>
</span><span class=lnt id=hl-6-27><a class=lnlinks href=#hl-6-27> 27</a>
</span><span class=lnt id=hl-6-28><a class=lnlinks href=#hl-6-28> 28</a>
</span><span class=lnt id=hl-6-29><a class=lnlinks href=#hl-6-29> 29</a>
</span><span class=lnt id=hl-6-30><a class=lnlinks href=#hl-6-30> 30</a>
</span><span class=lnt id=hl-6-31><a class=lnlinks href=#hl-6-31> 31</a>
</span><span class=lnt id=hl-6-32><a class=lnlinks href=#hl-6-32> 32</a>
</span><span class=lnt id=hl-6-33><a class=lnlinks href=#hl-6-33> 33</a>
</span><span class=lnt id=hl-6-34><a class=lnlinks href=#hl-6-34> 34</a>
</span><span class=lnt id=hl-6-35><a class=lnlinks href=#hl-6-35> 35</a>
</span><span class=lnt id=hl-6-36><a class=lnlinks href=#hl-6-36> 36</a>
</span><span class=lnt id=hl-6-37><a class=lnlinks href=#hl-6-37> 37</a>
</span><span class=lnt id=hl-6-38><a class=lnlinks href=#hl-6-38> 38</a>
</span><span class=lnt id=hl-6-39><a class=lnlinks href=#hl-6-39> 39</a>
</span><span class=lnt id=hl-6-40><a class=lnlinks href=#hl-6-40> 40</a>
</span><span class=lnt id=hl-6-41><a class=lnlinks href=#hl-6-41> 41</a>
</span><span class=lnt id=hl-6-42><a class=lnlinks href=#hl-6-42> 42</a>
</span><span class=lnt id=hl-6-43><a class=lnlinks href=#hl-6-43> 43</a>
</span><span class=lnt id=hl-6-44><a class=lnlinks href=#hl-6-44> 44</a>
</span><span class=lnt id=hl-6-45><a class=lnlinks href=#hl-6-45> 45</a>
</span><span class=lnt id=hl-6-46><a class=lnlinks href=#hl-6-46> 46</a>
</span><span class=lnt id=hl-6-47><a class=lnlinks href=#hl-6-47> 47</a>
</span><span class=lnt id=hl-6-48><a class=lnlinks href=#hl-6-48> 48</a>
</span><span class=lnt id=hl-6-49><a class=lnlinks href=#hl-6-49> 49</a>
</span><span class=lnt id=hl-6-50><a class=lnlinks href=#hl-6-50> 50</a>
</span><span class=lnt id=hl-6-51><a class=lnlinks href=#hl-6-51> 51</a>
</span><span class=lnt id=hl-6-52><a class=lnlinks href=#hl-6-52> 52</a>
</span><span class=lnt id=hl-6-53><a class=lnlinks href=#hl-6-53> 53</a>
</span><span class=lnt id=hl-6-54><a class=lnlinks href=#hl-6-54> 54</a>
</span><span class=lnt id=hl-6-55><a class=lnlinks href=#hl-6-55> 55</a>
</span><span class=lnt id=hl-6-56><a class=lnlinks href=#hl-6-56> 56</a>
</span><span class=lnt id=hl-6-57><a class=lnlinks href=#hl-6-57> 57</a>
</span><span class=lnt id=hl-6-58><a class=lnlinks href=#hl-6-58> 58</a>
</span><span class=lnt id=hl-6-59><a class=lnlinks href=#hl-6-59> 59</a>
</span><span class=lnt id=hl-6-60><a class=lnlinks href=#hl-6-60> 60</a>
</span><span class=lnt id=hl-6-61><a class=lnlinks href=#hl-6-61> 61</a>
</span><span class=lnt id=hl-6-62><a class=lnlinks href=#hl-6-62> 62</a>
</span><span class=lnt id=hl-6-63><a class=lnlinks href=#hl-6-63> 63</a>
</span><span class=lnt id=hl-6-64><a class=lnlinks href=#hl-6-64> 64</a>
</span><span class=lnt id=hl-6-65><a class=lnlinks href=#hl-6-65> 65</a>
</span><span class=lnt id=hl-6-66><a class=lnlinks href=#hl-6-66> 66</a>
</span><span class=lnt id=hl-6-67><a class=lnlinks href=#hl-6-67> 67</a>
</span><span class=lnt id=hl-6-68><a class=lnlinks href=#hl-6-68> 68</a>
</span><span class=lnt id=hl-6-69><a class=lnlinks href=#hl-6-69> 69</a>
</span><span class=lnt id=hl-6-70><a class=lnlinks href=#hl-6-70> 70</a>
</span><span class=lnt id=hl-6-71><a class=lnlinks href=#hl-6-71> 71</a>
</span><span class=lnt id=hl-6-72><a class=lnlinks href=#hl-6-72> 72</a>
</span><span class=lnt id=hl-6-73><a class=lnlinks href=#hl-6-73> 73</a>
</span><span class=lnt id=hl-6-74><a class=lnlinks href=#hl-6-74> 74</a>
</span><span class=lnt id=hl-6-75><a class=lnlinks href=#hl-6-75> 75</a>
</span><span class=lnt id=hl-6-76><a class=lnlinks href=#hl-6-76> 76</a>
</span><span class=lnt id=hl-6-77><a class=lnlinks href=#hl-6-77> 77</a>
</span><span class=lnt id=hl-6-78><a class=lnlinks href=#hl-6-78> 78</a>
</span><span class=lnt id=hl-6-79><a class=lnlinks href=#hl-6-79> 79</a>
</span><span class=lnt id=hl-6-80><a class=lnlinks href=#hl-6-80> 80</a>
</span><span class=lnt id=hl-6-81><a class=lnlinks href=#hl-6-81> 81</a>
</span><span class=lnt id=hl-6-82><a class=lnlinks href=#hl-6-82> 82</a>
</span><span class=lnt id=hl-6-83><a class=lnlinks href=#hl-6-83> 83</a>
</span><span class=lnt id=hl-6-84><a class=lnlinks href=#hl-6-84> 84</a>
</span><span class=lnt id=hl-6-85><a class=lnlinks href=#hl-6-85> 85</a>
</span><span class=lnt id=hl-6-86><a class=lnlinks href=#hl-6-86> 86</a>
</span><span class=lnt id=hl-6-87><a class=lnlinks href=#hl-6-87> 87</a>
</span><span class=lnt id=hl-6-88><a class=lnlinks href=#hl-6-88> 88</a>
</span><span class=lnt id=hl-6-89><a class=lnlinks href=#hl-6-89> 89</a>
</span><span class=lnt id=hl-6-90><a class=lnlinks href=#hl-6-90> 90</a>
</span><span class=lnt id=hl-6-91><a class=lnlinks href=#hl-6-91> 91</a>
</span><span class=lnt id=hl-6-92><a class=lnlinks href=#hl-6-92> 92</a>
</span><span class=lnt id=hl-6-93><a class=lnlinks href=#hl-6-93> 93</a>
</span><span class=lnt id=hl-6-94><a class=lnlinks href=#hl-6-94> 94</a>
</span><span class=lnt id=hl-6-95><a class=lnlinks href=#hl-6-95> 95</a>
</span><span class=lnt id=hl-6-96><a class=lnlinks href=#hl-6-96> 96</a>
</span><span class=lnt id=hl-6-97><a class=lnlinks href=#hl-6-97> 97</a>
</span><span class=lnt id=hl-6-98><a class=lnlinks href=#hl-6-98> 98</a>
</span><span class=lnt id=hl-6-99><a class=lnlinks href=#hl-6-99> 99</a>
</span><span class=lnt id=hl-6-100><a class=lnlinks href=#hl-6-100>100</a>
</span><span class=lnt id=hl-6-101><a class=lnlinks href=#hl-6-101>101</a>
</span><span class=lnt id=hl-6-102><a class=lnlinks href=#hl-6-102>102</a>
</span><span class=lnt id=hl-6-103><a class=lnlinks href=#hl-6-103>103</a>
</span><span class=lnt id=hl-6-104><a class=lnlinks href=#hl-6-104>104</a>
</span><span class=lnt id=hl-6-105><a class=lnlinks href=#hl-6-105>105</a>
</span><span class=lnt id=hl-6-106><a class=lnlinks href=#hl-6-106>106</a>
</span><span class=lnt id=hl-6-107><a class=lnlinks href=#hl-6-107>107</a>
</span><span class=lnt id=hl-6-108><a class=lnlinks href=#hl-6-108>108</a>
</span><span class=lnt id=hl-6-109><a class=lnlinks href=#hl-6-109>109</a>
</span><span class=lnt id=hl-6-110><a class=lnlinks href=#hl-6-110>110</a>
</span><span class=lnt id=hl-6-111><a class=lnlinks href=#hl-6-111>111</a>
</span><span class=lnt id=hl-6-112><a class=lnlinks href=#hl-6-112>112</a>
</span><span class=lnt id=hl-6-113><a class=lnlinks href=#hl-6-113>113</a>
</span><span class=lnt id=hl-6-114><a class=lnlinks href=#hl-6-114>114</a>
</span><span class=lnt id=hl-6-115><a class=lnlinks href=#hl-6-115>115</a>
</span><span class=lnt id=hl-6-116><a class=lnlinks href=#hl-6-116>116</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=c1># Configuration file of the OpenVAS Security Scanner</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Every line starting with a &#39;#&#39; is a comment</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>[Misc]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Path to the security checks folder:</span>
</span></span><span class=line><span class=cl><span class=na>plugins_folder</span> <span class=o>=</span> <span class=s>/var/lib/openvas/plugins</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Path to OpenVAS caching folder:</span>
</span></span><span class=line><span class=cl><span class=na>cache_folder</span> <span class=o>=</span> <span class=s>/var/cache/openvas</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Path to OpenVAS include directories:</span>
</span></span><span class=line><span class=cl><span class=c1># (multiple entries are separated with colon &#39;:&#39;)</span>
</span></span><span class=line><span class=cl><span class=na>include_folders</span> <span class=o>=</span> <span class=s>/var/lib/openvas/plugins</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Maximum number of simultaneous hosts tested :</span>
</span></span><span class=line><span class=cl><span class=na>max_hosts</span> <span class=o>=</span> <span class=s>30</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Maximum number of simultaneous checks against each host tested :</span>
</span></span><span class=line><span class=cl><span class=na>max_checks</span> <span class=o>=</span> <span class=s>10</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Niceness. If set to &#39;yes&#39;, openvassd will renice itself to 10.</span>
</span></span><span class=line><span class=cl><span class=na>be_nice</span> <span class=o>=</span> <span class=s>yes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Log file (or &#39;syslog&#39;) :</span>
</span></span><span class=line><span class=cl><span class=na>logfile</span> <span class=o>=</span> <span class=s>/var/log/openvas/openvassd.log</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Shall we log every details of the attack ? (disk intensive)</span>
</span></span><span class=line><span class=cl><span class=na>log_whole_attack</span> <span class=o>=</span> <span class=s>no</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Log the name of the plugins that are loaded by the server ?</span>
</span></span><span class=line><span class=cl><span class=na>log_plugins_name_at_load</span> <span class=o>=</span> <span class=s>no</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Dump file for debugging output, use `-&#39; for stdout</span>
</span></span><span class=line><span class=cl><span class=na>dumpfile</span> <span class=o>=</span> <span class=s>/var/log/openvas/openvassd.dump</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Rules file :</span>
</span></span><span class=line><span class=cl><span class=na>rules</span> <span class=o>=</span> <span class=s>/etc/openvas/openvassd.rules</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CGI paths to check for (cgi-bin:/cgi-aws:/ can do)</span>
</span></span><span class=line><span class=cl><span class=na>cgi_path</span> <span class=o>=</span> <span class=s>/cgi-bin:/scripts</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Range of the ports the port scanners will scan :</span>
</span></span><span class=line><span class=cl><span class=c1># &#39;default&#39; means that OpenVAS will scan ports found in its</span>
</span></span><span class=line><span class=cl><span class=c1># services file.</span>
</span></span><span class=line><span class=cl><span class=na>port_range</span> <span class=o>=</span> <span class=s>default</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Optimize the test (recommended) :</span>
</span></span><span class=line><span class=cl><span class=na>optimize_test</span> <span class=o>=</span> <span class=s>yes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Optimization :</span>
</span></span><span class=line><span class=cl><span class=c1># Read timeout for the sockets of the tests :</span>
</span></span><span class=line><span class=cl><span class=na>checks_read_timeout</span> <span class=o>=</span> <span class=s>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ports against which two plugins should not be run simultaneously :</span>
</span></span><span class=line><span class=cl><span class=c1># non_simult_ports = Services/www, 139, Services/finger</span>
</span></span><span class=line><span class=cl><span class=na>non_simult_ports</span> <span class=o>=</span> <span class=s>139, 445</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Maximum lifetime of a plugin (in seconds) :</span>
</span></span><span class=line><span class=cl><span class=na>plugins_timeout</span> <span class=o>=</span> <span class=s>320</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Safe checks rely on banner grabbing :</span>
</span></span><span class=line><span class=cl><span class=na>safe_checks</span> <span class=o>=</span> <span class=s>yes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Automatically activate the plugins that are depended on</span>
</span></span><span class=line><span class=cl><span class=na>auto_enable_dependencies</span> <span class=o>=</span> <span class=s>yes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Do not echo data from plugins which have been automatically enabled</span>
</span></span><span class=line><span class=cl><span class=na>silent_dependencies</span> <span class=o>=</span> <span class=s>no</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Designate hosts by MAC address, not IP address (useful for DHCP networks)</span>
</span></span><span class=line><span class=cl><span class=na>use_mac_addr</span> <span class=o>=</span> <span class=s>no</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#--- Knowledge base saving (can be configured by the client) :</span>
</span></span><span class=line><span class=cl><span class=c1># Save the knowledge base on disk :</span>
</span></span><span class=line><span class=cl><span class=na>save_knowledge_base</span> <span class=o>=</span> <span class=s>yes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Restore the KB for each test :</span>
</span></span><span class=line><span class=cl><span class=na>kb_restore</span> <span class=o>=</span> <span class=s>yes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Only test hosts whose KB we do not have :</span>
</span></span><span class=line><span class=cl><span class=na>only_test_hosts_whose_kb_we_dont_have</span> <span class=o>=</span> <span class=s>no</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Only test hosts whose KB we already have :</span>
</span></span><span class=line><span class=cl><span class=na>only_test_hosts_whose_kb_we_have</span> <span class=o>=</span> <span class=s>no</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># KB test replay :</span>
</span></span><span class=line><span class=cl><span class=na>kb_dont_replay_scanners</span> <span class=o>=</span> <span class=s>no</span>
</span></span><span class=line><span class=cl><span class=na>kb_dont_replay_info_gathering</span> <span class=o>=</span> <span class=s>no</span>
</span></span><span class=line><span class=cl><span class=na>kb_dont_replay_attacks</span> <span class=o>=</span> <span class=s>no</span>
</span></span><span class=line><span class=cl><span class=na>kb_dont_replay_denials</span> <span class=o>=</span> <span class=s>no</span>
</span></span><span class=line><span class=cl><span class=na>kb_max_age</span> <span class=o>=</span> <span class=s>864000</span>
</span></span><span class=line><span class=cl><span class=c1>#--- end of the KB section</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># If this option is set, OpenVAS will not scan a network incrementally</span>
</span></span><span class=line><span class=cl><span class=c1># (10.0.0.1, then 10.0.0.2, 10.0.0.3 and so on..) but will attempt to</span>
</span></span><span class=line><span class=cl><span class=c1># slice the workload throughout the whole network (ie: it will scan</span>
</span></span><span class=line><span class=cl><span class=c1># 10.0.0.1, then 10.0.0.127, then 10.0.0.2, then 10.0.0.128 and so on...</span>
</span></span><span class=line><span class=cl><span class=na>slice_network_addresses</span> <span class=o>=</span> <span class=s>no</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Should consider all the NASL scripts as being signed ? (unsafe if set to &#39;yes&#39;)</span>
</span></span><span class=line><span class=cl><span class=na>nasl_no_signature_check</span> <span class=o>=</span> <span class=s>no</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#Certificates</span>
</span></span><span class=line><span class=cl><span class=na>cert_file</span><span class=o>=</span><span class=s>/etc/pki/openvas/CA/servercert.pem</span>
</span></span><span class=line><span class=cl><span class=na>key_file</span><span class=o>=</span><span class=s>/etc/pki/openvas/private/CA/serverkey.pem</span>
</span></span><span class=line><span class=cl><span class=na>ca_file</span><span class=o>=</span><span class=s>/etc/pki/openvas/CA/cacert.pem</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># If you decide to protect your private key with a password,</span>
</span></span><span class=line><span class=cl><span class=c1># uncomment and change next line</span>
</span></span><span class=line><span class=cl><span class=c1># pem_password=password</span>
</span></span><span class=line><span class=cl><span class=c1># If you want to force the use of a client certificate, uncomment next line</span>
</span></span><span class=line><span class=cl><span class=c1># force_pubkey_auth = yes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#end.</span>
</span></span></code></pre></td></tr></table></div></div></div></article><hr><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"/><line x1="1.05" y1="12" x2="7" y2="12"/><line x1="17.01" y1="12" x2="22.96" y2="12"/></svg><a href=e0ae306a5897bc6892dbaa3e409f62aac8e8d735 target=_blank rel=noopener>e0ae306a</a> @ 2024-07-15</p></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc+cxaJzDdCYbAW0X1G+DgZYvtKFXe6MBex8jUJ2JT25mQx+YjACIng=="></script></body></html>