<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, viewport-fit=cover">

    <title>Sam Stelfox&#x27;s Thoughts &amp; Notes</title>
    <link rel="stylesheet" href="https://stelfox.net/colors-dark.css">

    

    
    
  </head>
  <body>
    <header id="header">
      <h1><a href="https:&#x2F;&#x2F;stelfox.net">Sam Stelfox&#x27;s Thoughts &amp; Notes</a></h1>
      <p>Thought&#x27;s from a software engineer, systems architect, and Linux gubernƒÅre.</p>
    </header>
    <div id="page">
      <div id="sidebar">
        
          
          <nav>
            <ul class="nav">
              
                
                  <li>
                    <a href="&#x2F;"><span>Home</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;about&#x2F;"><span>About</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;blog&#x2F;"><span>Blog</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;projects&#x2F;"><span>Projects</span></a>
                  </li>
                
                  <li>
                    <a href="&#x2F;notes&#x2F;"><span>Various Notes</span></a>
                  </li>
                
              
            </ul>
          </nav>
          
        
      </div>
      <div id="content">
        
<article class="post">
  <h1>Motion</h1><div class="post-content"><h2 id="installation">Installation</h2>
<pre><code>yum install motion -y
</code></pre>
<p>Make sure all your camera's are on and connected.</p>
<h2 id="configuration">Configuration</h2>
<h3 id="selinux-woes">SELinux Woes</h3>
<p>SELinux by default block motion's access to it's logfile <code>/var/log/motion.log</code>,
to allow this write the following out to a file <code>motion_log_file_access.log</code>:</p>
<pre><code>type=AVC msg=audit(1361649114.076:677): avc:  denied  { open } for  pid=25482 comm="motion" path="/var/log/motion.log" dev="dm-1" ino=6293030 scontext=system_u:system_r:zoneminder_t:s0 tcontext=unconfined_u:object_r:var_log_t:s0 tclass=filetype=SYSCALL msg=audit(1361649114.076:677): arch=c000003e syscall=2 success=no exit=-13 a0=1dc3160 a1=441 a2=1b6 a3=238 items=0 ppid=25481 pid=25482 auid=4294967295 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 ses=4294967295 tty=(none) comm="motion" exe="/usr/bin/motion" subj=system_u:system_r:zoneminder_t:s0 key=(null)
type=SERVICE_START msg=audit(1361649114.103:678): pid=1 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:init_t:s0 msg=' comm="motion" exe="/usr/lib/systemd/systemd" hostname=? addr=? terminal=? res=failed'
</code></pre>
<p>Run the following commands to generate and install the new policy:</p>
<pre><code>cat motion_log_file_access.log | audit2allow -M motion_log_file_access
semodule -i motion_log_file_access.pp
</code></pre>
<p>It can also help to restore the SELinux contexts on the entire <code>/var/motion</code>
directory like so:</p>
<pre><code>restorecon -R /var/motion
</code></pre>
<h3 id="disable-auto-focus-on-a-camera">Disable Auto-Focus on a Camera</h3>
<p>I found the LifeCam was regularly refocusing itself much to my annoyance... It
shows up as <code>/dev/video2</code> for me so this is how I turned it off:</p>
<pre><code>uvcdynctrl -d /dev/video2 -s 'Focus, Auto' 0
</code></pre>
</div>
</article>

      </div>
      <footer id="footer">
        <p class="copyright">
          
          &copy; 2011 &ndash; 2021 Sam Stelfox | <a href="https://stelfox.net/licenses/">Site Content Licenses</a>
          
        </p>
      </footer>
    </div>
  </body>
</html>
